import {
  __export
} from "./chunk-HKJ2B2AA.js";

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/interfaces.js
var e;
var t;
var i;
!function(e21) {
  e21.fileDownloadStart = "fileDownloadStart", e21.fileDownloadComplete = "fileDownloadComplete";
}(e || (e = {})), function(e21) {
  e21.view = "view", e21.edit = "edit", e21.editNew = "editNew";
}(t || (t = {})), function(e21) {
  e21.fileOpenPreference = "fileOpenPreference", e21.theme = "theme";
}(i || (i = {}));

// node_modules/@microsoft/teams-js/dist/esm/node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.24.4_tslib@2.6.3_typescript@4.9.5/node_modules/tslib/tslib.es6.js
function t2(t15, n19) {
  var e21 = {};
  for (var r18 in t15) Object.prototype.hasOwnProperty.call(t15, r18) && n19.indexOf(r18) < 0 && (e21[r18] = t15[r18]);
  if (null != t15 && "function" == typeof Object.getOwnPropertySymbols) {
    var o24 = 0;
    for (r18 = Object.getOwnPropertySymbols(t15); o24 < r18.length; o24++) n19.indexOf(r18[o24]) < 0 && Object.prototype.propertyIsEnumerable.call(t15, r18[o24]) && (e21[r18[o24]] = t15[r18[o24]]);
  }
  return e21;
}
function n(t15, n19, e21, r18) {
  return new (e21 || (e21 = Promise))(function(o24, c43) {
    function p56(t16) {
      try {
        u52(r18.next(t16));
      } catch (t17) {
        c43(t17);
      }
    }
    function f46(t16) {
      try {
        u52(r18.throw(t16));
      } catch (t17) {
        c43(t17);
      }
    }
    function u52(t16) {
      var n20;
      t16.done ? o24(t16.value) : (n20 = t16.value, n20 instanceof e21 ? n20 : new e21(function(t17) {
        t17(n20);
      })).then(p56, f46);
    }
    u52((r18 = r18.apply(t15, n19 || [])).next());
  });
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/featureFlags.js
var n2 = { childProxyingCommunication: false };
function i2() {
  n2.childProxyingCommunication = true;
}
function o() {
  return n2.childProxyingCommunication;
}
var t3 = { disableEnforceOriginMatchForChildResponses: false };
function c() {
  return t3;
}
function r(n19) {
  t3 = n19;
}
function e2(n19) {
  return r(Object.assign(Object.assign({}, t3), n19)), c();
}

// node_modules/@microsoft/teams-js/dist/esm/_virtual/_polyfill-node.global.js
var e3 = "undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : {};

// node_modules/@microsoft/teams-js/dist/esm/_virtual/_polyfill-node.buffer.js
var r2 = [];
var e4 = [];
var n3 = "undefined" != typeof Uint8Array ? Uint8Array : Array;
var i3 = false;
function o2() {
  i3 = true;
  for (var t15 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", n19 = 0; n19 < 64; ++n19) r2[n19] = t15[n19], e4[t15.charCodeAt(n19)] = n19;
  e4["-".charCodeAt(0)] = 62, e4["_".charCodeAt(0)] = 63;
}
function u(t15, e21, n19) {
  for (var i26, o24, u52 = [], f46 = e21; f46 < n19; f46 += 3) i26 = (t15[f46] << 16) + (t15[f46 + 1] << 8) + t15[f46 + 2], u52.push(r2[(o24 = i26) >> 18 & 63] + r2[o24 >> 12 & 63] + r2[o24 >> 6 & 63] + r2[63 & o24]);
  return u52.join("");
}
function f(t15) {
  var e21;
  i3 || o2();
  for (var n19 = t15.length, f46 = n19 % 3, s38 = "", h29 = [], a35 = 16383, c43 = 0, l43 = n19 - f46; c43 < l43; c43 += a35) h29.push(u(t15, c43, c43 + a35 > l43 ? l43 : c43 + a35));
  return 1 === f46 ? (e21 = t15[n19 - 1], s38 += r2[e21 >> 2], s38 += r2[e21 << 4 & 63], s38 += "==") : 2 === f46 && (e21 = (t15[n19 - 2] << 8) + t15[n19 - 1], s38 += r2[e21 >> 10], s38 += r2[e21 >> 4 & 63], s38 += r2[e21 << 2 & 63], s38 += "="), h29.push(s38), h29.join("");
}
function s(t15, r18, e21, n19, i26) {
  var o24, u52, f46 = 8 * i26 - n19 - 1, s38 = (1 << f46) - 1, h29 = s38 >> 1, a35 = -7, c43 = e21 ? i26 - 1 : 0, l43 = e21 ? -1 : 1, p56 = t15[r18 + c43];
  for (c43 += l43, o24 = p56 & (1 << -a35) - 1, p56 >>= -a35, a35 += f46; a35 > 0; o24 = 256 * o24 + t15[r18 + c43], c43 += l43, a35 -= 8) ;
  for (u52 = o24 & (1 << -a35) - 1, o24 >>= -a35, a35 += n19; a35 > 0; u52 = 256 * u52 + t15[r18 + c43], c43 += l43, a35 -= 8) ;
  if (0 === o24) o24 = 1 - h29;
  else {
    if (o24 === s38) return u52 ? NaN : 1 / 0 * (p56 ? -1 : 1);
    u52 += Math.pow(2, n19), o24 -= h29;
  }
  return (p56 ? -1 : 1) * u52 * Math.pow(2, o24 - n19);
}
function h(t15, r18, e21, n19, i26, o24) {
  var u52, f46, s38, h29 = 8 * o24 - i26 - 1, a35 = (1 << h29) - 1, c43 = a35 >> 1, l43 = 23 === i26 ? Math.pow(2, -24) - Math.pow(2, -77) : 0, p56 = n19 ? 0 : o24 - 1, g23 = n19 ? 1 : -1, y16 = r18 < 0 || 0 === r18 && 1 / r18 < 0 ? 1 : 0;
  for (r18 = Math.abs(r18), isNaN(r18) || r18 === 1 / 0 ? (f46 = isNaN(r18) ? 1 : 0, u52 = a35) : (u52 = Math.floor(Math.log(r18) / Math.LN2), r18 * (s38 = Math.pow(2, -u52)) < 1 && (u52--, s38 *= 2), (r18 += u52 + c43 >= 1 ? l43 / s38 : l43 * Math.pow(2, 1 - c43)) * s38 >= 2 && (u52++, s38 /= 2), u52 + c43 >= a35 ? (f46 = 0, u52 = a35) : u52 + c43 >= 1 ? (f46 = (r18 * s38 - 1) * Math.pow(2, i26), u52 += c43) : (f46 = r18 * Math.pow(2, c43 - 1) * Math.pow(2, i26), u52 = 0)); i26 >= 8; t15[e21 + p56] = 255 & f46, p56 += g23, f46 /= 256, i26 -= 8) ;
  for (u52 = u52 << i26 | f46, h29 += i26; h29 > 0; t15[e21 + p56] = 255 & u52, p56 += g23, u52 /= 256, h29 -= 8) ;
  t15[e21 + p56 - g23] |= 128 * y16;
}
var a = {}.toString;
var c2 = Array.isArray || function(t15) {
  return "[object Array]" == a.call(t15);
};
function p() {
  return y.TYPED_ARRAY_SUPPORT ? 2147483647 : 1073741823;
}
function g(t15, r18) {
  if (p() < r18) throw new RangeError("Invalid typed array length");
  return y.TYPED_ARRAY_SUPPORT ? (t15 = new Uint8Array(r18)).__proto__ = y.prototype : (null === t15 && (t15 = new y(r18)), t15.length = r18), t15;
}
function y(t15, r18, e21) {
  if (!(y.TYPED_ARRAY_SUPPORT || this instanceof y)) return new y(t15, r18, e21);
  if ("number" == typeof t15) {
    if ("string" == typeof r18) throw new Error("If encoding is specified then the first argument must be a string");
    return v(this, t15);
  }
  return w(this, t15, r18, e21);
}
function w(t15, r18, e21, n19) {
  if ("number" == typeof r18) throw new TypeError('"value" argument must not be a number');
  return "undefined" != typeof ArrayBuffer && r18 instanceof ArrayBuffer ? function(t16, r19, e22, n20) {
    if (r19.byteLength, e22 < 0 || r19.byteLength < e22) throw new RangeError("'offset' is out of bounds");
    if (r19.byteLength < e22 + (n20 || 0)) throw new RangeError("'length' is out of bounds");
    r19 = void 0 === e22 && void 0 === n20 ? new Uint8Array(r19) : void 0 === n20 ? new Uint8Array(r19, e22) : new Uint8Array(r19, e22, n20);
    y.TYPED_ARRAY_SUPPORT ? (t16 = r19).__proto__ = y.prototype : t16 = E(t16, r19);
    return t16;
  }(t15, r18, e21, n19) : "string" == typeof r18 ? function(t16, r19, e22) {
    "string" == typeof e22 && "" !== e22 || (e22 = "utf8");
    if (!y.isEncoding(e22)) throw new TypeError('"encoding" must be a valid string encoding');
    var n20 = 0 | b(r19, e22);
    t16 = g(t16, n20);
    var i26 = t16.write(r19, e22);
    i26 !== n20 && (t16 = t16.slice(0, i26));
    return t16;
  }(t15, r18, e21) : function(t16, r19) {
    if (R(r19)) {
      var e22 = 0 | A(r19.length);
      return 0 === (t16 = g(t16, e22)).length || r19.copy(t16, 0, 0, e22), t16;
    }
    if (r19) {
      if ("undefined" != typeof ArrayBuffer && r19.buffer instanceof ArrayBuffer || "length" in r19) return "number" != typeof r19.length || (n20 = r19.length) != n20 ? g(t16, 0) : E(t16, r19);
      if ("Buffer" === r19.type && c2(r19.data)) return E(t16, r19.data);
    }
    var n20;
    throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
  }(t15, r18);
}
function d(t15) {
  if ("number" != typeof t15) throw new TypeError('"size" argument must be a number');
  if (t15 < 0) throw new RangeError('"size" argument must not be negative');
}
function v(t15, r18) {
  if (d(r18), t15 = g(t15, r18 < 0 ? 0 : 0 | A(r18)), !y.TYPED_ARRAY_SUPPORT) for (var e21 = 0; e21 < r18; ++e21) t15[e21] = 0;
  return t15;
}
function E(t15, r18) {
  var e21 = r18.length < 0 ? 0 : 0 | A(r18.length);
  t15 = g(t15, e21);
  for (var n19 = 0; n19 < e21; n19 += 1) t15[n19] = 255 & r18[n19];
  return t15;
}
function A(t15) {
  if (t15 >= p()) throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x" + p().toString(16) + " bytes");
  return 0 | t15;
}
function R(t15) {
  return !(null == t15 || !t15._isBuffer);
}
function b(t15, r18) {
  if (R(t15)) return t15.length;
  if ("undefined" != typeof ArrayBuffer && "function" == typeof ArrayBuffer.isView && (ArrayBuffer.isView(t15) || t15 instanceof ArrayBuffer)) return t15.byteLength;
  "string" != typeof t15 && (t15 = "" + t15);
  var e21 = t15.length;
  if (0 === e21) return 0;
  for (var n19 = false; ; ) switch (r18) {
    case "ascii":
    case "latin1":
    case "binary":
      return e21;
    case "utf8":
    case "utf-8":
    case void 0:
      return K(t15).length;
    case "ucs2":
    case "ucs-2":
    case "utf16le":
    case "utf-16le":
      return 2 * e21;
    case "hex":
      return e21 >>> 1;
    case "base64":
      return Q(t15).length;
    default:
      if (n19) return K(t15).length;
      r18 = ("" + r18).toLowerCase(), n19 = true;
  }
}
function m(t15, r18, e21) {
  var n19 = false;
  if ((void 0 === r18 || r18 < 0) && (r18 = 0), r18 > this.length) return "";
  if ((void 0 === e21 || e21 > this.length) && (e21 = this.length), e21 <= 0) return "";
  if ((e21 >>>= 0) <= (r18 >>>= 0)) return "";
  for (t15 || (t15 = "utf8"); ; ) switch (t15) {
    case "hex":
      return k(this, r18, e21);
    case "utf8":
    case "utf-8":
      return L(this, r18, e21);
    case "ascii":
      return D(this, r18, e21);
    case "latin1":
    case "binary":
      return x(this, r18, e21);
    case "base64":
      return O(this, r18, e21);
    case "ucs2":
    case "ucs-2":
    case "utf16le":
    case "utf-16le":
      return N(this, r18, e21);
    default:
      if (n19) throw new TypeError("Unknown encoding: " + t15);
      t15 = (t15 + "").toLowerCase(), n19 = true;
  }
}
function _(t15, r18, e21) {
  var n19 = t15[r18];
  t15[r18] = t15[e21], t15[e21] = n19;
}
function P(t15, r18, e21, n19, i26) {
  if (0 === t15.length) return -1;
  if ("string" == typeof e21 ? (n19 = e21, e21 = 0) : e21 > 2147483647 ? e21 = 2147483647 : e21 < -2147483648 && (e21 = -2147483648), e21 = +e21, isNaN(e21) && (e21 = i26 ? 0 : t15.length - 1), e21 < 0 && (e21 = t15.length + e21), e21 >= t15.length) {
    if (i26) return -1;
    e21 = t15.length - 1;
  } else if (e21 < 0) {
    if (!i26) return -1;
    e21 = 0;
  }
  if ("string" == typeof r18 && (r18 = y.from(r18, n19)), R(r18)) return 0 === r18.length ? -1 : T(t15, r18, e21, n19, i26);
  if ("number" == typeof r18) return r18 &= 255, y.TYPED_ARRAY_SUPPORT && "function" == typeof Uint8Array.prototype.indexOf ? i26 ? Uint8Array.prototype.indexOf.call(t15, r18, e21) : Uint8Array.prototype.lastIndexOf.call(t15, r18, e21) : T(t15, [r18], e21, n19, i26);
  throw new TypeError("val must be string, number or Buffer");
}
function T(t15, r18, e21, n19, i26) {
  var o24, u52 = 1, f46 = t15.length, s38 = r18.length;
  if (void 0 !== n19 && ("ucs2" === (n19 = String(n19).toLowerCase()) || "ucs-2" === n19 || "utf16le" === n19 || "utf-16le" === n19)) {
    if (t15.length < 2 || r18.length < 2) return -1;
    u52 = 2, f46 /= 2, s38 /= 2, e21 /= 2;
  }
  function h29(t16, r19) {
    return 1 === u52 ? t16[r19] : t16.readUInt16BE(r19 * u52);
  }
  if (i26) {
    var a35 = -1;
    for (o24 = e21; o24 < f46; o24++) if (h29(t15, o24) === h29(r18, -1 === a35 ? 0 : o24 - a35)) {
      if (-1 === a35 && (a35 = o24), o24 - a35 + 1 === s38) return a35 * u52;
    } else -1 !== a35 && (o24 -= o24 - a35), a35 = -1;
  } else for (e21 + s38 > f46 && (e21 = f46 - s38), o24 = e21; o24 >= 0; o24--) {
    for (var c43 = true, l43 = 0; l43 < s38; l43++) if (h29(t15, o24 + l43) !== h29(r18, l43)) {
      c43 = false;
      break;
    }
    if (c43) return o24;
  }
  return -1;
}
function U(t15, r18, e21, n19) {
  e21 = Number(e21) || 0;
  var i26 = t15.length - e21;
  n19 ? (n19 = Number(n19)) > i26 && (n19 = i26) : n19 = i26;
  var o24 = r18.length;
  if (o24 % 2 != 0) throw new TypeError("Invalid hex string");
  n19 > o24 / 2 && (n19 = o24 / 2);
  for (var u52 = 0; u52 < n19; ++u52) {
    var f46 = parseInt(r18.substr(2 * u52, 2), 16);
    if (isNaN(f46)) return u52;
    t15[e21 + u52] = f46;
  }
  return u52;
}
function B(t15, r18, e21, n19) {
  return W(K(r18, t15.length - e21), t15, e21, n19);
}
function S(t15, r18, e21, n19) {
  return W(function(t16) {
    for (var r19 = [], e22 = 0; e22 < t16.length; ++e22) r19.push(255 & t16.charCodeAt(e22));
    return r19;
  }(r18), t15, e21, n19);
}
function Y(t15, r18, e21, n19) {
  return S(t15, r18, e21, n19);
}
function I(t15, r18, e21, n19) {
  return W(Q(r18), t15, e21, n19);
}
function C(t15, r18, e21, n19) {
  return W(function(t16, r19) {
    for (var e22, n20, i26, o24 = [], u52 = 0; u52 < t16.length && !((r19 -= 2) < 0); ++u52) n20 = (e22 = t16.charCodeAt(u52)) >> 8, i26 = e22 % 256, o24.push(i26), o24.push(n20);
    return o24;
  }(r18, t15.length - e21), t15, e21, n19);
}
function O(t15, r18, e21) {
  return 0 === r18 && e21 === t15.length ? f(t15) : f(t15.slice(r18, e21));
}
function L(t15, r18, e21) {
  e21 = Math.min(t15.length, e21);
  for (var n19 = [], i26 = r18; i26 < e21; ) {
    var o24, u52, f46, s38, h29 = t15[i26], a35 = null, c43 = h29 > 239 ? 4 : h29 > 223 ? 3 : h29 > 191 ? 2 : 1;
    if (i26 + c43 <= e21) switch (c43) {
      case 1:
        h29 < 128 && (a35 = h29);
        break;
      case 2:
        128 == (192 & (o24 = t15[i26 + 1])) && (s38 = (31 & h29) << 6 | 63 & o24) > 127 && (a35 = s38);
        break;
      case 3:
        o24 = t15[i26 + 1], u52 = t15[i26 + 2], 128 == (192 & o24) && 128 == (192 & u52) && (s38 = (15 & h29) << 12 | (63 & o24) << 6 | 63 & u52) > 2047 && (s38 < 55296 || s38 > 57343) && (a35 = s38);
        break;
      case 4:
        o24 = t15[i26 + 1], u52 = t15[i26 + 2], f46 = t15[i26 + 3], 128 == (192 & o24) && 128 == (192 & u52) && 128 == (192 & f46) && (s38 = (15 & h29) << 18 | (63 & o24) << 12 | (63 & u52) << 6 | 63 & f46) > 65535 && s38 < 1114112 && (a35 = s38);
    }
    null === a35 ? (a35 = 65533, c43 = 1) : a35 > 65535 && (a35 -= 65536, n19.push(a35 >>> 10 & 1023 | 55296), a35 = 56320 | 1023 & a35), n19.push(a35), i26 += c43;
  }
  return function(t16) {
    var r19 = t16.length;
    if (r19 <= M) return String.fromCharCode.apply(String, t16);
    var e22 = "", n20 = 0;
    for (; n20 < r19; ) e22 += String.fromCharCode.apply(String, t16.slice(n20, n20 += M));
    return e22;
  }(n19);
}
y.TYPED_ARRAY_SUPPORT = void 0 === e3.TYPED_ARRAY_SUPPORT || e3.TYPED_ARRAY_SUPPORT, p(), y.poolSize = 8192, y._augment = function(t15) {
  return t15.__proto__ = y.prototype, t15;
}, y.from = function(t15, r18, e21) {
  return w(null, t15, r18, e21);
}, y.TYPED_ARRAY_SUPPORT && (y.prototype.__proto__ = Uint8Array.prototype, y.__proto__ = Uint8Array, "undefined" != typeof Symbol && Symbol.species && y[Symbol.species]), y.alloc = function(t15, r18, e21) {
  return function(t16, r19, e22, n19) {
    return d(r19), r19 <= 0 ? g(t16, r19) : void 0 !== e22 ? "string" == typeof n19 ? g(t16, r19).fill(e22, n19) : g(t16, r19).fill(e22) : g(t16, r19);
  }(null, t15, r18, e21);
}, y.allocUnsafe = function(t15) {
  return v(null, t15);
}, y.allocUnsafeSlow = function(t15) {
  return v(null, t15);
}, y.isBuffer = X, y.compare = function(t15, r18) {
  if (!R(t15) || !R(r18)) throw new TypeError("Arguments must be Buffers");
  if (t15 === r18) return 0;
  for (var e21 = t15.length, n19 = r18.length, i26 = 0, o24 = Math.min(e21, n19); i26 < o24; ++i26) if (t15[i26] !== r18[i26]) {
    e21 = t15[i26], n19 = r18[i26];
    break;
  }
  return e21 < n19 ? -1 : n19 < e21 ? 1 : 0;
}, y.isEncoding = function(t15) {
  switch (String(t15).toLowerCase()) {
    case "hex":
    case "utf8":
    case "utf-8":
    case "ascii":
    case "latin1":
    case "binary":
    case "base64":
    case "ucs2":
    case "ucs-2":
    case "utf16le":
    case "utf-16le":
      return true;
    default:
      return false;
  }
}, y.concat = function(t15, r18) {
  if (!c2(t15)) throw new TypeError('"list" argument must be an Array of Buffers');
  if (0 === t15.length) return y.alloc(0);
  var e21;
  if (void 0 === r18) for (r18 = 0, e21 = 0; e21 < t15.length; ++e21) r18 += t15[e21].length;
  var n19 = y.allocUnsafe(r18), i26 = 0;
  for (e21 = 0; e21 < t15.length; ++e21) {
    var o24 = t15[e21];
    if (!R(o24)) throw new TypeError('"list" argument must be an Array of Buffers');
    o24.copy(n19, i26), i26 += o24.length;
  }
  return n19;
}, y.byteLength = b, y.prototype._isBuffer = true, y.prototype.swap16 = function() {
  var t15 = this.length;
  if (t15 % 2 != 0) throw new RangeError("Buffer size must be a multiple of 16-bits");
  for (var r18 = 0; r18 < t15; r18 += 2) _(this, r18, r18 + 1);
  return this;
}, y.prototype.swap32 = function() {
  var t15 = this.length;
  if (t15 % 4 != 0) throw new RangeError("Buffer size must be a multiple of 32-bits");
  for (var r18 = 0; r18 < t15; r18 += 4) _(this, r18, r18 + 3), _(this, r18 + 1, r18 + 2);
  return this;
}, y.prototype.swap64 = function() {
  var t15 = this.length;
  if (t15 % 8 != 0) throw new RangeError("Buffer size must be a multiple of 64-bits");
  for (var r18 = 0; r18 < t15; r18 += 8) _(this, r18, r18 + 7), _(this, r18 + 1, r18 + 6), _(this, r18 + 2, r18 + 5), _(this, r18 + 3, r18 + 4);
  return this;
}, y.prototype.toString = function() {
  var t15 = 0 | this.length;
  return 0 === t15 ? "" : 0 === arguments.length ? L(this, 0, t15) : m.apply(this, arguments);
}, y.prototype.equals = function(t15) {
  if (!R(t15)) throw new TypeError("Argument must be a Buffer");
  return this === t15 || 0 === y.compare(this, t15);
}, y.prototype.inspect = function() {
  var t15 = "";
  return this.length > 0 && (t15 = this.toString("hex", 0, 50).match(/.{2}/g).join(" "), this.length > 50 && (t15 += " ... ")), "<Buffer " + t15 + ">";
}, y.prototype.compare = function(t15, r18, e21, n19, i26) {
  if (!R(t15)) throw new TypeError("Argument must be a Buffer");
  if (void 0 === r18 && (r18 = 0), void 0 === e21 && (e21 = t15 ? t15.length : 0), void 0 === n19 && (n19 = 0), void 0 === i26 && (i26 = this.length), r18 < 0 || e21 > t15.length || n19 < 0 || i26 > this.length) throw new RangeError("out of range index");
  if (n19 >= i26 && r18 >= e21) return 0;
  if (n19 >= i26) return -1;
  if (r18 >= e21) return 1;
  if (this === t15) return 0;
  for (var o24 = (i26 >>>= 0) - (n19 >>>= 0), u52 = (e21 >>>= 0) - (r18 >>>= 0), f46 = Math.min(o24, u52), s38 = this.slice(n19, i26), h29 = t15.slice(r18, e21), a35 = 0; a35 < f46; ++a35) if (s38[a35] !== h29[a35]) {
    o24 = s38[a35], u52 = h29[a35];
    break;
  }
  return o24 < u52 ? -1 : u52 < o24 ? 1 : 0;
}, y.prototype.includes = function(t15, r18, e21) {
  return -1 !== this.indexOf(t15, r18, e21);
}, y.prototype.indexOf = function(t15, r18, e21) {
  return P(this, t15, r18, e21, true);
}, y.prototype.lastIndexOf = function(t15, r18, e21) {
  return P(this, t15, r18, e21, false);
}, y.prototype.write = function(t15, r18, e21, n19) {
  if (void 0 === r18) n19 = "utf8", e21 = this.length, r18 = 0;
  else if (void 0 === e21 && "string" == typeof r18) n19 = r18, e21 = this.length, r18 = 0;
  else {
    if (!isFinite(r18)) throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
    r18 |= 0, isFinite(e21) ? (e21 |= 0, void 0 === n19 && (n19 = "utf8")) : (n19 = e21, e21 = void 0);
  }
  var i26 = this.length - r18;
  if ((void 0 === e21 || e21 > i26) && (e21 = i26), t15.length > 0 && (e21 < 0 || r18 < 0) || r18 > this.length) throw new RangeError("Attempt to write outside buffer bounds");
  n19 || (n19 = "utf8");
  for (var o24 = false; ; ) switch (n19) {
    case "hex":
      return U(this, t15, r18, e21);
    case "utf8":
    case "utf-8":
      return B(this, t15, r18, e21);
    case "ascii":
      return S(this, t15, r18, e21);
    case "latin1":
    case "binary":
      return Y(this, t15, r18, e21);
    case "base64":
      return I(this, t15, r18, e21);
    case "ucs2":
    case "ucs-2":
    case "utf16le":
    case "utf-16le":
      return C(this, t15, r18, e21);
    default:
      if (o24) throw new TypeError("Unknown encoding: " + n19);
      n19 = ("" + n19).toLowerCase(), o24 = true;
  }
}, y.prototype.toJSON = function() {
  return { type: "Buffer", data: Array.prototype.slice.call(this._arr || this, 0) };
};
var M = 4096;
function D(t15, r18, e21) {
  var n19 = "";
  e21 = Math.min(t15.length, e21);
  for (var i26 = r18; i26 < e21; ++i26) n19 += String.fromCharCode(127 & t15[i26]);
  return n19;
}
function x(t15, r18, e21) {
  var n19 = "";
  e21 = Math.min(t15.length, e21);
  for (var i26 = r18; i26 < e21; ++i26) n19 += String.fromCharCode(t15[i26]);
  return n19;
}
function k(t15, r18, e21) {
  var n19 = t15.length;
  (!r18 || r18 < 0) && (r18 = 0), (!e21 || e21 < 0 || e21 > n19) && (e21 = n19);
  for (var i26 = "", o24 = r18; o24 < e21; ++o24) i26 += H(t15[o24]);
  return i26;
}
function N(t15, r18, e21) {
  for (var n19 = t15.slice(r18, e21), i26 = "", o24 = 0; o24 < n19.length; o24 += 2) i26 += String.fromCharCode(n19[o24] + 256 * n19[o24 + 1]);
  return i26;
}
function z(t15, r18, e21) {
  if (t15 % 1 != 0 || t15 < 0) throw new RangeError("offset is not uint");
  if (t15 + r18 > e21) throw new RangeError("Trying to access beyond buffer length");
}
function F(t15, r18, e21, n19, i26, o24) {
  if (!R(t15)) throw new TypeError('"buffer" argument must be a Buffer instance');
  if (r18 > i26 || r18 < o24) throw new RangeError('"value" argument is out of bounds');
  if (e21 + n19 > t15.length) throw new RangeError("Index out of range");
}
function j(t15, r18, e21, n19) {
  r18 < 0 && (r18 = 65535 + r18 + 1);
  for (var i26 = 0, o24 = Math.min(t15.length - e21, 2); i26 < o24; ++i26) t15[e21 + i26] = (r18 & 255 << 8 * (n19 ? i26 : 1 - i26)) >>> 8 * (n19 ? i26 : 1 - i26);
}
function V(t15, r18, e21, n19) {
  r18 < 0 && (r18 = 4294967295 + r18 + 1);
  for (var i26 = 0, o24 = Math.min(t15.length - e21, 4); i26 < o24; ++i26) t15[e21 + i26] = r18 >>> 8 * (n19 ? i26 : 3 - i26) & 255;
}
function q(t15, r18, e21, n19, i26, o24) {
  if (e21 + n19 > t15.length) throw new RangeError("Index out of range");
  if (e21 < 0) throw new RangeError("Index out of range");
}
function J(t15, r18, e21, n19, i26) {
  return i26 || q(t15, 0, e21, 4), h(t15, r18, e21, n19, 23, 4), e21 + 4;
}
function Z(t15, r18, e21, n19, i26) {
  return i26 || q(t15, 0, e21, 8), h(t15, r18, e21, n19, 52, 8), e21 + 8;
}
y.prototype.slice = function(t15, r18) {
  var e21, n19 = this.length;
  if ((t15 = ~~t15) < 0 ? (t15 += n19) < 0 && (t15 = 0) : t15 > n19 && (t15 = n19), (r18 = void 0 === r18 ? n19 : ~~r18) < 0 ? (r18 += n19) < 0 && (r18 = 0) : r18 > n19 && (r18 = n19), r18 < t15 && (r18 = t15), y.TYPED_ARRAY_SUPPORT) (e21 = this.subarray(t15, r18)).__proto__ = y.prototype;
  else {
    var i26 = r18 - t15;
    e21 = new y(i26, void 0);
    for (var o24 = 0; o24 < i26; ++o24) e21[o24] = this[o24 + t15];
  }
  return e21;
}, y.prototype.readUIntLE = function(t15, r18, e21) {
  t15 |= 0, r18 |= 0, e21 || z(t15, r18, this.length);
  for (var n19 = this[t15], i26 = 1, o24 = 0; ++o24 < r18 && (i26 *= 256); ) n19 += this[t15 + o24] * i26;
  return n19;
}, y.prototype.readUIntBE = function(t15, r18, e21) {
  t15 |= 0, r18 |= 0, e21 || z(t15, r18, this.length);
  for (var n19 = this[t15 + --r18], i26 = 1; r18 > 0 && (i26 *= 256); ) n19 += this[t15 + --r18] * i26;
  return n19;
}, y.prototype.readUInt8 = function(t15, r18) {
  return r18 || z(t15, 1, this.length), this[t15];
}, y.prototype.readUInt16LE = function(t15, r18) {
  return r18 || z(t15, 2, this.length), this[t15] | this[t15 + 1] << 8;
}, y.prototype.readUInt16BE = function(t15, r18) {
  return r18 || z(t15, 2, this.length), this[t15] << 8 | this[t15 + 1];
}, y.prototype.readUInt32LE = function(t15, r18) {
  return r18 || z(t15, 4, this.length), (this[t15] | this[t15 + 1] << 8 | this[t15 + 2] << 16) + 16777216 * this[t15 + 3];
}, y.prototype.readUInt32BE = function(t15, r18) {
  return r18 || z(t15, 4, this.length), 16777216 * this[t15] + (this[t15 + 1] << 16 | this[t15 + 2] << 8 | this[t15 + 3]);
}, y.prototype.readIntLE = function(t15, r18, e21) {
  t15 |= 0, r18 |= 0, e21 || z(t15, r18, this.length);
  for (var n19 = this[t15], i26 = 1, o24 = 0; ++o24 < r18 && (i26 *= 256); ) n19 += this[t15 + o24] * i26;
  return n19 >= (i26 *= 128) && (n19 -= Math.pow(2, 8 * r18)), n19;
}, y.prototype.readIntBE = function(t15, r18, e21) {
  t15 |= 0, r18 |= 0, e21 || z(t15, r18, this.length);
  for (var n19 = r18, i26 = 1, o24 = this[t15 + --n19]; n19 > 0 && (i26 *= 256); ) o24 += this[t15 + --n19] * i26;
  return o24 >= (i26 *= 128) && (o24 -= Math.pow(2, 8 * r18)), o24;
}, y.prototype.readInt8 = function(t15, r18) {
  return r18 || z(t15, 1, this.length), 128 & this[t15] ? -1 * (255 - this[t15] + 1) : this[t15];
}, y.prototype.readInt16LE = function(t15, r18) {
  r18 || z(t15, 2, this.length);
  var e21 = this[t15] | this[t15 + 1] << 8;
  return 32768 & e21 ? 4294901760 | e21 : e21;
}, y.prototype.readInt16BE = function(t15, r18) {
  r18 || z(t15, 2, this.length);
  var e21 = this[t15 + 1] | this[t15] << 8;
  return 32768 & e21 ? 4294901760 | e21 : e21;
}, y.prototype.readInt32LE = function(t15, r18) {
  return r18 || z(t15, 4, this.length), this[t15] | this[t15 + 1] << 8 | this[t15 + 2] << 16 | this[t15 + 3] << 24;
}, y.prototype.readInt32BE = function(t15, r18) {
  return r18 || z(t15, 4, this.length), this[t15] << 24 | this[t15 + 1] << 16 | this[t15 + 2] << 8 | this[t15 + 3];
}, y.prototype.readFloatLE = function(t15, r18) {
  return r18 || z(t15, 4, this.length), s(this, t15, true, 23, 4);
}, y.prototype.readFloatBE = function(t15, r18) {
  return r18 || z(t15, 4, this.length), s(this, t15, false, 23, 4);
}, y.prototype.readDoubleLE = function(t15, r18) {
  return r18 || z(t15, 8, this.length), s(this, t15, true, 52, 8);
}, y.prototype.readDoubleBE = function(t15, r18) {
  return r18 || z(t15, 8, this.length), s(this, t15, false, 52, 8);
}, y.prototype.writeUIntLE = function(t15, r18, e21, n19) {
  (t15 = +t15, r18 |= 0, e21 |= 0, n19) || F(this, t15, r18, e21, Math.pow(2, 8 * e21) - 1, 0);
  var i26 = 1, o24 = 0;
  for (this[r18] = 255 & t15; ++o24 < e21 && (i26 *= 256); ) this[r18 + o24] = t15 / i26 & 255;
  return r18 + e21;
}, y.prototype.writeUIntBE = function(t15, r18, e21, n19) {
  (t15 = +t15, r18 |= 0, e21 |= 0, n19) || F(this, t15, r18, e21, Math.pow(2, 8 * e21) - 1, 0);
  var i26 = e21 - 1, o24 = 1;
  for (this[r18 + i26] = 255 & t15; --i26 >= 0 && (o24 *= 256); ) this[r18 + i26] = t15 / o24 & 255;
  return r18 + e21;
}, y.prototype.writeUInt8 = function(t15, r18, e21) {
  return t15 = +t15, r18 |= 0, e21 || F(this, t15, r18, 1, 255, 0), y.TYPED_ARRAY_SUPPORT || (t15 = Math.floor(t15)), this[r18] = 255 & t15, r18 + 1;
}, y.prototype.writeUInt16LE = function(t15, r18, e21) {
  return t15 = +t15, r18 |= 0, e21 || F(this, t15, r18, 2, 65535, 0), y.TYPED_ARRAY_SUPPORT ? (this[r18] = 255 & t15, this[r18 + 1] = t15 >>> 8) : j(this, t15, r18, true), r18 + 2;
}, y.prototype.writeUInt16BE = function(t15, r18, e21) {
  return t15 = +t15, r18 |= 0, e21 || F(this, t15, r18, 2, 65535, 0), y.TYPED_ARRAY_SUPPORT ? (this[r18] = t15 >>> 8, this[r18 + 1] = 255 & t15) : j(this, t15, r18, false), r18 + 2;
}, y.prototype.writeUInt32LE = function(t15, r18, e21) {
  return t15 = +t15, r18 |= 0, e21 || F(this, t15, r18, 4, 4294967295, 0), y.TYPED_ARRAY_SUPPORT ? (this[r18 + 3] = t15 >>> 24, this[r18 + 2] = t15 >>> 16, this[r18 + 1] = t15 >>> 8, this[r18] = 255 & t15) : V(this, t15, r18, true), r18 + 4;
}, y.prototype.writeUInt32BE = function(t15, r18, e21) {
  return t15 = +t15, r18 |= 0, e21 || F(this, t15, r18, 4, 4294967295, 0), y.TYPED_ARRAY_SUPPORT ? (this[r18] = t15 >>> 24, this[r18 + 1] = t15 >>> 16, this[r18 + 2] = t15 >>> 8, this[r18 + 3] = 255 & t15) : V(this, t15, r18, false), r18 + 4;
}, y.prototype.writeIntLE = function(t15, r18, e21, n19) {
  if (t15 = +t15, r18 |= 0, !n19) {
    var i26 = Math.pow(2, 8 * e21 - 1);
    F(this, t15, r18, e21, i26 - 1, -i26);
  }
  var o24 = 0, u52 = 1, f46 = 0;
  for (this[r18] = 255 & t15; ++o24 < e21 && (u52 *= 256); ) t15 < 0 && 0 === f46 && 0 !== this[r18 + o24 - 1] && (f46 = 1), this[r18 + o24] = (t15 / u52 | 0) - f46 & 255;
  return r18 + e21;
}, y.prototype.writeIntBE = function(t15, r18, e21, n19) {
  if (t15 = +t15, r18 |= 0, !n19) {
    var i26 = Math.pow(2, 8 * e21 - 1);
    F(this, t15, r18, e21, i26 - 1, -i26);
  }
  var o24 = e21 - 1, u52 = 1, f46 = 0;
  for (this[r18 + o24] = 255 & t15; --o24 >= 0 && (u52 *= 256); ) t15 < 0 && 0 === f46 && 0 !== this[r18 + o24 + 1] && (f46 = 1), this[r18 + o24] = (t15 / u52 | 0) - f46 & 255;
  return r18 + e21;
}, y.prototype.writeInt8 = function(t15, r18, e21) {
  return t15 = +t15, r18 |= 0, e21 || F(this, t15, r18, 1, 127, -128), y.TYPED_ARRAY_SUPPORT || (t15 = Math.floor(t15)), t15 < 0 && (t15 = 255 + t15 + 1), this[r18] = 255 & t15, r18 + 1;
}, y.prototype.writeInt16LE = function(t15, r18, e21) {
  return t15 = +t15, r18 |= 0, e21 || F(this, t15, r18, 2, 32767, -32768), y.TYPED_ARRAY_SUPPORT ? (this[r18] = 255 & t15, this[r18 + 1] = t15 >>> 8) : j(this, t15, r18, true), r18 + 2;
}, y.prototype.writeInt16BE = function(t15, r18, e21) {
  return t15 = +t15, r18 |= 0, e21 || F(this, t15, r18, 2, 32767, -32768), y.TYPED_ARRAY_SUPPORT ? (this[r18] = t15 >>> 8, this[r18 + 1] = 255 & t15) : j(this, t15, r18, false), r18 + 2;
}, y.prototype.writeInt32LE = function(t15, r18, e21) {
  return t15 = +t15, r18 |= 0, e21 || F(this, t15, r18, 4, 2147483647, -2147483648), y.TYPED_ARRAY_SUPPORT ? (this[r18] = 255 & t15, this[r18 + 1] = t15 >>> 8, this[r18 + 2] = t15 >>> 16, this[r18 + 3] = t15 >>> 24) : V(this, t15, r18, true), r18 + 4;
}, y.prototype.writeInt32BE = function(t15, r18, e21) {
  return t15 = +t15, r18 |= 0, e21 || F(this, t15, r18, 4, 2147483647, -2147483648), t15 < 0 && (t15 = 4294967295 + t15 + 1), y.TYPED_ARRAY_SUPPORT ? (this[r18] = t15 >>> 24, this[r18 + 1] = t15 >>> 16, this[r18 + 2] = t15 >>> 8, this[r18 + 3] = 255 & t15) : V(this, t15, r18, false), r18 + 4;
}, y.prototype.writeFloatLE = function(t15, r18, e21) {
  return J(this, t15, r18, true, e21);
}, y.prototype.writeFloatBE = function(t15, r18, e21) {
  return J(this, t15, r18, false, e21);
}, y.prototype.writeDoubleLE = function(t15, r18, e21) {
  return Z(this, t15, r18, true, e21);
}, y.prototype.writeDoubleBE = function(t15, r18, e21) {
  return Z(this, t15, r18, false, e21);
}, y.prototype.copy = function(t15, r18, e21, n19) {
  if (e21 || (e21 = 0), n19 || 0 === n19 || (n19 = this.length), r18 >= t15.length && (r18 = t15.length), r18 || (r18 = 0), n19 > 0 && n19 < e21 && (n19 = e21), n19 === e21) return 0;
  if (0 === t15.length || 0 === this.length) return 0;
  if (r18 < 0) throw new RangeError("targetStart out of bounds");
  if (e21 < 0 || e21 >= this.length) throw new RangeError("sourceStart out of bounds");
  if (n19 < 0) throw new RangeError("sourceEnd out of bounds");
  n19 > this.length && (n19 = this.length), t15.length - r18 < n19 - e21 && (n19 = t15.length - r18 + e21);
  var i26, o24 = n19 - e21;
  if (this === t15 && e21 < r18 && r18 < n19) for (i26 = o24 - 1; i26 >= 0; --i26) t15[i26 + r18] = this[i26 + e21];
  else if (o24 < 1e3 || !y.TYPED_ARRAY_SUPPORT) for (i26 = 0; i26 < o24; ++i26) t15[i26 + r18] = this[i26 + e21];
  else Uint8Array.prototype.set.call(t15, this.subarray(e21, e21 + o24), r18);
  return o24;
}, y.prototype.fill = function(t15, r18, e21, n19) {
  if ("string" == typeof t15) {
    if ("string" == typeof r18 ? (n19 = r18, r18 = 0, e21 = this.length) : "string" == typeof e21 && (n19 = e21, e21 = this.length), 1 === t15.length) {
      var i26 = t15.charCodeAt(0);
      i26 < 256 && (t15 = i26);
    }
    if (void 0 !== n19 && "string" != typeof n19) throw new TypeError("encoding must be a string");
    if ("string" == typeof n19 && !y.isEncoding(n19)) throw new TypeError("Unknown encoding: " + n19);
  } else "number" == typeof t15 && (t15 &= 255);
  if (r18 < 0 || this.length < r18 || this.length < e21) throw new RangeError("Out of range index");
  if (e21 <= r18) return this;
  var o24;
  if (r18 >>>= 0, e21 = void 0 === e21 ? this.length : e21 >>> 0, t15 || (t15 = 0), "number" == typeof t15) for (o24 = r18; o24 < e21; ++o24) this[o24] = t15;
  else {
    var u52 = R(t15) ? t15 : K(new y(t15, n19).toString()), f46 = u52.length;
    for (o24 = 0; o24 < e21 - r18; ++o24) this[o24 + r18] = u52[o24 % f46];
  }
  return this;
};
var G = /[^+\/0-9A-Za-z-_]/g;
function H(t15) {
  return t15 < 16 ? "0" + t15.toString(16) : t15.toString(16);
}
function K(t15, r18) {
  var e21;
  r18 = r18 || 1 / 0;
  for (var n19 = t15.length, i26 = null, o24 = [], u52 = 0; u52 < n19; ++u52) {
    if ((e21 = t15.charCodeAt(u52)) > 55295 && e21 < 57344) {
      if (!i26) {
        if (e21 > 56319) {
          (r18 -= 3) > -1 && o24.push(239, 191, 189);
          continue;
        }
        if (u52 + 1 === n19) {
          (r18 -= 3) > -1 && o24.push(239, 191, 189);
          continue;
        }
        i26 = e21;
        continue;
      }
      if (e21 < 56320) {
        (r18 -= 3) > -1 && o24.push(239, 191, 189), i26 = e21;
        continue;
      }
      e21 = 65536 + (i26 - 55296 << 10 | e21 - 56320);
    } else i26 && (r18 -= 3) > -1 && o24.push(239, 191, 189);
    if (i26 = null, e21 < 128) {
      if ((r18 -= 1) < 0) break;
      o24.push(e21);
    } else if (e21 < 2048) {
      if ((r18 -= 2) < 0) break;
      o24.push(e21 >> 6 | 192, 63 & e21 | 128);
    } else if (e21 < 65536) {
      if ((r18 -= 3) < 0) break;
      o24.push(e21 >> 12 | 224, e21 >> 6 & 63 | 128, 63 & e21 | 128);
    } else {
      if (!(e21 < 1114112)) throw new Error("Invalid code point");
      if ((r18 -= 4) < 0) break;
      o24.push(e21 >> 18 | 240, e21 >> 12 & 63 | 128, e21 >> 6 & 63 | 128, 63 & e21 | 128);
    }
  }
  return o24;
}
function Q(t15) {
  return function(t16) {
    var r18, u52, f46, s38, h29, a35;
    i3 || o2();
    var c43 = t16.length;
    if (c43 % 4 > 0) throw new Error("Invalid string. Length must be a multiple of 4");
    h29 = "=" === t16[c43 - 2] ? 2 : "=" === t16[c43 - 1] ? 1 : 0, a35 = new n3(3 * c43 / 4 - h29), f46 = h29 > 0 ? c43 - 4 : c43;
    var l43 = 0;
    for (r18 = 0, u52 = 0; r18 < f46; r18 += 4, u52 += 3) s38 = e4[t16.charCodeAt(r18)] << 18 | e4[t16.charCodeAt(r18 + 1)] << 12 | e4[t16.charCodeAt(r18 + 2)] << 6 | e4[t16.charCodeAt(r18 + 3)], a35[l43++] = s38 >> 16 & 255, a35[l43++] = s38 >> 8 & 255, a35[l43++] = 255 & s38;
    return 2 === h29 ? (s38 = e4[t16.charCodeAt(r18)] << 2 | e4[t16.charCodeAt(r18 + 1)] >> 4, a35[l43++] = 255 & s38) : 1 === h29 && (s38 = e4[t16.charCodeAt(r18)] << 10 | e4[t16.charCodeAt(r18 + 1)] << 4 | e4[t16.charCodeAt(r18 + 2)] >> 2, a35[l43++] = s38 >> 8 & 255, a35[l43++] = 255 & s38), a35;
  }(function(t16) {
    if ((t16 = function(t17) {
      return t17.trim ? t17.trim() : t17.replace(/^\s+|\s+$/g, "");
    }(t16).replace(G, "")).length < 2) return "";
    for (; t16.length % 4 != 0; ) t16 += "=";
    return t16;
  }(t15));
}
function W(t15, r18, e21, n19) {
  for (var i26 = 0; i26 < n19 && !(i26 + e21 >= r18.length || i26 >= t15.length); ++i26) r18[i26 + e21] = t15[i26];
  return i26;
}
function X(t15) {
  return null != t15 && (!!t15._isBuffer || $(t15) || function(t16) {
    return "function" == typeof t16.readFloatLE && "function" == typeof t16.slice && $(t16.slice(0, 0));
  }(t15));
}
function $(t15) {
  return !!t15.constructor && "function" == typeof t15.constructor.isBuffer && t15.constructor.isBuffer(t15);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/interfaces.js
var t4;
var n4;
var e5;
var E2;
var O2;
var R2;
var o3;
var T2;
var N2;
var _2;
function i4(t15) {
  return void 0 !== (null == t15 ? void 0 : t15.errorCode);
}
!function(t15) {
  t15.Inline = "inline", t15.Desktop = "desktop", t15.Web = "web";
}(t4 || (t4 = {})), function(t15) {
  t15.M365Content = "m365content";
}(n4 || (n4 = {})), function(t15) {
  t15.DriveId = "driveId", t15.GroupId = "groupId", t15.SiteId = "siteId", t15.UserId = "userId";
}(e5 || (e5 = {})), function(t15) {
  t15[t15.NOT_SUPPORTED_ON_PLATFORM = 100] = "NOT_SUPPORTED_ON_PLATFORM", t15[t15.INTERNAL_ERROR = 500] = "INTERNAL_ERROR", t15[t15.NOT_SUPPORTED_IN_CURRENT_CONTEXT = 501] = "NOT_SUPPORTED_IN_CURRENT_CONTEXT", t15[t15.PERMISSION_DENIED = 1e3] = "PERMISSION_DENIED", t15[t15.NETWORK_ERROR = 2e3] = "NETWORK_ERROR", t15[t15.NO_HW_SUPPORT = 3e3] = "NO_HW_SUPPORT", t15[t15.INVALID_ARGUMENTS = 4e3] = "INVALID_ARGUMENTS", t15[t15.UNAUTHORIZED_USER_OPERATION = 5e3] = "UNAUTHORIZED_USER_OPERATION", t15[t15.INSUFFICIENT_RESOURCES = 6e3] = "INSUFFICIENT_RESOURCES", t15[t15.THROTTLE = 7e3] = "THROTTLE", t15[t15.USER_ABORT = 8e3] = "USER_ABORT", t15[t15.OPERATION_TIMED_OUT = 8001] = "OPERATION_TIMED_OUT", t15[t15.OLD_PLATFORM = 9e3] = "OLD_PLATFORM", t15[t15.FILE_NOT_FOUND = 404] = "FILE_NOT_FOUND", t15[t15.SIZE_EXCEEDED = 1e4] = "SIZE_EXCEEDED";
}(E2 || (E2 = {})), function(t15) {
  t15.GeoLocation = "geolocation", t15.Media = "media";
}(O2 || (O2 = {})), function(t15) {
  t15.BCAIS = "bcais", t15.BCWAF = "bcwaf", t15.BCWBF = "bcwbf";
}(R2 || (R2 = {})), function(t15) {
  t15.Faculty = "faculty", t15.Student = "student", t15.Other = "other";
}(o3 || (o3 = {})), function(t15) {
  t15.Adult = "adult", t15.MinorNoParentalConsentRequired = "minorNoParentalConsentRequired", t15.MinorWithoutParentalConsent = "minorWithoutParentalConsent", t15.MinorWithParentalConsent = "minorWithParentalConsent", t15.NotAdult = "notAdult", t15.NonAdult = "notAdult";
}(T2 || (T2 = {})), function(t15) {
  t15.HigherEducation = "higherEducation", t15.K12 = "k12", t15.Other = "other";
}(N2 || (N2 = {})), function(t15) {
  t15.TextPlain = "text/plain", t15.TextHtml = "text/html", t15.ImagePNG = "image/png", t15.ImageJPEG = "image/jpeg";
}(_2 || (_2 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/constants.js
var o4;
var i5;
var a2;
var n5;
var s2;
var t5;
var r3;
var m2;
!function(e21) {
  e21.desktop = "desktop", e21.web = "web", e21.android = "android", e21.ios = "ios", e21.ipados = "ipados", e21.macos = "macos", e21.visionOS = "visionOS", e21.rigel = "rigel", e21.surfaceHub = "surfaceHub", e21.teamsRoomsWindows = "teamsRoomsWindows", e21.teamsRoomsAndroid = "teamsRoomsAndroid", e21.teamsPhones = "teamsPhones", e21.teamsDisplays = "teamsDisplays";
}(o4 || (o4 = {})), function(e21) {
  e21.office = "Office", e21.outlook = "Outlook", e21.outlookWin32 = "OutlookWin32", e21.orange = "Orange", e21.places = "Places", e21.teams = "Teams", e21.teamsModern = "TeamsModern";
}(i5 || (i5 = {})), function(e21) {
  e21.settings = "settings", e21.content = "content", e21.authentication = "authentication", e21.remove = "remove", e21.task = "task", e21.sidePanel = "sidePanel", e21.stage = "stage", e21.meetingStage = "meetingStage";
}(a2 || (a2 = {})), function(e21) {
  e21.copilotSidePanel = "copilotSidePanel", e21.copilotMainPane = "copilotMainPane", e21.copilotFullScreen = "copilotFullScreen";
}(n5 || (n5 = {})), function(e21) {
  e21[e21.Standard = 0] = "Standard", e21[e21.Edu = 1] = "Edu", e21[e21.Class = 2] = "Class", e21[e21.Plc = 3] = "Plc", e21[e21.Staff = 4] = "Staff";
}(s2 || (s2 = {})), function(e21) {
  e21[e21.Admin = 0] = "Admin", e21[e21.User = 1] = "User", e21[e21.Guest = 2] = "Guest";
}(t5 || (t5 = {})), function(e21) {
  e21.Large = "large", e21.Medium = "medium", e21.Small = "small";
}(r3 || (r3 = {})), function(e21) {
  e21.Regular = "Regular", e21.Private = "Private", e21.Shared = "Shared";
}(m2 || (m2 = {}));
var l = { errorCode: E2.NOT_SUPPORTED_ON_PLATFORM };
var d2 = { majorVersion: 1, minorVersion: 5 };
var c3 = { adaptiveCardSchemaVersion: { majorVersion: 1, minorVersion: 5 } };
var u2 = new Error("Invalid input count: Must supply a valid image count (limit of 10).");
var f2 = new Error("Invalid response: Received more images than the specified max limit in the response.");

// node_modules/@microsoft/teams-js/dist/esm/node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/native.js
var o5 = { randomUUID: "undefined" != typeof crypto && crypto.randomUUID && crypto.randomUUID.bind(crypto) };

// node_modules/@microsoft/teams-js/dist/esm/node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/rng.js
var t6;
var e6 = new Uint8Array(16);
function o6() {
  if (!t6 && (t6 = "undefined" != typeof crypto && crypto.getRandomValues && crypto.getRandomValues.bind(crypto), !t6)) throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
  return t6(e6);
}

// node_modules/@microsoft/teams-js/dist/esm/node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/stringify.js
var t7 = [];
for (let n19 = 0; n19 < 256; ++n19) t7.push((n19 + 256).toString(16).slice(1));
function n6(n19, o24 = 0) {
  return t7[n19[o24 + 0]] + t7[n19[o24 + 1]] + t7[n19[o24 + 2]] + t7[n19[o24 + 3]] + "-" + t7[n19[o24 + 4]] + t7[n19[o24 + 5]] + "-" + t7[n19[o24 + 6]] + t7[n19[o24 + 7]] + "-" + t7[n19[o24 + 8]] + t7[n19[o24 + 9]] + "-" + t7[n19[o24 + 10]] + t7[n19[o24 + 11]] + t7[n19[o24 + 12]] + t7[n19[o24 + 13]] + t7[n19[o24 + 14]] + t7[n19[o24 + 15]];
}

// node_modules/@microsoft/teams-js/dist/esm/node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/v4.js
function t8(t15, m55, i26) {
  if (o5.randomUUID && !m55 && !t15) return o5.randomUUID();
  const f46 = (t15 = t15 || {}).random || (t15.rng || o6)();
  return f46[6] = 15 & f46[6] | 64, f46[8] = 63 & f46[8] | 128, n6(f46);
}

// node_modules/@microsoft/teams-js/dist/esm/node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/regex.js
var a3 = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;

// node_modules/@microsoft/teams-js/dist/esm/node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/validate.js
function e7(e21) {
  return "string" == typeof e21 && a3.test(e21);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/utils.js
function i6(t15) {
  return (t16, e21) => {
    if (!t16) throw new Error(e21);
  };
}
function s3(t15, e21) {
  if ("string" != typeof t15 || "string" != typeof e21) return NaN;
  const n19 = t15.split("."), r18 = e21.split(".");
  function o24(t16) {
    return /^\d+$/.test(t16);
  }
  if (!n19.every(o24) || !r18.every(o24)) return NaN;
  for (; n19.length < r18.length; ) n19.push("0");
  for (; r18.length < n19.length; ) r18.push("0");
  for (let t16 = 0; t16 < n19.length; ++t16) if (Number(n19[t16]) != Number(r18[t16])) return Number(n19[t16]) > Number(r18[t16]) ? 1 : -1;
  return 0;
}
function u3() {
  return t8();
}
function c4(t15) {
  return Object.keys(t15).forEach((e21) => {
    null !== t15[e21] && void 0 !== t15[e21] && "object" == typeof t15[e21] && c4(t15[e21]);
  }), Object.freeze(t15);
}
function a4(t15, e21, ...n19) {
  const r18 = t15(...n19);
  return r18.then((t16) => {
    e21 && e21(void 0, t16);
  }).catch((t16) => {
    e21 && e21(t16);
  }), r18;
}
function l2(t15, e21, ...n19) {
  const r18 = t15(...n19);
  return r18.then(() => {
    e21 && e21(null);
  }).catch((t16) => {
    e21 && e21(t16);
  }), r18;
}
function f3(t15, e21, ...n19) {
  const r18 = t15(...n19);
  return r18.then((t16) => {
    e21 && e21(null, t16);
  }).catch((t16) => {
    e21 && e21(t16, null);
  }), r18;
}
function p2(t15, e21, n19) {
  return new Promise((r18, o24) => {
    const i26 = setTimeout(o24, e21, n19);
    t15().then((t16) => {
      clearTimeout(i26), r18(t16);
    }).catch((t16) => {
      clearTimeout(i26), o24(t16);
    });
  });
}
function d3(t15) {
  const e21 = new URL("https://teams.microsoft.com/l/entity/" + encodeURIComponent(t15.appId.toString()) + "/" + encodeURIComponent(t15.pageId));
  return t15.webUrl && e21.searchParams.append("webUrl", t15.webUrl.toString()), (t15.chatId || t15.channelId || t15.subPageId) && e21.searchParams.append("context", JSON.stringify({ chatId: t15.chatId, channelId: t15.channelId, subEntityId: t15.subPageId })), e21.toString();
}
function m3(t15) {
  return !(s3(`${t15.majorVersion}.${t15.minorVersion}`, `${d2.majorVersion}.${d2.minorVersion}`) >= 0);
}
function h2(t15) {
  return "https:" === t15.protocol;
}
function b2(e21, n19) {
  return new Promise((r18, o24) => {
    if (e21 || o24("MimeType cannot be null or empty."), n19 || o24("Base64 string cannot be null or empty."), e21.startsWith("image/")) {
      const t15 = atob(n19), o25 = new Uint8Array(t15.length);
      for (let e22 = 0; e22 < t15.length; e22++) o25[e22] = t15.charCodeAt(e22);
      r18(new Blob([o25], { type: e21 }));
    }
    const i26 = y.from(n19, "base64").toString();
    r18(new Blob([i26], { type: e21 }));
  });
}
function g2(t15) {
  return new Promise((e21, n19) => {
    0 === t15.size && n19(new Error("Blob cannot be empty."));
    const r18 = new FileReader();
    r18.onloadend = () => {
      r18.result ? e21(r18.result.toString().split(",")[1]) : n19(new Error("Failed to read the blob"));
    }, r18.onerror = () => {
      n19(r18.error);
    }, r18.readAsDataURL(t15);
  });
}
function w2() {
  if (y2()) throw new Error("window object undefined at SSR check");
  return window;
}
function y2() {
  return "undefined" == typeof window;
}
function j2(t15, e21) {
  if (E3(t15) || !function(t16) {
    return t16.length < 256 && t16.length > 4;
  }(t15) || !function(t16) {
    for (let e22 = 0; e22 < t16.length; e22++) {
      const n19 = t16.charCodeAt(e22);
      if (n19 < 32 || n19 > 126) return false;
    }
    return true;
  }(t15)) throw e21 || new Error("id is not valid.");
}
function I2(t15, e21) {
  const n19 = t15.toString().toLocaleLowerCase();
  if (E3(n19)) throw new Error("Invalid Url");
  if (n19.length > 2048) throw new Error("Url exceeds the maximum size of 2048 characters");
  if (!h2(t15)) throw new Error("Url should be a valid https url");
}
function v2(t15) {
  const e21 = document.createElement("a");
  return e21.href = t15, new URL(e21.href);
}
function E3(t15) {
  return new RegExp(`${/<script[^>]*>|&lt;script[^&]*&gt;|%3Cscript[^%]*%3E/gi.source}|${/<\/script[^>]*>|&lt;\/script[^&]*&gt;|%3C\/script[^%]*%3E/gi.source}`, "gi").test(t15);
}
function O3(t15) {
  if (!t15) throw new Error("id must not be empty");
  if (false === e7(t15)) throw new Error("id must be a valid UUID");
}
var U2 = !!performance && "now" in performance;
function N3() {
  return U2 ? performance.now() + performance.timeOrigin : void 0;
}
function S2(t15, e21 = 0) {
  if (e21 > 1e3) return false;
  if (void 0 === t15 || "boolean" == typeof t15 || "number" == typeof t15 || "bigint" == typeof t15 || "string" == typeof t15 || null === t15) return true;
  if (Array.isArray(t15)) return t15.every((t16) => S2(t16, e21 + 1));
  return !("object" != typeof t15 || "[object Object]" !== Object.prototype.toString.call(t15) || Object.getPrototypeOf(t15) !== Object.prototype && null !== Object.getPrototypeOf(t15)) && Object.keys(t15).every((n19) => S2(t15[n19], e21 + 1));
}
function P2(t15) {
  var e21, r18;
  if (!(null === (r18 = null === (e21 = t15.hostVersionsInfo) || void 0 === e21 ? void 0 : e21.appEligibilityInformation) || void 0 === r18 ? void 0 : r18.ageGroup)) return t15;
  const o24 = t15.hostVersionsInfo.appEligibilityInformation.ageGroup;
  return "nonadult" !== (null == o24 ? void 0 : o24.toLowerCase()) ? t15 : Object.assign(Object.assign({}, t15), { hostVersionsInfo: Object.assign(Object.assign({}, t15.hostVersionsInfo), { appEligibilityInformation: Object.assign(Object.assign({}, t15.hostVersionsInfo.appEligibilityInformation), { ageGroup: T2.NotAdult }) }) });
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/uuidObject.js
var n7 = class {
  constructor(n19 = u3()) {
    this.uuid = n19, O3(n19);
  }
  toString() {
    return this.uuid;
  }
  serialize() {
    return this.toString();
  }
};
function r4(i26) {
  if (!(i26 instanceof n7)) throw new Error(`Potential id (${JSON.stringify(i26)}) is invalid; it is not an instance of UUID class.`);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/messageObjects.js
var u4 = (t15) => {
  const { uuid: u52 } = t15, s38 = t2(t15, ["uuid"]), n19 = null == u52 ? void 0 : u52.toString();
  return Object.assign(Object.assign({}, s38), { uuidAsString: n19 });
};
var s4 = (u52) => {
  const { uuidAsString: s38 } = u52, n19 = t2(u52, ["uuidAsString"]);
  return Object.assign(Object.assign({}, n19), { uuid: s38 ? new n7(s38) : void 0 });
};
var n8 = (u52) => {
  const { uuidAsString: s38 } = u52, n19 = t2(u52, ["uuidAsString"]);
  return Object.assign(Object.assign({}, n19), { uuid: s38 ? new n7(s38) : void 0 });
};
var r5 = (t15) => {
  const { uuid: u52 } = t15, s38 = t2(t15, ["uuid"]), n19 = null == u52 ? void 0 : u52.toString();
  return Object.assign(Object.assign({}, s38), { uuidAsString: n19 });
};

// node_modules/@microsoft/teams-js/dist/esm/_virtual/browser.js
var e8 = { exports: {} };

// node_modules/@microsoft/teams-js/dist/esm/node_modules/.pnpm/ms@2.1.2/node_modules/ms/index.js
var e9;
var r6;
function s5() {
  if (r6) return e9;
  r6 = 1;
  var s38 = 1e3, n19 = 60 * s38, a35 = 60 * n19, t15 = 24 * a35, c43 = 7 * t15, u52 = 365.25 * t15;
  function i26(e21, r18, s39, n20) {
    var a36 = r18 >= 1.5 * s39;
    return Math.round(e21 / s39) + " " + n20 + (a36 ? "s" : "");
  }
  return e9 = function(e21, r18) {
    r18 = r18 || {};
    var o24 = typeof e21;
    if ("string" === o24 && e21.length > 0) return function(e22) {
      if ((e22 = String(e22)).length > 100) return;
      var r19 = /^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e22);
      if (!r19) return;
      var i27 = parseFloat(r19[1]);
      switch ((r19[2] || "ms").toLowerCase()) {
        case "years":
        case "year":
        case "yrs":
        case "yr":
        case "y":
          return i27 * u52;
        case "weeks":
        case "week":
        case "w":
          return i27 * c43;
        case "days":
        case "day":
        case "d":
          return i27 * t15;
        case "hours":
        case "hour":
        case "hrs":
        case "hr":
        case "h":
          return i27 * a35;
        case "minutes":
        case "minute":
        case "mins":
        case "min":
        case "m":
          return i27 * n19;
        case "seconds":
        case "second":
        case "secs":
        case "sec":
        case "s":
          return i27 * s38;
        case "milliseconds":
        case "millisecond":
        case "msecs":
        case "msec":
        case "ms":
          return i27;
        default:
          return;
      }
    }(e21);
    if ("number" === o24 && isFinite(e21)) return r18.long ? function(e22) {
      var r19 = Math.abs(e22);
      if (r19 >= t15) return i26(e22, r19, t15, "day");
      if (r19 >= a35) return i26(e22, r19, a35, "hour");
      if (r19 >= n19) return i26(e22, r19, n19, "minute");
      if (r19 >= s38) return i26(e22, r19, s38, "second");
      return e22 + " ms";
    }(e21) : function(e22) {
      var r19 = Math.abs(e22);
      if (r19 >= t15) return Math.round(e22 / t15) + "d";
      if (r19 >= a35) return Math.round(e22 / a35) + "h";
      if (r19 >= n19) return Math.round(e22 / n19) + "m";
      if (r19 >= s38) return Math.round(e22 / s38) + "s";
      return e22 + "ms";
    }(e21);
    throw new Error("val is not a non-empty string or a valid number. val=" + JSON.stringify(e21));
  };
}

// node_modules/@microsoft/teams-js/dist/esm/node_modules/.pnpm/debug@4.3.5/node_modules/debug/src/common.js
var n9 = function(n19) {
  function t15(e21) {
    let n20, s39, o24, a35 = null;
    function l43(...e22) {
      if (!l43.enabled) return;
      const r19 = l43, s40 = Number(/* @__PURE__ */ new Date()), o25 = s40 - (n20 || s40);
      r19.diff = o25, r19.prev = n20, r19.curr = s40, n20 = s40, e22[0] = t15.coerce(e22[0]), "string" != typeof e22[0] && e22.unshift("%O");
      let a36 = 0;
      e22[0] = e22[0].replace(/%([a-zA-Z%])/g, (n21, s41) => {
        if ("%%" === n21) return "%";
        a36++;
        const o26 = t15.formatters[s41];
        if ("function" == typeof o26) {
          const t16 = e22[a36];
          n21 = o26.call(r19, t16), e22.splice(a36, 1), a36--;
        }
        return n21;
      }), t15.formatArgs.call(r19, e22);
      (r19.log || t15.log).apply(r19, e22);
    }
    return l43.namespace = e21, l43.useColors = t15.useColors(), l43.color = t15.selectColor(e21), l43.extend = r18, l43.destroy = t15.destroy, Object.defineProperty(l43, "enabled", { enumerable: true, configurable: false, get: () => null !== a35 ? a35 : (s39 !== t15.namespaces && (s39 = t15.namespaces, o24 = t15.enabled(e21)), o24), set: (e22) => {
      a35 = e22;
    } }), "function" == typeof t15.init && t15.init(l43), l43;
  }
  function r18(e21, n20) {
    const r19 = t15(this.namespace + (void 0 === n20 ? ":" : n20) + e21);
    return r19.log = this.log, r19;
  }
  function s38(e21) {
    return e21.toString().substring(2, e21.toString().length - 2).replace(/\.\*\?$/, "*");
  }
  return t15.debug = t15, t15.default = t15, t15.coerce = function(e21) {
    if (e21 instanceof Error) return e21.stack || e21.message;
    return e21;
  }, t15.disable = function() {
    const e21 = [...t15.names.map(s38), ...t15.skips.map(s38).map((e22) => "-" + e22)].join(",");
    return t15.enable(""), e21;
  }, t15.enable = function(e21) {
    let n20;
    t15.save(e21), t15.namespaces = e21, t15.names = [], t15.skips = [];
    const r19 = ("string" == typeof e21 ? e21 : "").split(/[\s,]+/), s39 = r19.length;
    for (n20 = 0; n20 < s39; n20++) r19[n20] && ("-" === (e21 = r19[n20].replace(/\*/g, ".*?"))[0] ? t15.skips.push(new RegExp("^" + e21.slice(1) + "$")) : t15.names.push(new RegExp("^" + e21 + "$")));
  }, t15.enabled = function(e21) {
    if ("*" === e21[e21.length - 1]) return true;
    let n20, r19;
    for (n20 = 0, r19 = t15.skips.length; n20 < r19; n20++) if (t15.skips[n20].test(e21)) return false;
    for (n20 = 0, r19 = t15.names.length; n20 < r19; n20++) if (t15.names[n20].test(e21)) return true;
    return false;
  }, t15.humanize = s5(), t15.destroy = function() {
    console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");
  }, Object.keys(n19).forEach((e21) => {
    t15[e21] = n19[e21];
  }), t15.names = [], t15.skips = [], t15.formatters = {}, t15.selectColor = function(e21) {
    let n20 = 0;
    for (let t16 = 0; t16 < e21.length; t16++) n20 = (n20 << 5) - n20 + e21.charCodeAt(t16), n20 |= 0;
    return t15.colors[Math.abs(n20) % t15.colors.length];
  }, t15.enable(t15.load()), t15;
};

// node_modules/@microsoft/teams-js/dist/esm/node_modules/.pnpm/debug@4.3.5/node_modules/debug/src/browser.js
!function(e21, C18) {
  C18.formatArgs = function(o24) {
    if (o24[0] = (this.useColors ? "%c" : "") + this.namespace + (this.useColors ? " %c" : " ") + o24[0] + (this.useColors ? "%c " : " ") + "+" + e21.exports.humanize(this.diff), !this.useColors) return;
    const C19 = "color: " + this.color;
    o24.splice(1, 0, C19, "color: inherit");
    let t16 = 0, n19 = 0;
    o24[0].replace(/%[a-zA-Z%]/g, (e22) => {
      "%%" !== e22 && (t16++, "%c" === e22 && (n19 = t16));
    }), o24.splice(n19, 0, C19);
  }, C18.save = function(e22) {
    try {
      e22 ? C18.storage.setItem("debug", e22) : C18.storage.removeItem("debug");
    } catch (e23) {
    }
  }, C18.load = function() {
    let e22;
    try {
      e22 = C18.storage.getItem("debug");
    } catch (e23) {
    }
    !e22 && "undefined" != typeof process && "env" in process && (e22 = process.env.DEBUG);
    return e22;
  }, C18.useColors = function() {
    if ("undefined" != typeof window && window.process && ("renderer" === window.process.type || window.process.__nwjs)) return true;
    if ("undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)) return false;
    return "undefined" != typeof document && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || "undefined" != typeof window && window.console && (window.console.firebug || window.console.exception && window.console.table) || "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/) && parseInt(RegExp.$1, 10) >= 31 || "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/);
  }, C18.storage = function() {
    try {
      return localStorage;
    } catch (e22) {
    }
  }(), C18.destroy = /* @__PURE__ */ (() => {
    let e22 = false;
    return () => {
      e22 || (e22 = true, console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."));
    };
  })(), C18.colors = ["#0000CC", "#0000FF", "#0033CC", "#0033FF", "#0066CC", "#0066FF", "#0099CC", "#0099FF", "#00CC00", "#00CC33", "#00CC66", "#00CC99", "#00CCCC", "#00CCFF", "#3300CC", "#3300FF", "#3333CC", "#3333FF", "#3366CC", "#3366FF", "#3399CC", "#3399FF", "#33CC00", "#33CC33", "#33CC66", "#33CC99", "#33CCCC", "#33CCFF", "#6600CC", "#6600FF", "#6633CC", "#6633FF", "#66CC00", "#66CC33", "#9900CC", "#9900FF", "#9933CC", "#9933FF", "#99CC00", "#99CC33", "#CC0000", "#CC0033", "#CC0066", "#CC0099", "#CC00CC", "#CC00FF", "#CC3300", "#CC3333", "#CC3366", "#CC3399", "#CC33CC", "#CC33FF", "#CC6600", "#CC6633", "#CC9900", "#CC9933", "#CCCC00", "#CCCC33", "#FF0000", "#FF0033", "#FF0066", "#FF0099", "#FF00CC", "#FF00FF", "#FF3300", "#FF3333", "#FF3366", "#FF3399", "#FF33CC", "#FF33FF", "#FF6600", "#FF6633", "#FF9900", "#FF9933", "#FFCC00", "#FFCC33"], C18.log = console.debug || console.log || (() => {
  }), e21.exports = n9(C18);
  const { formatters: t15 } = e21.exports;
  t15.j = function(e22) {
    try {
      return JSON.stringify(e22);
    } catch (e23) {
      return "[UnexpectedJSONParseError]: " + e23.message;
    }
  };
}(e8, e8.exports);
var C2 = e8.exports;

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/telemetry.js
var n10 = new n7();
var o7 = C2.debug.formatArgs;
C2.debug.formatArgs = function(t15) {
  t15[0] = `(${(/* @__PURE__ */ new Date()).toISOString()}): ${t15[0]} [${n10.toString()}]`, o7.call(this, t15);
};
var r7 = C2.debug("teamsJs");
function u5(t15) {
  return r7.extend(t15);
}
function s6(t15, e21) {
  return `${t15}_${e21}`;
}
function d4(t15) {
  return /^v\d+_[\w.]+$/.test(t15);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/communicationUtils.js
function i7(e21) {
  return void 0 !== e21.uuidAsString ? `${e21.uuidAsString} (legacy id: ${e21.id})` : void 0 !== e21.uuid ? `${e21.uuid.toString()} (legacy id: ${e21.id})` : `legacy id: ${e21.id} (no uuid)`;
}
var t9 = u5("flushMessageQueue");
function u6(s38, u52, o24, g23) {
  if (s38 && u52 && 0 !== o24.length) for (; o24.length > 0; ) {
    const n19 = o24.shift();
    if (n19) {
      const o25 = u4(n19);
      t9("Flushing message %s from %s message queue via postMessage.", i7(o25), g23), s38.postMessage(o25, u52);
    }
  }
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/artifactsForCDN/validDomains.json.js
var o8 = ["teams.microsoft.com", "teams.microsoft.us", "gov.teams.microsoft.us", "dod.teams.microsoft.us", "int.teams.microsoft.com", "outlook.office.com", "outlook-sdf.office.com", "outlook.office365.com", "outlook-sdf.office365.com", "outlook.office365.us", "outlook-dod.office365.us", "webmail.apps.mil", "outlook.live.com", "outlook-sdf.live.com", "teams.live.com", "local.teams.live.com", "local.teams.live.com:8080", "local.teams.office.com", "local.teams.office.com:8080", "devspaces.skype.com", "*.www.office.com", "www.office.com", "word.office.com", "excel.office.com", "powerpoint.office.com", "www.officeppe.com", "*.www.microsoft365.com", "www.microsoft365.com", "bing.com", "edgeservices.bing.com", "work.bing.com", "www.bing.com", "www.staging-bing-int.com", "*.cloud.microsoft", "*.m365.cloud.microsoft", "*.outlook.cloud.microsoft", "chatuxmanager.svc.cloud.microsoft", "copilot.microsoft.com", "windows.msn.com", "fa000000125.resources.office.net", "fa000000129.resources.office.net", "fa000000124.resources.office.net", "fa000000128.resources.office.net", "fa000000136.resources.office.net", "fa000000125.officeapps.live.com", "fa000000129.officeapps.live.com", "fa000000124.officeapps.live.com", "fa000000128.officeapps.live.com"];

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/constants.js
var i8 = "2.0.1";
var s7 = "2.0.2";
var e10 = "2.0.3";
var n11 = "2.0.4";
var o9 = "2.0.1";
var a5 = "1.9.0";
var r8 = "2.0.0";
var m4 = "1.7.0";
var l3 = "1.8.0";
var d5 = "2.0.0";
var h3 = "1.9.0";
var p3 = o8;
var c5 = 1500;
var f4 = new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json");
var j3 = /^https:\/\//;
var v3 = "https";
var y3 = "teams.microsoft.com";
var D2 = "The library has not yet been initialized";
var T3 = "The runtime has not yet been initialized";
var b3 = "The runtime version is not supported";
var u7 = "The call was not properly started";

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/globalVars.js
var e11 = class {
};
e11.initializeCalled = false, e11.initializeCompleted = false, e11.additionalValidOrigins = [], e11.initializePromise = void 0, e11.isFramelessWindow = false, e11.frameContext = void 0, e11.hostClientType = void 0, e11.printCapabilityEnabled = false, e11.teamsJsInstanceId = new n7().toString();

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/runtime.js
var l4 = u5("runtime");
var d6 = 4;
function u8(o24) {
  return o24.apiVersion === d6;
}
function c6(o24) {
  if (u8(o24)) return true;
  throw -1 === o24.apiVersion ? new Error(T3) : new Error(b3);
}
var g3 = { apiVersion: -1, supports: {} };
var m5 = { apiVersion: 4, isNAAChannelRecommended: false, isDeeplyNestedAuthSupported: false, hostVersionsInfo: c3, isLegacyTeams: true, supports: { appInstallDialog: {}, appEntity: {}, call: {}, chat: {}, conversations: {}, dialog: { card: { bot: {} }, url: { bot: {}, parentCommunication: {} }, update: {} }, interactive: {}, logs: {}, meetingRoom: {}, menus: {}, monetization: {}, notifications: {}, pages: { config: {}, backStack: {}, fullTrust: {} }, remoteCamera: {}, teams: { fullTrust: {} }, teamsCore: {}, video: { sharedFrame: {} } } };
var y4 = [o4.desktop, o4.web, o4.rigel, o4.surfaceHub, o4.teamsRoomsWindows, o4.teamsRoomsAndroid, o4.teamsPhones, o4.teamsDisplays];
var b4 = [o4.android, o4.ios, o4.ipados, o4.visionOS];
var f5 = [...y4, ...b4];
function h4(o24) {
  let e21 = o24;
  if (e21.apiVersion < d6 && v4.forEach((o25) => {
    e21.apiVersion === o25.versionToUpgradeFrom && (e21 = o25.upgradeToNextVersion(e21));
  }), u8(e21)) return e21;
  throw new Error("Received a runtime that could not be upgraded to the latest version");
}
var v4 = [{ versionToUpgradeFrom: 1, upgradeToNextVersion: (o24) => {
  var e21;
  return { apiVersion: 2, hostVersionsInfo: void 0, isLegacyTeams: o24.isLegacyTeams, supports: Object.assign(Object.assign({}, o24.supports), { dialog: o24.supports.dialog ? { card: void 0, url: o24.supports.dialog, update: null === (e21 = o24.supports.dialog) || void 0 === e21 ? void 0 : e21.update } : void 0 }) };
} }, { versionToUpgradeFrom: 2, upgradeToNextVersion: (e21) => {
  const s38 = e21.supports, i26 = t2(s38, ["appNotification"]);
  return Object.assign(Object.assign({}, e21), { apiVersion: 3, supports: i26 });
} }, { versionToUpgradeFrom: 3, upgradeToNextVersion: (o24) => {
  var e21, s38, i26, t15, n19;
  return { apiVersion: 4, hostVersionsInfo: o24.hostVersionsInfo, isNAAChannelRecommended: o24.isNAAChannelRecommended, isLegacyTeams: o24.isLegacyTeams, supports: Object.assign(Object.assign({}, o24.supports), { dialog: o24.supports.dialog ? { card: null === (e21 = o24.supports.dialog) || void 0 === e21 ? void 0 : e21.card, url: { bot: null === (i26 = null === (s38 = o24.supports.dialog) || void 0 === s38 ? void 0 : s38.url) || void 0 === i26 ? void 0 : i26.bot, parentCommunication: (null === (t15 = o24.supports.dialog) || void 0 === t15 ? void 0 : t15.url) ? {} : void 0 }, update: null === (n19 = o24.supports.dialog) || void 0 === n19 ? void 0 : n19.update } : void 0 }) };
} }];
var T4 = "2.1.2";
var V2 = { "1.0.0": [{ capability: { pages: { appButton: {}, tabs: {} }, stageView: {} }, hostClientTypes: y4 }], "1.9.0": [{ capability: { location: {} }, hostClientTypes: f5 }], "2.0.0": [{ capability: { people: {} }, hostClientTypes: f5 }, { capability: { sharing: {} }, hostClientTypes: [o4.desktop, o4.web] }], "2.0.1": [{ capability: { teams: { fullTrust: { joinedTeams: {} } } }, hostClientTypes: [o4.android, o4.desktop, o4.ios, o4.teamsRoomsAndroid, o4.teamsPhones, o4.teamsDisplays, o4.web] }, { capability: { webStorage: {} }, hostClientTypes: [o4.desktop] }], "2.0.5": [{ capability: { webStorage: {} }, hostClientTypes: [o4.android, o4.ios] }], "2.0.8": [{ capability: { sharing: {} }, hostClientTypes: [o4.android, o4.ios] }], "2.1.1": [{ capability: { nestedAppAuth: {} }, hostClientTypes: [o4.android, o4.ios, o4.ipados, o4.visionOS] }], "2.1.2": [] };
var C3 = l4.extend("generateBackCompatRuntimeConfig");
function j4(o24, e21) {
  const s38 = Object.assign({}, o24);
  for (const i26 in e21) Object.prototype.hasOwnProperty.call(e21, i26) && ("object" != typeof e21[i26] || Array.isArray(e21[i26]) ? i26 in o24 || (s38[i26] = e21[i26]) : s38[i26] = j4(o24[i26] || {}, e21[i26]));
  return s38;
}
function w3(o24, e21, s38) {
  C3("generating back compat runtime config for %s", o24);
  let t15 = Object.assign({}, e21.supports);
  C3("Supported capabilities in config before updating based on highestSupportedVersion: %o", t15), Object.keys(s38).forEach((e22) => {
    s3(o24, e22) >= 0 && s38[e22].forEach((o25) => {
      void 0 !== e11.hostClientType && o25.hostClientTypes.includes(e11.hostClientType) && (t15 = j4(t15, o25.capability));
    });
  });
  const a35 = { apiVersion: d6, hostVersionsInfo: c3, isLegacyTeams: true, supports: t15 };
  return C3("Runtime config after updating based on highestSupportedVersion: %o", a35), a35;
}
var O4 = l4.extend("applyRuntimeConfig");
function A2(o24) {
  "string" == typeof o24.apiVersion && (O4("Trying to apply runtime with string apiVersion, processing as v1: %o", o24), o24 = Object.assign(Object.assign({}, o24), { apiVersion: 1 })), O4("Fast-forwarding runtime %o", o24);
  const e21 = h4(o24);
  O4("Applying runtime %o", e21), g3 = c4(e21);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/serializable.interface.js
function e12(e21) {
  return null != e21 && void 0 !== e21.serialize && "function" == typeof e21.serialize;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/version.js
var o10 = "2.43.0";

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/hostToAppTelemetry.js
var a6 = class _a {
  static storeCallbackInformation(e21, t15) {
    _a.callbackInformation.set(e21, t15);
  }
  static clearMessages() {
    _a.callbackInformation.clear();
  }
  static deleteMessageInformation(e21) {
    _a.callbackInformation.delete(e21);
  }
  static handleOneWayPerformanceMetrics(a35, t15, n19) {
    const o24 = a35.monotonicTimestamp;
    o24 && n19 ? y5({ actionName: a35.func, messageDelay: n19 - o24, requestStartedAt: o24 }) : t15("Unable to send performance metrics for event %s", a35.func);
  }
  static handlePerformanceMetrics(t15, n19, o24, s38) {
    const c43 = _a.callbackInformation.get(t15);
    c43 && n19.monotonicTimestamp && s38 ? (y5({ actionName: c43.name, messageDelay: s38 - n19.monotonicTimestamp, requestStartedAt: c43.calledAt }), _a.deleteMessageInformation(t15)) : o24("Unable to send performance metrics for callback %s with arguments %o", t15.toString(), n19.args);
  }
};
a6.callbackInformation = /* @__PURE__ */ new Map();

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/nestedAppAuthUtils.js
var s8 = u5("nestedAppAuthUtils");
var r9 = s8.extend("tryPolyfillWithNestedAppAuthBridge");
var o11 = "v2";
function i9(t15, s38, i26) {
  var p56;
  const u52 = r9;
  if (e11.isFramelessWindow) return void u52("Cannot polyfill nestedAppAuthBridge as current window is frameless");
  if (!s38) return void u52("Cannot polyfill nestedAppAuthBridge as current window does not exist");
  if (s38.parent !== s38.top) return void u52("Default NAA bridge injection not supported in nested iframe. Use standalone NAA bridge instead.");
  const a35 = (() => {
    try {
      return JSON.parse(t15);
    } catch (e21) {
      return null;
    }
  })();
  if (!a35 || !(null === (p56 = a35.supports) || void 0 === p56 ? void 0 : p56.nestedAppAuth)) return void u52("Cannot polyfill nestedAppAuthBridge as current hub does not support nested app auth");
  const l43 = s38;
  if (l43.nestedAppAuthBridge) return void u52("nestedAppAuthBridge already exists on current window, skipping polyfill");
  const A17 = function(e21, t16) {
    const s39 = d7;
    if (!e21) return s39("nestedAppAuthBridge cannot be created as current window does not exist"), null;
    const { onMessage: r18, sendPostMessage: i27 } = t16, p57 = (e22) => (t17) => r18(t17, e22);
    return { addEventListener: (t17, n19) => {
      "message" === t17 ? e21.addEventListener(t17, p57(n19)) : s39(`Event ${t17} is not supported by nestedAppAuthBridge`);
    }, postMessage: (e22) => {
      const t17 = (() => {
        try {
          return JSON.parse(e22);
        } catch (e23) {
          return null;
        }
      })();
      if (!t17 || "object" != typeof t17 || "NestedAppAuthRequest" !== t17.messageType) return void s39("Unrecognized data format received by app, message being ignored. Message: %o", e22);
      const r19 = s6(o11, "nestedAppAuth.execute");
      i27(e22, r19);
    }, removeEventListener: (t17, n19) => {
      e21.removeEventListener(t17, p57(n19));
    } };
  }(l43, i26);
  A17 && (l43.nestedAppAuthBridge = A17);
}
var d7 = s8.extend("createNestedAppAuthBridge");

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/validOrigins.js
var a7 = [];
var u9 = u5("validateOrigin");
var c7;
function f6() {
  return n(this, void 0, void 0, function* () {
    c7 || (yield g4());
  });
}
function d8() {
  return 0 === a7.length;
}
function g4(e21 = false) {
  return n(this, void 0, void 0, function* () {
    if (!d8() && !e21) return a7;
    if (c7) return c7;
    if (y2()) return a7 = p3, p3;
    {
      u9("Initiating fetch call to acquire valid origins list from CDN");
      const i26 = new AbortController(), e22 = setTimeout(() => i26.abort(), c5);
      return c7 = fetch(f4, { signal: i26.signal }).then((i27) => {
        if (clearTimeout(e22), !i27.ok) throw new Error("Invalid Response from Fetch Call");
        return u9("Fetch call completed and retrieved valid origins list from CDN"), i27.json().then((i28) => {
          if (function(i29) {
            let t15 = JSON.parse(i29);
            try {
              t15 = JSON.parse(i29);
            } catch (i30) {
              return false;
            }
            if (!t15.validOrigins) return false;
            for (const i30 of t15.validOrigins) try {
              new URL("https://" + i30);
            } catch (t16) {
              return u9("isValidOriginsFromCDN call failed to validate origin: %s", i30), false;
            }
            return true;
          }(JSON.stringify(i28))) return a7 = i28.validOrigins, a7;
          throw new Error("Valid origins list retrieved from CDN is invalid");
        });
      }).catch((i27) => ("AbortError" === i27.name ? u9(`validOrigins fetch call to CDN failed due to Timeout of ${c5} ms. Defaulting to fallback list`) : u9("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list", i27), a7 = p3, a7)), c7;
    }
  });
}
function p4(i26, t15) {
  if ("*." === i26.substring(0, 2)) {
    const r18 = i26.substring(1);
    if (t15.length > r18.length && t15.split(".").length === r18.split(".").length && t15.substring(t15.length - r18.length) === r18) return true;
  } else if (i26 === t15) return true;
  return false;
}
function h5(i26, t15) {
  const r18 = d8() ? p3 : a7;
  return m6(i26, r18) ? Promise.resolve(true) : (u9("Origin %s is not in the local valid origins list, fetching from CDN", i26), g4(t15).then((t16) => m6(i26, t16)));
}
function m6(i26, t15) {
  if (!h2(i26)) return u9("Origin %s is invalid because it is not using https protocol. Protocol being used: %s", i26, i26.protocol), false;
  const r18 = i26.host;
  if (t15.some((i27) => p4(i27, r18))) return true;
  for (const i27 of e11.additionalValidOrigins) {
    if (p4("https://" === i27.substring(0, 8) ? i27.substring(8) : i27, r18)) return true;
  }
  return u9("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o", i26, t15, e11.additionalValidOrigins), false;
}
f6();

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/communication.js
var k2 = u5("communication");
var I3 = class {
};
var T5 = class {
};
function E4(n19, t15) {
  if (T5.messageListener = (n20) => function(n21) {
    return n(this, void 0, void 0, function* () {
      if (!n21 || !n21.data || "object" != typeof n21.data) return void J2("Unrecognized message format received by app, message being ignored. Message: %o", n21);
      const e21 = n21.source || n21.originalEvent && n21.originalEvent.source, t16 = n21.origin || n21.originalEvent && n21.originalEvent.origin;
      return B2(e21, t16).then((o24) => {
        o24 ? (!function(e22, n22) {
          e11.isFramelessWindow || I3.parentWindow && !I3.parentWindow.closed && e22 !== I3.parentWindow || (I3.parentWindow = e22, I3.parentOrigin = n22);
          I3.parentWindow && I3.parentWindow.closed && (I3.parentWindow = null, I3.parentOrigin = null);
          u6(I3.parentWindow, I3.parentOrigin, T5.parentMessageQueue, "parent");
        }(e21, t16), e21 !== I3.parentWindow ? f7(e21, t16) && w4(n21, e21, V3, (e22, n22) => T5.callbacks.set(e22, n22)) : Y2(n21)) : J2("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin, message: %o, source: %o, origin: %o", n21, e21, t16);
      });
    });
  }(n20), I3.currentWindow = I3.currentWindow || w2(), I3.parentWindow = I3.currentWindow.parent !== I3.currentWindow.self ? I3.currentWindow.parent : I3.currentWindow.opener, I3.topWindow = I3.currentWindow.top, (I3.parentWindow || n19) && I3.currentWindow.addEventListener("message", T5.messageListener, false), !I3.parentWindow) {
    const e21 = I3.currentWindow;
    if (!e21.nativeInterface) return Promise.reject(new Error("Initialization Failed. No Parent window found."));
    e11.isFramelessWindow = true, e21.onNativeMessage = Y2;
  }
  try {
    return I3.parentOrigin = "*", S3(t15, "initialize", [o10, d6, n19]).then(([e21, n20, t16, o24]) => (i9(o24, I3.currentWindow, { onMessage: D3, sendPostMessage: L2 }), { context: e21, clientType: n20, runtimeConfig: t16, clientSupportedSDKVersion: o24 }));
  } finally {
    I3.parentOrigin = null;
  }
}
function j5() {
  I3.currentWindow && I3.currentWindow.removeEventListener("message", T5.messageListener, false), I3.currentWindow = null, I3.parentWindow = null, I3.parentOrigin = null, T5.parentMessageQueue = [], T5.nextMessageId = 0, T5.callbacks.clear(), T5.promiseCallbacks.clear(), T5.portCallbacks.clear(), T5.legacyMessageIdsToUuidMap = {}, a6.clearMessages(), g5();
}
function O5(e21, n19, ...t15) {
  return S3(e21, n19, t15).then(([e22]) => e22);
}
function R3(e21, n19, ...t15) {
  return S3(e21, n19, t15).then(([e22, n20]) => {
    if (!e22) throw new Error(n20);
  });
}
function C4(e21, n19, t15, ...o24) {
  return S3(e21, n19, o24).then(([e22, n20]) => {
    if (!e22) throw new Error(n20 || t15);
  });
}
function P3(e21, n19, ...t15) {
  return S3(e21, n19, t15).then(([e22, n20]) => {
    if (e22) throw e22;
    return n20;
  });
}
function S3(e21, n19, t15 = void 0) {
  if (!d4(e21)) throw Error(`apiVersionTag: ${e21} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);
  return new Promise((o24) => {
    const r18 = V3(e21, n19, t15);
    var i26;
    o24((i26 = r18.uuid, new Promise((e22) => {
      T5.promiseCallbacks.set(i26, e22);
    })));
  });
}
function x2(e21) {
  return e21.map((e22) => e12(e22) ? e22.serialize() : e22);
}
function N4(o24, r18, i26, s38, a35) {
  var c43;
  return n(this, void 0, void 0, function* () {
    const e21 = x2(r18), [d39] = yield S3(s38, o24, e21);
    if (a35 && a35(d39) || !a35 && i4(d39)) throw new Error(`${d39.errorCode}, message: ${null !== (c43 = d39.message) && void 0 !== c43 ? c43 : "None"}`);
    if (i26.validate(d39)) return i26.deserialize(d39);
    throw new Error(`${E2.INTERNAL_ERROR}, message: Invalid response from host - ${JSON.stringify(d39)}`);
  });
}
function A3(o24, r18, i26, s38) {
  var a35;
  return n(this, void 0, void 0, function* () {
    const e21 = x2(r18), [c43] = yield S3(i26, o24, e21);
    if (s38 && s38(c43) || !s38 && i4(c43)) throw new Error(`${c43.errorCode}, message: ${null !== (a35 = c43.message) && void 0 !== a35 ? a35 : "None"}`);
    if (void 0 !== c43) throw new Error(`${E2.INTERNAL_ERROR}, message: Invalid response from host`);
  });
}
function U3(e21, n19, t15 = void 0) {
  if (!d4(e21)) throw Error(`apiVersionTag: ${e21} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);
  const o24 = V3(e21, n19, t15);
  return r18 = o24.uuid, new Promise((e22, n20) => {
    T5.portCallbacks.set(r18, (t16, o25) => {
      t16 instanceof MessagePort ? e22(t16) : n20(o25 && o25.length > 0 ? o25[0] : new Error("Host responded without port or error details."));
    });
  });
  var r18;
}
function $2(e21, n19, t15, o24) {
  let r18;
  if (t15 instanceof Function ? o24 = t15 : t15 instanceof Array && (r18 = t15), !d4(e21)) throw Error(`apiVersionTag: ${e21} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);
  const i26 = V3(e21, n19, r18);
  o24 && T5.callbacks.set(i26.uuid, o24);
}
T5.parentMessageQueue = [], T5.topMessageQueue = [], T5.nextMessageId = 0, T5.callbacks = /* @__PURE__ */ new Map(), T5.promiseCallbacks = /* @__PURE__ */ new Map(), T5.portCallbacks = /* @__PURE__ */ new Map(), T5.legacyMessageIdsToUuidMap = {};
var z2 = k2.extend("sendNestedAuthRequestToTopWindow");
function L2(e21, n19) {
  const t15 = z2, o24 = I3.topWindow, r18 = function(e22, n20) {
    const t16 = T5.nextMessageId++, o25 = new n7();
    return T5.legacyMessageIdsToUuidMap[t16] = o25, { id: t16, uuid: o25, func: "nestedAppAuth.execute", timestamp: Date.now(), monotonicTimestamp: N3(), apiVersionTag: n20, args: [], data: e22 };
  }(e21, n19);
  return t15("Message %s information: %o", i7(r18), { actionName: r18.func }), F2(o24, r18);
}
var _3 = k2.extend("sendRequestToTargetWindowHelper");
function F2(e21, n19) {
  const t15 = _3, o24 = function(e22) {
    return e22 === I3.topWindow && Z2() ? "top" : e22 === I3.parentWindow ? "parent" : null;
  }(e21), r18 = u4(n19);
  if (e11.isFramelessWindow) I3.currentWindow && I3.currentWindow.nativeInterface && (t15("Sending message %s to %s via framelessPostMessage interface", i7(r18), o24), I3.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(r18)));
  else {
    const i26 = function(e22) {
      return e22 === I3.topWindow && Z2() ? I3.topOrigin : e22 === I3.parentWindow ? I3.parentOrigin : null;
    }(e21);
    e21 && i26 ? (t15("Sending message %s to %s via postMessage", i7(r18), o24), e21.postMessage(r18, i26)) : (t15("Adding message %s to %s message queue", i7(r18), o24), ee(e21).push(n19));
  }
  return n19;
}
var Q2 = k2.extend("sendMessageToParentHelper");
function V3(e21, n19, t15, o24, r18) {
  const s38 = Q2, a35 = I3.parentWindow, c43 = function(e22, n20, t16, o25, r19) {
    const s39 = T5.nextMessageId++, a36 = new n7();
    T5.legacyMessageIdsToUuidMap[s39] = a36;
    const c44 = true === o25 ? r19 : e11.teamsJsInstanceId;
    return { id: s39, uuid: a36, func: n20, timestamp: Date.now(), monotonicTimestamp: N3(), args: t16 || [], apiVersionTag: e22, isProxiedFromChild: null != o25 && o25, teamsJsInstanceId: c44 };
  }(e21, n19, t15, o24, r18);
  return a6.storeCallbackInformation(c43.uuid, { name: n19, calledAt: c43.timestamp }), s38("Message %s information: %o", i7(c43), { actionName: n19, args: t15 }), F2(a35, c43);
}
var J2 = k2.extend("processIncomingMessage");
var q2 = k2.extend("processAuthBridgeMessage");
function D3(e21, n19) {
  var t15, o24;
  const r18 = q2;
  if (!e21 || !e21.data || "object" != typeof e21.data) return void r18("Unrecognized message format received by app, message being ignored. Message: %o", e21);
  const { args: i26 } = e21.data, [, s38] = null != i26 ? i26 : [], a35 = (() => {
    try {
      return JSON.parse(s38);
    } catch (e22) {
      return null;
    }
  })();
  if (!a35 || "object" != typeof a35 || "NestedAppAuthResponse" !== a35.messageType) return void r18("Unrecognized data format received by app, message being ignored. Message: %o", e21);
  const c43 = e21.source || (null === (t15 = null == e21 ? void 0 : e21.originalEvent) || void 0 === t15 ? void 0 : t15.source), d39 = e21.origin || (null === (o24 = null == e21 ? void 0 : e21.originalEvent) || void 0 === o24 ? void 0 : o24.origin);
  c43 ? B2(c43, d39) ? (I3.topWindow && !I3.topWindow.closed && c43 !== I3.topWindow || (I3.topWindow = c43, I3.topOrigin = d39), I3.topWindow && I3.topWindow.closed && (I3.topWindow = null, I3.topOrigin = null), u6(I3.topWindow, I3.topOrigin, T5.topMessageQueue, "top"), n19(s38)) : r18("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin") : r18("Message being ignored by app because it is coming for a target that is null");
}
var H2 = k2.extend("shouldProcessIncomingMessage");
function B2(n19, t15) {
  return n(this, void 0, void 0, function* () {
    if (I3.currentWindow && n19 === I3.currentWindow) return H2("Should not process message because it is coming from the current window"), false;
    if (I3.currentWindow && I3.currentWindow.location && t15 && t15 === I3.currentWindow.location.origin) return true;
    {
      let e21;
      try {
        e21 = new URL(t15);
      } catch (e22) {
        return H2("Message has an invalid origin of %s", t15), false;
      }
      const n20 = yield h5(e21);
      return n20 || H2("Message has an invalid origin of %s", t15), n20;
    }
  });
}
var K2 = k2.extend("handleIncomingMessageFromParent");
function G2(e21, n19) {
  if (n19) {
    const t15 = [...e21].find(([e22, t16]) => e22.toString() === n19.toString());
    if (t15) return t15[0];
  }
}
function X2(e21, n19) {
  const t15 = G2(n19, e21.uuid);
  t15 && n19.delete(t15), e21.uuid ? T5.legacyMessageIdsToUuidMap = {} : delete T5.legacyMessageIdsToUuidMap[e21.id];
}
function Y2(e21) {
  const n19 = K2, t15 = N3();
  if ("id" in e21.data && "number" == typeof e21.data.id) {
    const o24 = e21.data, r18 = n8(o24), i26 = function(e22) {
      const n20 = K2;
      if (!e22.uuid) return T5.legacyMessageIdsToUuidMap[e22.id];
      {
        const n21 = e22.uuid, t16 = G2(T5.callbacks, n21);
        if (t16) return t16;
        const o25 = G2(T5.promiseCallbacks, n21);
        if (o25) return o25;
        const r19 = G2(T5.portCallbacks, n21);
        if (r19) return r19;
      }
      n20("Received message %s that failed to produce a callbackId", i7(e22));
    }(r18);
    if (i26) {
      const o25 = T5.callbacks.get(i26);
      n19("Received a response from parent for message %s", i26.toString()), a6.handlePerformanceMetrics(i26, r18, n19, t15), o25 && (n19("Invoking the registered callback for message %s with arguments %o", i26.toString(), r18.args), o25.apply(null, [...r18.args, r18.isPartialResponse]), function(e22) {
        return true === e22.data.isPartialResponse;
      }(e21) || (n19("Removing registered callback for message %s", i26.toString()), X2(r18, T5.callbacks)));
      const s38 = T5.promiseCallbacks.get(i26);
      s38 && (n19("Invoking the registered promise callback for message %s with arguments %o", i26.toString(), r18.args), s38(r18.args), n19("Removing registered promise callback for message %s", i26.toString()), X2(r18, T5.promiseCallbacks));
      const a35 = T5.portCallbacks.get(i26);
      if (a35) {
        let t16;
        n19("Invoking the registered port callback for message %s with arguments %o", i26.toString(), r18.args), e21.ports && e21.ports[0] instanceof MessagePort && (t16 = e21.ports[0]), a35(t16, r18.args), n19("Removing registered port callback for message %s", i26.toString()), X2(r18, T5.portCallbacks);
      }
      r18.uuid && (T5.legacyMessageIdsToUuidMap = {});
    }
  } else if ("func" in e21.data && "string" == typeof e21.data.func) {
    const o24 = e21.data;
    a6.handleOneWayPerformanceMetrics(o24, n19, t15), n19('Received a message from parent %s, action: "%s"', i7(o24), o24.func), h6(o24.func, o24.args);
  } else n19("Received an unknown message: %O", e21);
}
function Z2() {
  return I3.topWindow !== I3.parentWindow;
}
function ee(e21) {
  return e21 === I3.topWindow && Z2() ? T5.topMessageQueue : e21 === I3.parentWindow ? T5.parentMessageQueue : [];
}
function ne(e21, n19) {
  let t15;
  t15 = I3.currentWindow.setInterval(() => {
    0 === ee(e21).length && (clearInterval(t15), n19());
  }, 100);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/internalAPIs.js
var f8 = u5("internal");
var c8 = f8.extend("ensureInitializeCalled");
var d9 = f8.extend("ensureInitialized");
function p5() {
  if (!e11.initializeCalled) throw c8(D2), new Error(D2);
}
function m7(i26, ...t15) {
  if (!e11.initializeCompleted) throw d9("%s. initializeCalled: %s", D2, e11.initializeCalled.toString()), new Error(D2);
  if (t15 && t15.length > 0) {
    let i27 = false;
    for (let e21 = 0; e21 < t15.length; e21++) if (t15[e21] === e11.frameContext) {
      i27 = true;
      break;
    }
    if (!i27) throw new Error(`This call is only allowed in following contexts: ${JSON.stringify(t15)}. Current context: "${e11.frameContext}".`);
  }
  return c6(i26);
}
function u10(i26 = i8) {
  const t15 = s3(e11.clientSupportedSDKVersion, i26);
  return !isNaN(t15) && t15 >= 0;
}
function C5() {
  return e11.hostClientType == o4.android || e11.hostClientType == o4.ios || e11.hostClientType == o4.ipados || e11.hostClientType == o4.visionOS;
}
function h7(i26 = i8) {
  if (!C5()) {
    throw { errorCode: E2.NOT_SUPPORTED_ON_PLATFORM };
  }
  if (!u10(i26)) {
    throw { errorCode: E2.OLD_PLATFORM };
  }
}
function w5(i26) {
  let t15 = e11.additionalValidOrigins.concat(i26.filter((i27) => "string" == typeof i27 && j3.test(i27)));
  const e21 = {};
  t15 = t15.filter((i27) => !e21[i27] && (e21[i27] = true, true)), e11.additionalValidOrigins = t15;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/idValidation.js
function n12(i26) {
  if (!e13(i26)) throw new Error(`Potential app id (${i26}) is invalid; its length ${i26.length} is not within the length limits (${r10}-${a8}).`);
}
function o12(i26) {
  if (E3(i26)) throw new Error(`Potential app id (${i26}) is invalid; it contains script tags.`);
  if (s9(i26)) throw new Error(`Potential app id (${i26}) is invalid; it contains non-printable characters.`);
}
var r10 = 4;
var a8 = 256;
function e13(i26) {
  return i26.length < a8 && i26.length > r10;
}
function s9(i26) {
  return [...i26].some((i27) => {
    const t15 = i27.charCodeAt(0);
    return t15 < 32 || t15 > 126;
  });
}
function l5(t15) {
  if (!(t15 instanceof i10)) throw new Error(`Potential app id (${t15}) is invalid; it is not an instance of AppId class.`);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/validatedSafeString.js
var i11 = class {
  constructor(i26) {
    this.idAsString = i26, o12(i26);
  }
  serialize() {
    return this.toString();
  }
  toString() {
    return this.idAsString;
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/appId.js
var i10 = class extends i11 {
  constructor(r18) {
    super(r18), n12(r18);
  }
  toJSON() {
    return { appIdAsString: this.toString() };
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/pages/pages.js
var pages_exports = {};
__export(pages_exports, {
  EnterFocusType: () => A7,
  ReturnFocusType: () => T9,
  appButton: () => appButton_exports,
  backStack: () => backStack_exports,
  config: () => config_exports,
  currentApp: () => currentApp_exports,
  fullTrust: () => fullTrust_exports,
  getConfig: () => S7,
  initializeWithFrameContext: () => H6,
  isSupported: () => z4,
  navigateCrossDomain: () => D5,
  navigateToApp: () => G3,
  registerFocusEnterHandler: () => N8,
  registerFullScreenHandler: () => R6,
  returnFocus: () => w10,
  setCurrentFrame: () => b7,
  shareDeepLink: () => E7,
  tabs: () => tabs_exports
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/typeCheckUtilities.js
function n13(n19) {
  return null == n19;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/app/app.js
var app_exports = {};
__export(app_exports, {
  ExpectedFailureReason: () => b5,
  FailedReason: () => O7,
  Messages: () => N6,
  _initialize: () => A6,
  _uninitialize: () => z3,
  getContext: () => D4,
  getFrameContext: () => x3,
  initialize: () => L4,
  isInitialized: () => F4,
  lifecycle: () => lifecycle_exports,
  notifyAppLoaded: () => k4,
  notifyExpectedFailure: () => E5,
  notifyFailure: () => V4,
  notifySuccess: () => U4,
  openLink: () => W2,
  registerHostToAppPerformanceMetricsHandler: () => M2,
  registerOnThemeChangeHandler: () => H3
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/app/lifecycle.js
var lifecycle_exports = {};
__export(lifecycle_exports, {
  registerBeforeSuspendOrTerminateHandler: () => i12,
  registerOnResumeHandler: () => a9
});
function i12(r18) {
  if (!r18) throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");
  m7(g3), A4(r18);
}
function a9(e21) {
  if (!e21) throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");
  m7(g3), P4(e21);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/messageChannels/telemetry.js
var telemetry_exports = {};
__export(telemetry_exports, {
  _clearTelemetryPort: () => a10,
  getTelemetryPort: () => p6,
  isSupported: () => u11
});
var l6;
var m8 = u5("messageChannels.telemetry");
function p6() {
  return n(this, void 0, void 0, function* () {
    if (l6) return m8("Returning telemetry port from cache"), l6;
    if (!u11()) throw l;
    return l6 = yield U3(s6("v1", "messageChannels.telemetry.getTelemetryPort"), "messageChannels.telemetry.getTelemetryPort"), l6;
  });
}
function u11() {
  var e21;
  return !(!m7(g3) || !(null === (e21 = g3.supports.messageChannels) || void 0 === e21 ? void 0 : e21.telemetry));
}
function a10() {
  l6 = void 0;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/messageChannels/dataLayer.js
var dataLayer_exports = {};
__export(dataLayer_exports, {
  _clearDataLayerPort: () => u12,
  getDataLayerPort: () => m9,
  isSupported: () => p7
});
var s10;
var l7 = u5("messageChannels.dataLayer");
function m9() {
  return n(this, void 0, void 0, function* () {
    if (s10) return l7("Returning dataLayer port from cache"), s10;
    if (!p7()) throw l;
    return s10 = yield U3(s6("v1", "messageChannels.dataLayer.getDataLayerPort"), "messageChannels.dataLayer.getDataLayerPort"), s10;
  });
}
function p7() {
  var t15;
  return !(!m7(g3) || !(null === (t15 = g3.supports.messageChannels) || void 0 === t15 ? void 0 : t15.dataLayer));
}
function u12() {
  s10 = void 0;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/app/app.js
var j6 = "v2";
var w6 = u5("app");
var N6 = { AppLoaded: "appInitialization.appLoaded", Success: "appInitialization.success", Failure: "appInitialization.failure", ExpectedFailure: "appInitialization.expectedFailure" };
var O7;
var b5;
function F4() {
  return e11.initializeCompleted;
}
function x3() {
  return e11.frameContext;
}
function L4(i26) {
  return k3(s6(j6, "app.initialize"), i26);
}
function A6(e21) {
  I3.currentWindow = e21;
}
function z3() {
  e11.initializeCalled && (c9(), e11.initializeCalled = false, e11.initializeCompleted = false, e11.initializePromise = void 0, e11.additionalValidOrigins = [], e11.frameContext = void 0, e11.hostClientType = void 0, e11.isFramelessWindow = false, a10(), u12(), j5());
}
function D4() {
  return new Promise((e21) => {
    p5(), e21(O5(s6(j6, "app.getContext"), "getContext"));
  }).then((e21) => function(e22) {
    var i26;
    const t15 = { actionInfo: e22.actionInfo, app: { locale: e22.locale, sessionId: e22.appSessionId ? e22.appSessionId : "", theme: e22.theme ? e22.theme : "default", iconPositionVertical: e22.appIconPosition, osLocaleInfo: e22.osLocaleInfo, messageId: e22.messageId, parentMessageId: e22.parentMessageId, userClickTime: e22.userClickTime, userClickTimeV2: e22.userClickTimeV2, userFileOpenPreference: e22.userFileOpenPreference, host: { name: e22.hostName ? e22.hostName : i5.teams, clientType: e22.hostClientType ? e22.hostClientType : o4.web, sessionId: e22.sessionId ? e22.sessionId : "", ringId: e22.ringId }, appLaunchId: e22.appLaunchId, appId: e22.appId ? new i10(e22.appId) : void 0, manifestVersion: e22.manifestVersion }, page: { id: e22.entityId, frameContext: e22.frameContext ? e22.frameContext : e11.frameContext, renderingSurface: e22.renderingSurface ? e22.renderingSurface : void 0, subPageId: e22.subEntityId, isFullScreen: e22.isFullScreen, isMultiWindow: e22.isMultiWindow, isBackgroundLoad: e22.isBackgroundLoad, sourceOrigin: e22.sourceOrigin }, user: { id: null !== (i26 = e22.userObjectId) && void 0 !== i26 ? i26 : "", displayName: e22.userDisplayName, isCallingAllowed: e22.isCallingAllowed, isPSTNCallingAllowed: e22.isPSTNCallingAllowed, licenseType: e22.userLicenseType, loginHint: e22.loginHint, userPrincipalName: e22.userPrincipalName, tenant: e22.tid ? { id: e22.tid, teamsSku: e22.tenantSKU } : void 0 }, channel: e22.channelId ? { id: e22.channelId, displayName: e22.channelName, relativeUrl: e22.channelRelativeUrl, membershipType: e22.channelType, defaultOneNoteSectionId: e22.defaultOneNoteSectionId, ownerGroupId: e22.hostTeamGroupId, ownerTenantId: e22.hostTeamTenantId } : void 0, chat: e22.chatId ? { id: e22.chatId } : void 0, meeting: e22.meetingId ? { id: e22.meetingId } : void 0, sharepoint: e22.sharepoint, team: e22.teamId ? { internalId: e22.teamId, displayName: e22.teamName, type: e22.teamType, groupId: e22.groupId, templateId: e22.teamTemplateId, isArchived: e22.isTeamArchived, userRole: e22.userTeamRole } : void 0, sharePointSite: e22.teamSiteUrl || e22.teamSiteDomain || e22.teamSitePath || e22.mySitePath || e22.mySiteDomain ? { teamSiteUrl: e22.teamSiteUrl, teamSiteDomain: e22.teamSiteDomain, teamSitePath: e22.teamSitePath, teamSiteId: e22.teamSiteId, mySitePath: e22.mySitePath, mySiteDomain: e22.mySiteDomain } : void 0, dialogParameters: e22.dialogParameters || {} };
    return t15;
  }(e21));
}
function k4() {
  p5(), A5(s6(j6, "app.notifyAppLoaded"));
}
function U4() {
  return R4(s6(j6, "app.notifySuccess"));
}
function V4(e21) {
  p5(), N5(s6(j6, "app.notifyFailure"), e21);
}
function E5(e21) {
  p5(), F3(s6(j6, "app.notifyExpectedFailure"), e21);
}
function H3(e21) {
  L3(s6(j6, "app.registerOnThemeChangeHandler"), e21);
}
function M2(e21) {
  v5(e21);
}
function W2(e21) {
  return O6(s6(j6, "app.openLink"), e21);
}
!function(e21) {
  e21.AuthFailed = "AuthFailed", e21.Timeout = "Timeout", e21.Other = "Other";
}(O7 || (O7 = {})), function(e21) {
  e21.PermissionError = "PermissionError", e21.NotFound = "NotFound", e21.Throttling = "Throttling", e21.Offline = "Offline", e21.Other = "Other";
}(b5 || (b5 = {})), w6("teamsjs instance is version %s, starting at %s UTC (%s local)", o10, (/* @__PURE__ */ new Date()).toISOString(), (/* @__PURE__ */ new Date()).toLocaleString()), function() {
  if (y2()) return;
  const e21 = document.getElementsByTagName("script"), i26 = e21 && e21[e21.length - 1] && e21[e21.length - 1].src, t15 = "Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";
  i26 && 0 !== i26.length ? w6("teamsjs is being used from %s. %s", i26, t15) : w6("teamsjs is being used from a script tag embedded directly in your html. %s", t15);
}();

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/dialog/dialog.js
var dialog_exports = {};
__export(dialog_exports, {
  adaptiveCard: () => adaptiveCard_exports,
  initialize: () => p14,
  isSupported: () => l11,
  update: () => update_exports,
  url: () => url_exports
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/dialog/update.js
var update_exports = {};
__export(update_exports, {
  isSupported: () => p9,
  resize: () => n14
});
function n14(o24) {
  h8(s6(p8, "dialog.update.resize"), o24);
}
function p9() {
  return !(!m7(g3) || !g3.supports.dialog) && !!g3.supports.dialog.update;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/dialog/url/url.js
var url_exports = {};
__export(url_exports, {
  bot: () => bot_exports,
  getDialogInfoFromBotUrlDialogInfo: () => c10,
  getDialogInfoFromUrlDialogInfo: () => f9,
  isSupported: () => u14,
  open: () => a11,
  parentCommunication: () => parentCommunication_exports,
  submit: () => p12
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/dialog/url/bot.js
var bot_exports = {};
__export(bot_exports, {
  isSupported: () => e14,
  open: () => l8
});
function l8(t15, n19, l43) {
  k5(s6(p8, "dialog.url.bot.open"), t15, n19, l43);
}
function e14() {
  return m7(g3) && void 0 !== (g3.supports.dialog && g3.supports.dialog.url && g3.supports.dialog.url.bot);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/dialog/url/parentCommunication.js
var parentCommunication_exports = {};
__export(parentCommunication_exports, {
  isSupported: () => p11,
  registerOnMessageFromParent: () => u13,
  sendMessageToDialog: () => g7,
  sendMessageToParentFromDialog: () => d10
});
function d10(r18) {
  if (m7(g3, a2.task), !p11()) throw l;
  $2(s6(p8, "dialog.url.parentCommunication.sendMessageToParentFromDialog"), "messageForParent", [r18]);
}
function g7(r18) {
  if (m7(g3, a2.content, a2.sidePanel, a2.meetingStage), !p11()) throw l;
  $2(s6(p8, "dialog.url.parentCommunication.sendMessageToDialog"), "messageForChild", [r18]);
}
function u13(o24) {
  if (m7(g3, a2.task), !p11()) throw l;
  for (g6("messageForChild"), p10(s6(p8, "dialog.url.parentCommunication.registerMessageForChildHandler"), "messageForChild", o24), F5.reverse(); F5.length > 0; ) {
    o24(F5.pop());
  }
}
function p11() {
  var o24, r18;
  return m7(g3) && !!(null === (r18 = null === (o24 = g3.supports.dialog) || void 0 === o24 ? void 0 : o24.url) || void 0 === r18 ? void 0 : r18.parentCommunication);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/dialog/url/url.js
function a11(o24, i26, l43) {
  b6(s6(p8, "dialog.url.open"), o24, i26, l43);
}
function p12(t15, i26) {
  j7(s6(p8, "dialog.url.submit"), t15, i26);
}
function u14() {
  return m7(g3) && void 0 !== (g3.supports.dialog && g3.supports.dialog.url);
}
function f9(t15) {
  return { url: t15.url, height: t15.size ? t15.size.height : r3.Small, width: t15.size ? t15.size.width : r3.Small, title: t15.title, fallbackUrl: t15.fallbackUrl };
}
function c10(t15) {
  const o24 = f9(t15);
  return o24.completionBotId = t15.completionBotId, o24;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/dialogHelpers.js
var p8 = "v2";
function h8(r18, n19) {
  if (m7(g3, a2.content, a2.sidePanel, a2.task, a2.meetingStage), !p9()) throw l;
  $2(r18, "tasks.updateTask", [n19]);
}
function b6(r18, n19, c43, g23) {
  if (m7(g3, a2.content, a2.sidePanel, a2.meetingStage), !u14()) throw l;
  g23 && p10(s6(p8, "dialog.url.registerMessageForParentHandler"), "messageForParent", g23);
  const f46 = f9(n19);
  $2(r18, "tasks.startTask", [f46], (t15, e21) => {
    null == c43 || c43({ err: t15, result: e21 }), g6("messageForParent");
  });
}
function k5(r18, n19, c43, u52) {
  if (m7(g3, a2.content, a2.sidePanel, a2.meetingStage), !e14()) throw l;
  u52 && p10(s6(p8, "dialog.url.bot.registerMessageForParentHandler"), "messageForParent", u52);
  const d39 = c10(n19);
  $2(r18, "tasks.startTask", [d39], (t15, e21) => {
    null == c43 || c43({ err: t15, result: e21 }), g6("messageForParent");
  });
}
function j7(r18, a35, l43) {
  if (m7(g3, a2.content, a2.task), !u14()) throw l;
  e11.frameContext === a2.content && console.warn("dialog.submit should not be called from FrameContext.content.\nIf dialog.submit was called from inside the dialog, please disregard this message.\nThis issue occurs due to a bug in Teams mobile where the dialog is incorrectly identified as being in the content FrameContext.\nWe are working to resolve this."), $2(r18, "tasks.completeTask", [a35, l43 ? Array.isArray(l43) ? l43 : [l43] : []]);
}
function w7(t15) {
  return { card: t15.card, height: t15.size ? t15.size.height : r3.Small, width: t15.size ? t15.size.width : r3.Small, title: t15.title };
}
function P5(t15) {
  const e21 = w7(t15);
  return e21.completionBotId = t15.completionBotId, e21;
}
var F5 = [];
function S4(t15) {
  e11.frameContext && (e11.frameContext === a2.task ? F5.push(t15) : g6("messageForChild"));
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/dialog/adaptiveCard/adaptiveCard.js
var adaptiveCard_exports = {};
__export(adaptiveCard_exports, {
  bot: () => bot_exports2,
  isSupported: () => f10,
  open: () => l10
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/dialog/adaptiveCard/bot.js
var bot_exports2 = {};
__export(bot_exports2, {
  isSupported: () => l9,
  open: () => p13
});
function p13(i26, p56) {
  if (m7(g3, a2.content, a2.sidePanel, a2.meetingStage), !l9()) throw l;
  const d39 = P5(i26);
  $2(s6(p8, "dialog.adaptiveCard.bot.open"), "tasks.startTask", [d39], (o24, t15) => {
    null == p56 || p56({ err: o24, result: t15 });
  });
}
function l9() {
  const o24 = g3.hostVersionsInfo && g3.hostVersionsInfo.adaptiveCardSchemaVersion && !m3(g3.hostVersionsInfo.adaptiveCardSchemaVersion);
  return m7(g3) && void 0 !== (o24 && g3.supports.dialog && g3.supports.dialog.card && g3.supports.dialog.card.bot);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/dialog/adaptiveCard/adaptiveCard.js
function l10(i26, p56) {
  if (m7(g3, a2.content, a2.sidePanel, a2.meetingStage), !f10()) throw l;
  const l43 = w7(i26);
  $2(s6(p8, "dialog.adaptiveCard.open"), "tasks.startTask", [l43], (o24, t15) => {
    null == p56 || p56({ err: o24, result: t15 });
  });
}
function f10() {
  const o24 = g3.hostVersionsInfo && g3.hostVersionsInfo.adaptiveCardSchemaVersion && !m3(g3.hostVersionsInfo.adaptiveCardSchemaVersion);
  return m7(g3) && void 0 !== (o24 && g3.supports.dialog && g3.supports.dialog.card);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/dialog/dialog.js
function p14() {
  p10(s6(p8, "dialog.registerMessageForChildHandler"), "messageForChild", S4, false);
}
function l11() {
  return !(!m7(g3) || !g3.supports.dialog);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/menus.js
var menus_exports = {};
__export(menus_exports, {
  DisplayMode: () => u15,
  MenuItem: () => a12,
  MenuListType: () => m10,
  initialize: () => p15,
  isSupported: () => P6,
  setNavBarMenu: () => M3,
  setUpViews: () => d11,
  showActionMenu: () => v6
});
var i13 = "v2";
var u15;
var m10;
!function(e21) {
  e21[e21.ifRoom = 0] = "ifRoom", e21[e21.overflowOnly = 1] = "overflowOnly";
}(u15 || (u15 = {}));
var a12 = class {
  constructor() {
    this.enabled = true, this.selected = false;
  }
};
var f11;
var l12;
var c11;
function p15() {
  p10(s6(i13, "menus.registerNavBarMenuItemPressHandler"), "navBarMenuItemPress", h9, false), p10(s6(i13, "menus.registerActionMenuItemPressHandler"), "actionMenuItemPress", I4, false), p10(s6(i13, "menus.registerSetModuleViewHandler"), "setModuleView", w8, false);
}
function d11(n19, u52) {
  if (m7(g3), !P6()) throw l;
  c11 = u52, $2(s6(i13, "menus.setUpViews"), "setUpViews", [n19]);
}
function w8(n19) {
  c11 && c11(n19) || (m7(g3), $2(s6(i13, "menus.handleViewConfigItemPress"), "viewConfigItemPress", [n19]));
}
function M3(n19, u52) {
  if (m7(g3), !P6()) throw l;
  f11 = u52, $2(s6(i13, "menus.setNavBarMenu"), "setNavBarMenu", [n19]);
}
function h9(n19) {
  f11 && f11(n19) || (m7(g3), $2(s6(i13, "menus.handleNavBarMenuItemPress"), "handleNavBarMenuItemPress", [n19]));
}
function v6(n19, u52) {
  if (m7(g3), !P6()) throw l;
  l12 = u52, $2(s6(i13, "menus.showActionMenu"), "showActionMenu", [n19]);
}
function I4(n19) {
  l12 && l12(n19) || (m7(g3), $2(s6(i13, "menus.handleActionMenuItemPress"), "handleActionMenuItemPress", [n19]));
}
function P6() {
  return !(!m7(g3) || !g3.supports.menus);
}
!function(e21) {
  e21.dropDown = "dropDown", e21.popOver = "popOver";
}(m10 || (m10 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/responseHandler.js
var e15 = class {
};
var r11 = class extends e15 {
  validate(e21) {
    return true;
  }
  deserialize(e21) {
    return e21;
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/pages/config.js
var config_exports = {};
__export(config_exports, {
  initialize: () => h11,
  isSupported: () => O8,
  registerChangeConfigHandler: () => H4,
  registerOnRemoveHandler: () => j8,
  registerOnRemoveHandlerHelper: () => w9,
  registerOnSaveHandler: () => S5,
  registerOnSaveHandlerHelper: () => N7,
  setConfig: () => y6,
  setValidityState: () => d12
});
var p16;
var v8;
function h11() {
  p10(s6(h10, "pages.config.registerSettingsSaveHandler"), "settings.save", E6, false), p10(s6(h10, "pages.config.registerSettingsRemoveHandler"), "settings.remove", F6, false);
}
function d12(e21) {
  return T6(s6(h10, "pages.config.setValidityState"), e21);
}
function y6(e21) {
  return L5(s6(h10, "pages.config.setConfig"), e21);
}
function S5(e21) {
  N7(s6(h10, "pages.config.registerOnSaveHandler"), e21, () => {
    if (!n13(e21) && !O8()) throw l;
  });
}
function N7(e21, t15, n19) {
  !n13(t15) && m7(g3, a2.settings), n19 && n19(), p16 = t15, !n13(t15) && $2(e21, "registerHandler", ["save"]);
}
function j8(e21) {
  w9(s6(h10, "pages.config.registerOnRemoveHandler"), e21, () => {
    if (!n13(e21) && !O8()) throw l;
  });
}
function w9(e21, t15, n19) {
  !n13(t15) && m7(g3, a2.remove, a2.settings), n19 && n19(), v8 = t15, !n13(t15) && $2(e21, "registerHandler", ["remove"]);
}
function E6(i26) {
  const n19 = new C6(i26);
  p16 ? p16(n19) : m11() ? v7("settings.save", [i26]) : n19.notifySuccess();
}
function H4(e21) {
  U5(s6(h10, "pages.config.registerChangeConfigHandler"), "changeSettings", e21, [a2.content], () => {
    if (!O8()) throw l;
  });
}
var C6 = class {
  constructor(e21) {
    this.notified = false, this.result = e21 || {};
  }
  notifySuccess() {
    this.ensureNotNotified(), $2(s6(h10, "pages.saveEvent.notifySuccess"), "settings.save.success"), this.notified = true;
  }
  notifyFailure(e21) {
    this.ensureNotNotified(), $2(s6(h10, "pages.saveEvent.notifyFailure"), "settings.save.failure", [e21]), this.notified = true;
  }
  ensureNotNotified() {
    if (this.notified) throw new Error("The SaveEvent may only notify success or failure once.");
  }
};
function F6() {
  const i26 = new T7();
  v8 ? v8(i26) : m11() ? v7("settings.remove", []) : i26.notifySuccess();
}
var T7 = class {
  constructor() {
    this.notified = false;
  }
  notifySuccess() {
    this.ensureNotNotified(), $2(s6(h10, "pages.removeEvent.notifySuccess"), "settings.remove.success"), this.notified = true;
  }
  notifyFailure(e21) {
    this.ensureNotNotified(), $2(s6(h10, "pages.removeEvent.notifyFailure"), "settings.remove.failure", [e21]), this.notified = true;
  }
  ensureNotNotified() {
    if (this.notified) throw new Error("The removeEventType may only notify success or failure once.");
  }
};
function O8() {
  return !(!m7(g3) || !g3.supports.pages) && !!g3.supports.pages.config;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/appHelpers.js
var _4 = u5("app");
function k3(i26, e21) {
  if (y2()) {
    return _4.extend("initialize")("window object undefined at initialization"), Promise.resolve();
  }
  return p2(() => function(i27, e22) {
    return new Promise((t15) => {
      e11.initializeCalled || (e11.initializeCalled = true, f12(), e11.initializePromise = E4(e22, i27).then(({ context: i28, clientType: e23, runtimeConfig: t16, clientSupportedSDKVersion: n19 = i8 }) => {
        e11.frameContext = i28, e11.hostClientType = e23, e11.clientSupportedSDKVersion = n19;
        try {
          J3("Parsing %s", t16);
          let i29 = JSON.parse(t16);
          if (J3("Checking if %o is a valid runtime object", null != i29 ? i29 : "null"), !i29 || !i29.apiVersion) throw new Error("Received runtime config is invalid");
          i29 = P2(i29), t16 && A2(i29);
        } catch (i29) {
          if (!(i29 instanceof SyntaxError)) throw i29;
          try {
            J3("Attempting to parse %s as an SDK version", t16), isNaN(s3(t16, i8)) || (e11.clientSupportedSDKVersion = t16);
            let i30 = JSON.parse(n19);
            if (J3("givenRuntimeConfig parsed to %o", null != i30 ? i30 : "null"), !i30) throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");
            i30 = P2(i30), A2(i30);
          } catch (i30) {
            if (!(i30 instanceof SyntaxError)) throw i30;
            A2(w3(e11.clientSupportedSDKVersion, m5, V2));
          }
        }
        e11.initializeCompleted = true;
      }), p15(), h11(), p14()), Array.isArray(e22) && w5(e22), void 0 !== e11.initializePromise ? t15(e11.initializePromise) : J3("GlobalVars.initializePromise is unexpectedly undefined");
    });
  }(i26, e21), 6e4, new Error("SDK initialization timed out."));
}
function A5(i26) {
  $2(i26, N6.AppLoaded, [o10]);
}
function F3(i26, t15) {
  $2(i26, N6.ExpectedFailure, [t15.reason, t15.message]);
}
function N5(i26, t15) {
  $2(i26, N6.Failure, [t15.reason, t15.message]);
}
function R4(e21) {
  return n(this, void 0, void 0, function* () {
    if (e11.initializeCompleted) return H5(e21);
    if (!e11.initializePromise) throw new Error(D2);
    return e11.initializePromise.then(() => H5(e21));
  });
}
function H5(t15) {
  return n(this, void 0, void 0, function* () {
    return m7(g3) && (null === (i26 = g3.supports.app) || void 0 === i26 ? void 0 : i26.notifySuccessResponse) ? N4(N6.Success, [o10], new r11(), t15).then(() => ({ hasFinishedSuccessfully: true })) : ($2(t15, N6.Success, [o10]), { hasFinishedSuccessfully: "unknown" });
    var i26;
  });
}
var J3 = _4.extend("initializeHelper");
function L3(i26, e21) {
  !n13(e21) && p5(), T8(i26, e21);
}
function O6(i26, e21) {
  return new Promise((n19) => {
    m7(g3, a2.content, a2.sidePanel, a2.settings, a2.task, a2.stage, a2.meetingStage), n19(R3(i26, "executeDeepLink", e21));
  });
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/pages/appButton.js
var appButton_exports = {};
__export(appButton_exports, {
  isSupported: () => m12,
  onClick: () => i14,
  onHoverEnter: () => s11,
  onHoverLeave: () => u16
});
function i14(n19) {
  U5(s6(h10, "pages.appButton.onClick"), "appButtonClick", n19, [a2.content], () => {
    if (!m12()) throw l;
  });
}
function s11(n19) {
  U5(s6(h10, "pages.appButton.onHoverEnter"), "appButtonHoverEnter", n19, [a2.content], () => {
    if (!m12()) throw l;
  });
}
function u16(n19) {
  U5(s6(h10, "pages.appButton.onHoverLeave"), "appButtonHoverLeave", n19, [a2.content], () => {
    if (!m12()) throw l;
  });
}
function m12() {
  return !(!m7(g3) || !g3.supports.pages) && !!g3.supports.pages.appButton;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/pages/backStack.js
var backStack_exports = {};
__export(backStack_exports, {
  _initialize: () => m13,
  isSupported: () => k6,
  navigateBack: () => f13,
  registerBackButtonHandler: () => u17,
  registerBackButtonHandlerHelper: () => l13
});
function m13() {
  R5();
}
function f13() {
  return j9(s6(h10, "pages.backStack.navigateBack"));
}
function u17(t15) {
  l13(s6(h10, "pages.backStack.registerBackButtonHandler"), t15, () => {
    if (!n13(t15) && !k6()) throw l;
  });
}
function l13(n19, e21, i26) {
  !n13(e21) && m7(g3), i26 && i26(), F7(e21), !n13(e21) && $2(n19, "registerHandler", ["backButton"]);
}
function k6() {
  return !(!m7(g3) || !g3.supports.pages) && !!g3.supports.pages.backStack;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/pages/currentApp.js
var currentApp_exports = {};
__export(currentApp_exports, {
  isSupported: () => g8,
  navigateTo: () => o13,
  navigateToDefaultPage: () => p17
});
function o13(o24) {
  return new Promise((p56) => {
    if (m7(g3, a2.content, a2.sidePanel, a2.settings, a2.task, a2.stage, a2.meetingStage), !g8()) throw l;
    p56(P3(s6(h10, "pages.currentApp.navigateTo"), "pages.currentApp.navigateTo", o24));
  });
}
function p17() {
  return new Promise((o24) => {
    if (m7(g3, a2.content, a2.sidePanel, a2.settings, a2.task, a2.stage, a2.meetingStage), !g8()) throw l;
    o24(P3(s6(h10, "pages.currentApp.navigateToDefaultPage"), "pages.currentApp.navigateToDefaultPage"));
  });
}
function g8() {
  return !(!m7(g3) || !g3.supports.pages) && !!g3.supports.pages.currentApp;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/pages/fullTrust.js
var fullTrust_exports = {};
__export(fullTrust_exports, {
  enterFullscreen: () => l14,
  exitFullscreen: () => u18,
  isSupported: () => p18
});
function l14() {
  if (m7(g3, a2.content), !p18()) throw l;
  $2(s6(h10, "pages.fullTrust.enterFullscreen"), "enterFullscreen", []);
}
function u18() {
  if (m7(g3, a2.content), !p18()) throw l;
  $2(s6(h10, "pages.fullTrust.exitFullscreen"), "exitFullscreen", []);
}
function p18() {
  return !(!m7(g3) || !g3.supports.pages) && !!g3.supports.pages.fullTrust;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/pages/tabs.js
var tabs_exports = {};
__export(tabs_exports, {
  getMruTabInstances: () => u19,
  getTabInstances: () => i15,
  isSupported: () => m14,
  navigateToTab: () => p19
});
function p19(t15) {
  return v9(s6(h10, "pages.tabs.navigateToTab"), t15);
}
function i15(t15) {
  return S6(s6(h10, "pages.tabs.getTabInstances"), t15);
}
function u19(t15) {
  return k7(s6(h10, "pages.tabs.getMruTabInstances"), t15);
}
function m14() {
  return !(!m7(g3) || !g3.supports.pages) && !!g3.supports.pages.tabs;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/pages/pages.js
var A7;
var T9;
function w10(e21) {
  const t15 = s6(h10, "pages.returnFocus");
  if (m7(g3), !z4()) throw l;
  if (void 0 === e21 && $2(t15, "returnFocus", [false]), "boolean" == typeof e21) $2(t15, "returnFocus", [e21]);
  else switch (e21) {
    case T9.PreviousLandmark:
    case T9.GoToActivityFeed:
      $2(t15, "returnFocus", [false, e21]);
      break;
    case T9.NextLandmark:
      $2(t15, "returnFocus", [true, e21]);
  }
}
function N8(e21) {
  U5(s6(h10, "pages.registerFocusEnterHandler"), "focusEnter", e21, [], () => {
    if (!z4()) throw l;
  });
}
function b7(e21) {
  B3(s6(h10, "pages.setCurrentFrame"), e21);
}
function H6(r18, t15, n19) {
  f6(), k3(s6(h10, "pages.initializeWithFrameContext"), n19).then(() => t15 && t15()), b7(r18);
}
function S7() {
  return C7(s6(h10, "pages.getConfig."));
}
function D5(e21) {
  return P7(s6(h10, "pages.navigateCrossDomain"), e21);
}
function G3(e21) {
  return new Promise((r18) => {
    if (m7(g3, a2.content, a2.sidePanel, a2.settings, a2.task, a2.stage, a2.meetingStage), !z4()) throw l;
    const n19 = s6(h10, "pages.navigateToApp");
    if (g3.isLegacyTeams) {
      const o24 = O9(e21) ? e21 : x4(e21);
      r18(R3(n19, "executeDeepLink", d3(o24)));
    } else {
      const o24 = O9(e21) ? y7(e21) : e21;
      r18(R3(n19, "pages.navigateToApp", o24));
    }
  });
}
function E7(e21) {
  return U6(s6(h10, "pages.shareDeepLink"), e21);
}
function R6(e21) {
  U5(s6(h10, "pages.registerFullScreenHandler"), "fullScreenChange", e21, [], () => {
    if (!n13(e21) && !z4()) throw l;
  });
}
function z4() {
  return !(!m7(g3) || !g3.supports.pages);
}
!function(e21) {
  e21[e21.PreviousLandmark = 0] = "PreviousLandmark", e21[e21.NextLandmark = 1] = "NextLandmark", e21[e21.Read = 2] = "Read", e21[e21.Compose = 3] = "Compose";
}(A7 || (A7 = {})), function(e21) {
  e21[e21.PreviousLandmark = 0] = "PreviousLandmark", e21[e21.NextLandmark = 1] = "NextLandmark", e21[e21.GoToActivityFeed = 2] = "GoToActivityFeed";
}(T9 || (T9 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/pagesHelpers.js
var h10 = "v2";
function P7(t15, o24) {
  return new Promise((s38) => {
    if (m7(g3, a2.content, a2.sidePanel, a2.settings, a2.remove, a2.task, a2.stage, a2.meetingStage), !z4()) throw l;
    s38(C4(t15, "navigateCrossDomain", "Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.", o24));
  });
}
function j9(t15) {
  return new Promise((e21) => {
    if (m7(g3), !k6()) throw l;
    e21(C4(t15, "navigateBack", "Back navigation is not supported in the current client or context."));
  });
}
function v9(t15, e21) {
  return new Promise((i26) => {
    if (m7(g3), !m14()) throw l;
    i26(C4(t15, "navigateToTab", "Invalid internalTabInstanceId and/or channelId were/was provided", e21));
  });
}
function I5(t15, e21) {
  if (m7(g3), !z4()) throw l;
  $2(t15, "returnFocus", [e21]);
}
function S6(t15, e21) {
  return new Promise((i26) => {
    if (m7(g3), !m14()) throw l;
    i26(O5(t15, "getTabInstances", e21));
  });
}
function k7(t15, e21) {
  return new Promise((i26) => {
    if (m7(g3), !m14()) throw l;
    i26(O5(t15, "getMruTabInstances", e21));
  });
}
function U6(t15, o24) {
  if (m7(g3, a2.content, a2.sidePanel, a2.meetingStage), !z4()) throw l;
  $2(t15, "shareDeepLink", [o24.subPageId, o24.subPageLabel, o24.subPageWebUrl]);
}
function B3(t15, o24) {
  if (m7(g3, a2.content), !z4()) throw l;
  $2(t15, "setFrameContext", [o24]);
}
function T6(t15, i26) {
  if (m7(g3, a2.settings, a2.remove), !O8()) throw l;
  $2(t15, "settings.setValidityState", [i26]);
}
function C7(t15) {
  return new Promise((o24) => {
    if (m7(g3, a2.content, a2.settings, a2.remove, a2.sidePanel), !z4()) throw l;
    o24(O5(t15, "settings.getSettings"));
  });
}
function L5(t15, i26) {
  return new Promise((o24) => {
    if (m7(g3, a2.content, a2.settings, a2.sidePanel), !O8()) throw l;
    o24(R3(t15, "settings.setSettings", i26));
  });
}
function O9(e21) {
  return e21.appId instanceof i10;
}
function x4(e21) {
  return Object.assign(Object.assign({}, e21), { appId: new i10(e21.appId), webUrl: e21.webUrl ? new URL(e21.webUrl) : void 0 });
}
function y7(t15) {
  return Object.assign(Object.assign({}, t15), { appId: t15.appId.toString(), webUrl: t15.webUrl ? t15.webUrl.toString() : void 0 });
}
var D6;
function F7(t15) {
  D6 = t15;
}
function R5() {
  p10(s6("v2", "pages.backStack.registerBackButtonPressHandler"), "backButtonPress", A8, false);
}
function A8() {
  D6 && D6() || (m11() ? v7("backButtonPress", []) : f13());
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/handlers.js
var u20 = u5("handlers");
var m15 = class _m {
  static initializeHandlers() {
    _m.handlers.themeChange = C8, _m.handlers.load = O10, _m.handlers.beforeUnload = _5, R5();
  }
  static uninitializeHandlers() {
    _m.handlers = {}, _m.themeChangeHandler = null, _m.loadHandler = null, _m.beforeUnloadHandler = null, _m.beforeSuspendOrTerminateHandler = null, _m.resumeHandler = null;
  }
};
function f12() {
  m15.initializeHandlers();
}
function c9() {
  m15.uninitializeHandlers();
}
m15.handlers = {}, m15.themeChangeHandler = null, m15.loadHandler = null, m15.beforeUnloadHandler = null, m15.beforeSuspendOrTerminateHandler = null, m15.resumeHandler = null, m15.hostToAppPerformanceMetricsHandler = null;
var H7 = u20.extend("callHandler");
function h6(e21, n19) {
  const r18 = m15.handlers[e21];
  if (r18) {
    H7("Invoking the registered handler for message %s with arguments %o", e21, n19);
    return [true, r18.apply(this, n19)];
  }
  return m11() ? (v7(e21, n19), [false, void 0]) : (H7("Handler for action message %s not found.", e21), [false, void 0]);
}
function p10(e21, n19, r18, l43 = true, a35 = []) {
  r18 ? (m15.handlers[n19] = r18, l43 && $2(e21, "registerHandler", [n19, ...a35])) : delete m15.handlers[n19];
}
function g6(e21) {
  delete m15.handlers[e21];
}
function b8(e21) {
  return null != m15.handlers[e21];
}
function U5(e21, n19, r18, a35, o24) {
  r18 && m7(g3, ...a35), o24 && o24(), p10(e21, n19, r18);
}
function T8(e21, n19) {
  m15.themeChangeHandler = n19, !n13(n19) && $2(e21, "registerHandler", ["themeChange"]);
}
function C8(e21) {
  m15.themeChangeHandler && m15.themeChangeHandler(e21), m11() && v7("themeChange", [e21]);
}
function v5(e21) {
  m15.hostToAppPerformanceMetricsHandler = e21;
}
function y5(e21) {
  m15.hostToAppPerformanceMetricsHandler && m15.hostToAppPerformanceMetricsHandler(e21);
}
function j10(e21, n19) {
  m15.loadHandler = n19, !n13(n19) && $2(e21, "registerHandler", ["load"]);
}
function O10(e21) {
  const n19 = { entityId: (r18 = e21).entityId, contentUrl: new URL(r18.contentUrl) };
  var r18;
  m15.resumeHandler ? (m15.resumeHandler(n19), m11() && v7("load", [n19])) : m15.loadHandler && (m15.loadHandler(e21), m11() && v7("load", [e21]));
}
function S8(e21, n19) {
  m15.beforeUnloadHandler = n19, !n13(n19) && $2(e21, "registerHandler", ["beforeUnload"]);
}
function _5() {
  return n(this, void 0, void 0, function* () {
    const e21 = () => {
      $2(s6("v2", "handleBeforeUnload"), "readyToUnload", []);
    };
    m15.beforeSuspendOrTerminateHandler ? (yield m15.beforeSuspendOrTerminateHandler(), m11() ? v7("beforeUnload") : e21()) : m15.beforeUnloadHandler && m15.beforeUnloadHandler(e21) || (m11() ? v7("beforeUnload") : e21());
  });
}
function A4(e21) {
  m15.beforeSuspendOrTerminateHandler = e21, !n13(e21) && $2(s6("v2", "registerBeforeSuspendOrTerminateHandler"), "registerHandler", ["beforeUnload"]);
}
function P4(e21) {
  m15.resumeHandler = e21, !n13(e21) && $2(s6("v2", "registerOnResumeHandler"), "registerHandler", ["load"]);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/childCommunication.js
var c12 = u5("childProxyingCommunication");
var l15 = class {
};
function g5() {
  l15.window = null, l15.origin = null, l15.messageQueue = [];
}
function m11() {
  return !!o() && !!l15.window;
}
function f7(n19, o24) {
  return !!o() && (l15.window && !l15.window.closed && n19 !== l15.window || (l15.window = n19, l15.origin = o24), l15.window && l15.window.closed ? (l15.window = null, l15.origin = null, false) : l15.window === n19);
}
function w4(i26, d39, a35, c43) {
  return n(this, void 0, void 0, function* () {
    l15.window === d39 && (u6(l15.window, l15.origin, l15.messageQueue, "child"), function(n19, i27, s38) {
      if (void 0 === n19.data.id || void 0 === n19.data.func) return;
      const d40 = s4(n19.data), [a36, c44] = h6(d40.func, d40.args);
      if (a36 && void 0 !== c44) return p20("Handler called in response to message %s from child. Returning response from handler to child, action: %s.", i7(d40), d40.func), void h12(d40.id, d40.uuid, Array.isArray(c44) ? c44 : [c44]);
      p20("No handler for message %s from child found; relaying message on to parent, action: %s. Relayed message will have a new id.", i7(d40), d40.func), function(n20, i28, s39) {
        const r18 = i28(s6("v2", "tasks.startTask"), n20.func, n20.args, true, n20.teamsJsInstanceId), t15 = l15.origin;
        s39(r18.uuid, (...i29) => {
          if (!l15.window) return;
          if (!c().disableEnforceOriginMatchForChildResponses && t15 !== l15.origin) return void p20("Origin of child window has changed, not sending response back to child window");
          const s40 = i29.pop();
          p20("Message from parent being relayed to child, id: %s", i7(n20)), h12(n20.id, n20.uuid, i29, s40);
        });
      }(d40, i27, s38);
    }(i26, a35, c43));
  });
}
l15.messageQueue = [];
var p20 = c12.extend("handleIncomingMessageFromChild");
function h12(n19, i26, o24, s38) {
  const r18 = l15.window, t15 = /* @__PURE__ */ function(n20, i27, o25, s39) {
    return { id: n20, uuid: i27, args: o25 || [], isPartialResponse: s39 };
  }(n19, i26, o24, s38), a35 = r5(t15), u52 = l15.origin;
  r18 && u52 && (p20("Sending message %s to %s via postMessage, args = %o", i7(a35), "child", a35.args), r18.postMessage(a35, u52));
}
function v7(n19, i26) {
  const o24 = l15.window, s38 = /* @__PURE__ */ function(n20, i27) {
    return { func: n20, args: i27 || [] };
  }(n19, i26), e21 = l15.origin;
  o24 && e21 ? o24.postMessage(s38, e21) : l15.messageQueue.push(s38);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/privateAPIs.js
var a13 = "v1";
function p21(e21, t15) {
  m7(g3), $2(s6(a13, "uploadCustomApp"), "uploadCustomApp", [e21], t15 || i6());
}
function c13(e21, t15, i26) {
  m7(g3), $2(s6(a13, "sendCustomMessage"), e21, t15, i26);
}
function u21(n19, i26) {
  if (m7(g3), !m11()) throw new Error("The child window has not yet been initialized or is not present");
  v7(n19, i26);
}
function d13(e21, t15) {
  m7(g3), p10(s6(a13, "registerCustomHandler"), e21, (...e22) => t15.apply(this, e22));
}
function f14(e21, t15) {
  m7(g3), p10(s6(a13, "registerUserSettingsChangeHandler"), "userSettingsChange", t15, true, [e21]);
}
function w11(e21) {
  m7(g3, a2.content, a2.task);
  const t15 = [e21.entityId, e21.title, e21.description, e21.type, e21.objectUrl, e21.downloadUrl, e21.webPreviewUrl, e21.webEditUrl, e21.baseUrl, e21.editFile, e21.subEntityId, e21.viewerAction, e21.fileOpenPreference, e21.conversationId, e21.sizeInBytes];
  $2(s6(a13, "openFilePreview"), "openFilePreview", t15);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/logs.js
var logs_exports = {};
__export(logs_exports, {
  isSupported: () => p22,
  registerGetLogHandler: () => l16
});
function l16(l43) {
  if (!n13(l43) && m7(g3), !n13(l43) && !p22()) throw l;
  l43 ? p10(s6("v1", "log.request"), "log.request", () => {
    const t15 = l43();
    $2(s6("v1", "log.receive"), "log.receive", [t15]);
  }) : g6("log.request");
}
function p22() {
  return !(!m7(g3) || !g3.supports.logs);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/conversations.js
var conversations_exports = {};
__export(conversations_exports, {
  closeConversation: () => m16,
  getChatMembers: () => u22,
  isSupported: () => C9,
  openConversation: () => d14
});
var l17 = "v1";
function d14(o24) {
  return new Promise((t15) => {
    if (m7(g3, a2.content), !C9()) throw l;
    const r18 = R3(s6(l17, "conversations.openConversation"), "conversations.openConversation", { title: o24.title, subEntityId: o24.subEntityId, conversationId: o24.conversationId, channelId: o24.channelId, entityId: o24.entityId });
    o24.onStartConversation && p10(s6(l17, "conversations.registerStartConversationHandler"), "startConversation", (n19, t16, e21, r19) => {
      var i26;
      return null === (i26 = o24.onStartConversation) || void 0 === i26 ? void 0 : i26.call(o24, { subEntityId: n19, conversationId: t16, channelId: e21, entityId: r19 });
    }), o24.onCloseConversation && p10(s6(l17, "conversations.registerCloseConversationHandler"), "closeConversation", (n19, t16, e21, r19) => {
      var i26;
      return null === (i26 = o24.onCloseConversation) || void 0 === i26 ? void 0 : i26.call(o24, { subEntityId: n19, conversationId: t16, channelId: e21, entityId: r19 });
    }), t15(r18);
  });
}
function m16() {
  if (m7(g3, a2.content), !C9()) throw l;
  $2(s6(l17, "conversations.closeConversation"), "conversations.closeConversation"), g6("startConversation"), g6("closeConversation");
}
function u22() {
  return new Promise((n19) => {
    if (m7(g3), !C9()) throw l;
    n19(O5(s6(l17, "conversations.getChatMember"), "getChatMembers"));
  });
}
function C9() {
  return !(!m7(g3) || !g3.supports.conversations);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/copilot/copilot.js
var copilot_exports = {};
__export(copilot_exports, {
  customTelemetry: () => customTelemetry_exports,
  eligibility: () => eligibility_exports,
  sidePanel: () => sidePanel_exports,
  view: () => view_exports
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/copilot/customTelemetry.js
var customTelemetry_exports = {};
__export(customTelemetry_exports, {
  isSupported: () => l18,
  sendCustomTelemetryData: () => p23
});
var s12 = u5("copilot");
function l18() {
  var t15;
  return m7(g3) && !!(null === (t15 = g3.supports.copilot) || void 0 === t15 ? void 0 : t15.customTelemetry);
}
function p23(r18, l43) {
  var p56;
  return void 0 === l43 && (l43 = null !== (p56 = N3()) && void 0 !== p56 ? p56 : Date.now()), n(this, void 0, void 0, function* () {
    return m7(g3), s12("Sending custom telemetry data to host for stage: %s to record timestamp: %s", r18, l43), A3("copilot.customTelemetry.sendCustomTelemetryData", [r18.toString(), l43], s6("v2", "copilot.customTelemetry.sendCustomTelemetryData"));
  });
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/copilot/eligibility.js
var eligibility_exports = {};
__export(eligibility_exports, {
  getEligibilityInfo: () => d15,
  isSupported: () => p24
});
var u23 = u5("copilot");
function p24() {
  var i26, o24;
  return m7(g3) && (!!(null === (i26 = g3.hostVersionsInfo) || void 0 === i26 ? void 0 : i26.appEligibilityInformation) || !!(null === (o24 = g3.supports.copilot) || void 0 === o24 ? void 0 : o24.eligibility));
}
function d15(r18) {
  var d39, m55, f46;
  return n(this, void 0, void 0, function* () {
    if (m7(g3), !p24()) throw new Error(`Error code: ${l.errorCode}, message: Not supported on platform`);
    if ((null === (d39 = g3.hostVersionsInfo) || void 0 === d39 ? void 0 : d39.appEligibilityInformation) && !r18) return u23("Eligibility information is already available on runtime."), g3.hostVersionsInfo.appEligibilityInformation;
    u23("Eligibility information is not available on runtime. Requesting from host.");
    const i26 = yield O5(s6("v2", "copilot.eligibility.getEligibilityInfo"), "copilot.eligibility.getEligibilityInfo", r18);
    if (i4(i26)) throw new Error(`Error code: ${i26.errorCode}, message: ${null !== (m55 = i26.message) && void 0 !== m55 ? m55 : "Failed to get eligibility information from the host."}`);
    if (!function(i27) {
      if (void 0 === i27.ageGroup || void 0 === i27.cohort || void 0 === i27.userClassification || void 0 === i27.isCopilotEligible || void 0 === i27.isCopilotEnabledRegion || void 0 === i27.isOptedOutByAdmin || i27.featureSet && (void 0 === i27.featureSet.serverFeatures || void 0 === i27.featureSet.uxFeatures)) return false;
      return true;
    }(i26)) throw new Error("Error deserializing eligibility information");
    return "nonadult" === (null === (f46 = i26.ageGroup) || void 0 === f46 ? void 0 : f46.toLowerCase()) && (i26.ageGroup = T2.NotAdult), i26;
  });
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/copilot/sidePanel.js
var sidePanel_exports = {};
__export(sidePanel_exports, {
  copilotSidePanelNotSupportedOnPlatformError: () => P8,
  getContent: () => f15,
  isResponseAReportableError: () => m17,
  isSupported: () => d17,
  preCheckUserConsent: () => j11,
  registerUserActionContentSelect: () => v10
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/copilot/sidePanelInterfaces.js
var sidePanelInterfaces_exports = {};
__export(sidePanelInterfaces_exports, {
  ContentItemType: () => e16,
  CopilotMode: () => o14,
  MediaSelectionType: () => t10,
  SidePanelErrorCode: () => p25,
  SidePanelErrorImpl: () => d16,
  TeamsContextType: () => c14,
  TeamsDimensionName: () => a14,
  TeamsSessionType: () => n15,
  TranscriptState: () => i16,
  UserConsent: () => r12
});
var e16;
var t10;
var n15;
var a14;
var o14;
var i16;
var c14;
var r12;
var p25;
!function(e21) {
  e21.EMAIL = "email", e21.TEXT = "text", e21.MEDIA = "media", e21.CALENDAR_INVITE = "calendarInvite", e21.WEB_PAGE = "webPage", e21.MIXED = "mixed", e21.TEAMS = "teams", e21.FILE = "file";
}(e16 || (e16 = {})), function(e21) {
  e21.IMAGE = "image", e21.AUDIO = "audio", e21.VIDEO = "video";
}(t10 || (t10 = {})), function(e21) {
  e21.Private = "Private", e21.Shared = "Shared", e21.Recap = "Recap", e21.RecapCall = "RecapCall", e21.PrivateViewCall = "PrivateViewCall", e21.Chat = "Chat", e21.Compose = "Compose";
}(n15 || (n15 = {})), function(e21) {
  e21.ClientDeviceType = "ClientDeviceType", e21.ClientRing = "ClientRing", e21.ClientScenarioName = "ClientScenarioName";
}(a14 || (a14 = {})), function(e21) {
  e21.Enabled = "enabled", e21.Disabled = "disabled", e21.EnabledWithTranscript = "enabledWithTranscript";
}(o14 || (o14 = {})), function(e21) {
  e21.NotStarted = "notStarted", e21.Active = "active", e21.Inactive = "inactive", e21.UnknownFutureValue = "unknownFutureValue";
}(i16 || (i16 = {})), function(e21) {
  e21.Chat = "Chat", e21.Channel = "Channel", e21.Meeting = "Meeting", e21.MeetingChat = "MeetingChat";
}(c14 || (c14 = {})), function(e21) {
  e21.Accepted = "accepted", e21.NotAccepted = "not_accepted";
}(r12 || (r12 = {})), function(e21) {
  e21.ConsentNotAccepted = "consent_not_accepted", e21.PageContentBlockedPolicy = "page_content_blocked_policy", e21.PageContentBlockedDlp = "page_content_blocked_dlp", e21.PageContentTypeNotSupportedYet = "page_content_type_not_supported_yet", e21.PageContentSizeNotSupported = "page_content_size_not_supported", e21.PageContextChanged = "page_context_changed", e21.PageContentExtractionFailed = "page_content_extraction_failed", e21.PageContentSizeNotSupportedPDF = "page_content_size_not_supported_pdf", e21.NotSupportedOnPlatform = "not_supported_on_platform", e21.OtherError = "other_error";
}(p25 || (p25 = {}));
var d16 = class extends Error {
  constructor(e21, t15) {
    super(t15), this.errorCode = e21, this.name = "SidePanelError";
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/copilot/sidePanel.js
var a15 = "v2";
function d17() {
  var e21;
  return m7(g3) && !!(null === (e21 = g3.supports.copilot) || void 0 === e21 ? void 0 : e21.sidePanel);
}
function m17(e21) {
  if ("object" != typeof e21 || null === e21) return false;
  const t15 = e21;
  return Object.values(p25).includes(t15.errorCode) && (void 0 === t15.message || "string" == typeof t15.message) || i4(e21);
}
function f15(n19) {
  return n(this, void 0, void 0, function* () {
    m7(g3);
    const e21 = n19 ? [new C10(n19)] : [];
    return N4("copilot.sidePanel.getContent", e21, new b9(), s6(a15, "copilot.sidePanel.getContent"), m17);
  });
}
function j11() {
  return n(this, void 0, void 0, function* () {
    return m7(g3), N4("copilot.sidePanel.preCheckUserConsent", [], new h13(), s6(a15, "copilot.sidePanel.preCheckUserConsent"), m17);
  });
}
function v10(e21) {
  U5(s6(a15, "copilot.sidePanel.registerUserActionContentSelect"), "copilot.sidePanel.userActionContentSelect", e21, [a2.content], () => {
    if (!d17()) throw P8;
  });
}
var P8 = new d16(p25.NotSupportedOnPlatform, "This API is not supported on the current platform.");
var b9 = class extends e15 {
  validate(e21) {
    return null !== e21 && "object" == typeof e21;
  }
  deserialize(e21) {
    return e21;
  }
};
var h13 = class extends e15 {
  validate(e21) {
    return null !== e21 && "object" == typeof e21;
  }
  deserialize(e21) {
    return e21;
  }
};
var C10 = class {
  constructor(e21) {
    this.contentRequest = e21;
  }
  serialize() {
    return this.contentRequest;
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/copilot/view.js
var view_exports = {};
__export(view_exports, {
  closeSidePanel: () => s13,
  isSupported: () => l19
});
function l19() {
  var e21;
  return m7(g3) && !!(null === (e21 = g3.supports.copilot) || void 0 === e21 ? void 0 : e21.view);
}
function s13() {
  return n(this, void 0, void 0, function* () {
    m7(g3), yield N4("copilot.view.closeSidePanel", [], new p26(), s6("v2", "copilot.view.closeSidePanel"));
  });
}
var p26 = class extends e15 {
  validate(e21) {
    return true;
  }
  deserialize(e21) {
    return e21;
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/externalAppAuthentication.js
var externalAppAuthentication_exports = {};
__export(externalAppAuthentication_exports, {
  ActionExecuteInvokeRequestType: () => m18,
  ActionExecuteResponseHandler: () => x5,
  InvokeErrorCode: () => A9,
  InvokeResponseType: () => R7,
  OriginalRequestType: () => d18,
  SerializableActionExecuteInvokeRequest: () => p27,
  authenticateAndResendRequest: () => g9,
  authenticateWithOauth2: () => q3,
  authenticateWithPowerPlatformConnectorPlugins: () => S9,
  authenticateWithSSO: () => I6,
  authenticateWithSSOAndResendRequest: () => y8,
  isActionExecuteResponse: () => f16,
  isInvokeError: () => w12,
  isSupported: () => j12,
  validateActionExecuteInvokeRequest: () => v11
});
var l20 = "v2";
var p27 = class {
  constructor(e21) {
    this.invokeRequest = e21;
  }
  serialize() {
    return this.invokeRequest;
  }
};
function f16(e21) {
  const t15 = e21;
  return t15.responseType === R7.ActionExecuteInvokeResponse && void 0 !== t15.value && void 0 !== t15.statusCode && void 0 !== t15.type;
}
var m18 = "Action.Execute";
var d18;
var R7;
var A9;
!function(e21) {
  e21.ActionExecuteInvokeRequest = "ActionExecuteInvokeRequest", e21.QueryMessageExtensionRequest = "QueryMessageExtensionRequest";
}(d18 || (d18 = {})), function(e21) {
  e21.ActionExecuteInvokeResponse = "ActionExecuteInvokeResponse", e21.QueryMessageExtensionResponse = "QueryMessageExtensionResponse";
}(R7 || (R7 = {}));
var x5 = class extends e15 {
  validate(e21) {
    return f16(e21);
  }
  deserialize(e21) {
    return e21;
  }
};
function w12(e21) {
  if ("object" != typeof e21 || null === e21) return false;
  const t15 = e21;
  return Object.values(A9).includes(t15.errorCode) && (void 0 === t15.message || "string" == typeof t15.message);
}
function E8(e21) {
  e21.requestType === d18.ActionExecuteInvokeRequest ? v11(e21) : e21.requestType === d18.QueryMessageExtensionRequest && function(e22) {
    if (e22.commandId.length > 64) throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");
    if (e22.parameters.length > 5) throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");
    for (const t15 of e22.parameters) {
      if (t15.name.length > 64) throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");
      if (t15.value.length > 512) throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters");
    }
  }(e21);
}
function v11(e21) {
  if (e21.type !== m18) {
    throw { errorCode: A9.INTERNAL_ERROR, message: `Invalid action type ${e21.type}. Action type must be "${m18}"` };
  }
  if (!S2(e21.data)) {
    throw { errorCode: A9.INTERNAL_ERROR, message: `Invalid data type ${typeof e21.data}. Data must be a primitive or a plain object.` };
  }
}
function g9(n19, r18, o24) {
  if (m7(g3, a2.content), !j12()) throw l;
  const s38 = new i10(n19);
  return E8(o24), S3(s6(l20, "externalAppAuthentication.authenticateAndResendRequest"), "externalAppAuthentication.authenticateAndResendRequest", [s38.toString(), o24, r18.url.href, r18.width, r18.height, r18.isExternal]).then(([e21, t15]) => {
    if (e21 && null != t15.responseType) return t15;
    throw t15;
  });
}
function I6(n19, r18) {
  if (m7(g3, a2.content), !j12()) throw l;
  const o24 = new i10(n19);
  return S3(s6(l20, "externalAppAuthentication.authenticateWithSSO"), "externalAppAuthentication.authenticateWithSSO", [o24.toString(), r18.claims, r18.silent]).then(([e21, t15]) => {
    if (!e21) throw t15;
  });
}
function y8(n19, r18, o24) {
  if (m7(g3, a2.content), !j12()) throw l;
  const s38 = new i10(n19);
  return E8(o24), S3(s6(l20, "externalAppAuthentication.authenticateWithSSOAndResendRequest"), "externalAppAuthentication.authenticateWithSSOAndResendRequest", [s38.toString(), o24, r18.claims, r18.silent]).then(([e21, t15]) => {
    if (e21 && null != t15.responseType) return t15;
    throw t15;
  });
}
function q3(n19, r18, s38) {
  if (m7(g3, a2.content), !j12()) throw l;
  return j2(n19, new Error("titleId is Invalid.")), j2(r18, new Error("oauthConfigId is Invalid.")), S3(s6(l20, "externalAppAuthentication.authenticateWithOauth2"), "externalAppAuthentication.authenticateWithOauth2", [n19, r18, s38.width, s38.height, s38.isExternal]).then(([e21, t15]) => {
    if (!e21) throw t15;
  });
}
function S9(n19, r18, h29) {
  if (m7(g3, a2.content), !j12()) throw l;
  return j2(n19, new Error("titleId is Invalid.")), r18 && I2(r18), S3(s6(l20, "externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins"), "externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins", [n19, null == r18 ? void 0 : r18.toString(), null == h29 ? void 0 : h29.width, null == h29 ? void 0 : h29.height, null == h29 ? void 0 : h29.isExternal]).then(([e21, t15]) => {
    if (!e21) throw t15;
  });
}
function j12() {
  return !(!m7(g3) || !g3.supports.externalAppAuthentication);
}
!function(e21) {
  e21.INTERNAL_ERROR = "INTERNAL_ERROR";
}(A9 || (A9 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/externalAppAuthenticationForCEA.js
var externalAppAuthenticationForCEA_exports = {};
__export(externalAppAuthenticationForCEA_exports, {
  authenticateAndResendRequest: () => x6,
  authenticateWithOauth: () => f17,
  authenticateWithSSO: () => d19,
  authenticateWithSSOAndResendRequest: () => E9,
  isSupported: () => v12,
  validateInput: () => w13
});
var m19 = "v2";
function d19(e21, i26, a35) {
  return n(this, void 0, void 0, function* () {
    if (m7(g3, a2.content), !v12()) throw l;
    return w13(e21, i26), A3("externalAppAuthenticationForCEA.authenticateWithSSO", [e21, i26, a35.authId, a35.connectionName, a35.claims, a35.silent], s6(m19, "externalAppAuthenticationForCEA.authenticateWithSSO"), w12);
  });
}
function f17(e21, i26, a35) {
  return n(this, void 0, void 0, function* () {
    if (m7(g3, a2.content), !v12()) throw l;
    return w13(e21, i26), A3("externalAppAuthenticationForCEA.authenticateWithOauth", [e21, i26, a35.url.href, a35.width, a35.height, a35.isExternal], s6(m19, "externalAppAuthenticationForCEA.authenticateWithOauth"), w12);
  });
}
function x6(n19, i26, a35, d39) {
  return n(this, void 0, void 0, function* () {
    if (m7(g3, a2.content), !v12()) throw l;
    return w13(n19, i26), v11(d39), N4("externalAppAuthenticationForCEA.authenticateAndResendRequest", [n19, i26, new p27(d39), a35.url.href, a35.width, a35.height, a35.isExternal], new x5(), s6(m19, "externalAppAuthenticationForCEA.authenticateAndResendRequest"), w12);
  });
}
function E9(n19, i26, a35, d39) {
  return n(this, void 0, void 0, function* () {
    if (m7(g3, a2.content), !v12()) throw l;
    return w13(n19, i26), v11(d39), N4("externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest", [n19, i26, new p27(d39), a35.authId, a35.connectionName, a35.claims, a35.silent], new x5(), s6(m19, "externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest"), w12);
  });
}
function v12() {
  return !(!m7(g3) || !g3.supports.externalAppAuthenticationForCEA);
}
function w13(t15, n19) {
  j2(n19, new Error("conversation id is not valid.")), l5(t15);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/externalAppCardActions.js
var externalAppCardActions_exports = {};
__export(externalAppCardActions_exports, {
  ActionOpenUrlErrorCode: () => s14,
  ActionOpenUrlType: () => c15,
  isSupported: () => A10,
  processActionOpenUrl: () => l21,
  processActionSubmit: () => a16
});
var c15;
var s14;
function a16(c43, s38) {
  if (m7(g3, a2.content), !A10()) throw l;
  const a35 = new i10(c43);
  return S3(s6("v2", "externalAppCardActions.processActionSubmit"), "externalAppCardActions.processActionSubmit", [a35.toString(), s38]).then(([n19, t15]) => {
    if (!n19) throw t15;
  });
}
function l21(c43, s38, a35) {
  if (m7(g3, a2.content), !A10()) throw l;
  const l43 = new i10(c43);
  return S3(s6("v2", "externalAppCardActions.processActionOpenUrl"), "externalAppCardActions.processActionOpenUrl", [l43.toString(), s38.href, a35]).then(([n19, t15]) => {
    if (n19) throw n19;
    return t15;
  });
}
function A10() {
  return !(!m7(g3) || !g3.supports.externalAppCardActions);
}
!function(n19) {
  n19.DeepLinkDialog = "DeepLinkDialog", n19.DeepLinkOther = "DeepLinkOther", n19.DeepLinkStageView = "DeepLinkStageView", n19.GenericUrl = "GenericUrl";
}(c15 || (c15 = {})), function(n19) {
  n19.INTERNAL_ERROR = "INTERNAL_ERROR", n19.INVALID_LINK = "INVALID_LINK", n19.NOT_SUPPORTED = "NOT_SUPPORTED";
}(s14 || (s14 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/externalAppCardActionsForCEA.js
var externalAppCardActionsForCEA_exports = {};
__export(externalAppCardActionsForCEA_exports, {
  isSupported: () => A11,
  processActionOpenUrl: () => l22,
  processActionSubmit: () => m20
});
function l22(r18, l43, m55) {
  return n(this, void 0, void 0, function* () {
    if (m7(g3, a2.content), !A11()) throw l;
    w13(r18, l43);
    const [t15, u52] = yield S3(s6("v2", "externalAppCardActionsForCEA.processActionOpenUrl"), "externalAppCardActionsForCEA.processActionOpenUrl", [r18.toString(), l43, m55.href]);
    if (t15) throw t15;
    return u52;
  });
}
function m20(o24, l43, m55) {
  return n(this, void 0, void 0, function* () {
    if (m7(g3, a2.content), !A11()) throw l;
    w13(o24, l43);
    const t15 = yield O5(s6("v2", "externalAppCardActionsForCEA.processActionSubmit"), "externalAppCardActionsForCEA.processActionSubmit", o24.toString(), l43, m55);
    if (t15) throw t15;
  });
}
function A11() {
  return !(!m7(g3) || !g3.supports.externalAppCardActionsForCEA);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/externalAppCardActionsForDA.js
var externalAppCardActionsForDA_exports = {};
__export(externalAppCardActionsForDA_exports, {
  SerializableActionOpenUrlDialogInfo: () => a17,
  isSupported: () => u24,
  processActionOpenUrlDialog: () => m21
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/constants.js
var R8;
!function(R12) {
  R12.INTERNAL_ERROR = "INTERNAL_ERROR";
}(R8 || (R8 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/externalAppErrorHandling.js
function t11(t15) {
  if ("object" != typeof t15 || null === t15) return false;
  const o24 = t15;
  return Object.values(R8).includes(o24.errorCode) && (void 0 === o24.message || "string" == typeof o24.message);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/externalAppCardActionsForDA.js
function m21(m55, f46, d39) {
  return n(this, void 0, void 0, function* () {
    if (m7(g3, a2.content), !u24()) throw l;
    return function(r18, t15) {
      l5(r18), r4(t15);
    }(m55, d39), A3("externalAppCardActionsForDA.processActionOpenUrlDialog", [m55, new a17(f46), d39], s6("v2", "externalAppCardActionsForDA.processActionOpenUrlDialog"), t11);
  });
}
function u24() {
  return !(!m7(g3) || !g3.supports.externalAppCardActionsForDA);
}
var a17 = class {
  constructor(r18) {
    this.info = r18;
  }
  serialize() {
    const { url: r18, title: t15, size: i26 } = this.info;
    return { url: r18.href, title: t15, size: i26 };
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/externalAppCommands.js
var externalAppCommands_exports = {};
__export(externalAppCommands_exports, {
  isSupported: () => l23,
  processActionCommand: () => s15
});
function s15(s38, c43, u52) {
  return n(this, void 0, void 0, function* () {
    if (m7(g3, a2.content), !l23()) throw l;
    const t15 = new i10(s38), [a35, d39] = yield S3(s6("v2", "externalAppCommands.processActionCommand"), "externalAppCommands.processActionCommand", [t15.toString(), c43, u52]);
    if (a35) throw a35;
    return d39;
  });
}
function l23() {
  return !(!m7(g3) || !g3.supports.externalAppCommands);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/files.js
var files_exports = {};
__export(files_exports, {
  CloudStorageProvider: () => a18,
  CloudStorageProviderFileAction: () => g10,
  CloudStorageProviderType: () => s16,
  DocumentLibraryAccessType: () => f18,
  FileDownloadStatus: () => u25,
  SpecialDocumentLibraryType: () => c16,
  addCloudStorageFolder: () => C11,
  addCloudStorageProvider: () => E10,
  addCloudStorageProviderFile: () => D7,
  copyMoveFiles: () => p28,
  deleteCloudStorageFolder: () => w14,
  deleteCloudStorageProviderFile: () => A12,
  downloadCloudStorageProviderFile: () => N9,
  getCloudStorageFolderContents: () => v13,
  getCloudStorageFolders: () => S10,
  getExternalProviders: () => h14,
  getFileDownloads: () => m22,
  openCloudStorageFile: () => F8,
  openDownloadFolder: () => b10,
  registerCloudStorageProviderContentChangeHandler: () => M4,
  registerCloudStorageProviderListChangeHandler: () => L6,
  removeCloudStorageProvider: () => P9,
  renameCloudStorageProviderFile: () => I7,
  uploadCloudStorageProviderFile: () => y9
});
var d20 = "v1";
var a18;
var s16;
var c16;
var f18;
var u25;
var g10;
function S10(o24, n19) {
  if (m7(g3, a2.content), !o24 || 0 === o24.length) throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");
  if (!n19) throw new Error("[files.getCloudStorageFolders] Callback cannot be null");
  $2(s6(d20, "files.getCloudStorageFolders"), "files.getCloudStorageFolders", [o24], n19);
}
function C11(o24, n19) {
  if (m7(g3, a2.content), !o24 || 0 === o24.length) throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");
  if (!n19) throw new Error("[files.addCloudStorageFolder] Callback cannot be null");
  $2(s6(d20, "files.addCloudStorageFolder"), "files.addCloudStorageFolder", [o24], n19);
}
function w14(o24, n19, a35) {
  if (m7(g3, a2.content), !o24) throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");
  if (!n19) throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");
  if (!a35) throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");
  $2(s6(d20, "files.deleteCloudStorageFolder"), "files.deleteCloudStorageFolder", [o24, n19], a35);
}
function v13(o24, n19, a35) {
  if (m7(g3, a2.content), !o24 || !n19) throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");
  if (!a35) throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");
  if ("isSubdirectory" in o24 && !o24.isSubdirectory) throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");
  $2(s6(d20, "files.getCloudStorageFolderContents"), "files.getCloudStorageFolderContents", [o24, n19], a35);
}
function F8(o24, n19, a35) {
  if (m7(g3, a2.content), !o24 || !n19) throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");
  if (o24.isSubdirectory) throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");
  $2(s6(d20, "files.openCloudStorageFile"), "files.openCloudStorageFile", [o24, n19, a35]);
}
function h14(o24 = false, n19) {
  if (m7(g3, a2.content), !n19) throw new Error("[files.getExternalProviders] Callback cannot be null");
  $2(s6(d20, "files.getExternalProviders"), "files.getExternalProviders", [o24], n19);
}
function p28(o24, n19, a35, s38, c43 = false, f46) {
  if (m7(g3, a2.content), !o24 || 0 === o24.length) throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");
  if (!n19) throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");
  if (!a35) throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");
  if (!s38) throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");
  if (!f46) throw new Error("[files.copyMoveFiles] callback cannot be null");
  $2(s6(d20, "files.copyMoveFiles"), "files.copyMoveFiles", [o24, n19, a35, s38, c43], f46);
}
function m22(o24) {
  if (m7(g3, a2.content), !o24) throw new Error("[files.getFileDownloads] Callback cannot be null");
  $2(s6(d20, "files.getFileDownloads"), "files.getFileDownloads", [], o24);
}
function b10(o24 = void 0, n19) {
  if (m7(g3, a2.content), !n19) throw new Error("[files.openDownloadFolder] Callback cannot be null");
  $2(s6(d20, "files.openDownloadFolder"), "files.openDownloadFolder", [o24], n19);
}
function E10(o24) {
  if (m7(g3, a2.content), !o24) throw G4(E2.INVALID_ARGUMENTS, "[files.addCloudStorageProvider] callback cannot be null");
  $2(s6(d20, "files.addCloudStorageProvider"), "files.addCloudStorageProvider", [], o24);
}
function P9(o24, a35) {
  if (m7(g3, a2.content), !a35) throw G4(E2.INVALID_ARGUMENTS, "[files.removeCloudStorageProvider] callback cannot be null");
  if (!o24 || !o24.content) throw G4(E2.INVALID_ARGUMENTS, "[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");
  $2(s6(d20, "files.removeCloudStorageProvider"), "files.removeCloudStorageProvider", [o24], a35);
}
function D7(o24, a35) {
  if (m7(g3, a2.content), !a35) throw G4(E2.INVALID_ARGUMENTS, "[files.addCloudStorageProviderFile] callback cannot be null");
  if (!o24 || !o24.content) throw G4(E2.INVALID_ARGUMENTS, "[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");
  $2(s6(d20, "files.addCloudStorageProviderFile"), "files.addCloudStorageProviderFile", [o24], a35);
}
function I7(o24, a35) {
  if (m7(g3, a2.content), !a35) throw G4(E2.INVALID_ARGUMENTS, "[files.renameCloudStorageProviderFile] callback cannot be null");
  if (!o24 || !o24.content) throw G4(E2.INVALID_ARGUMENTS, "[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");
  $2(s6(d20, "files.renameCloudStorageProviderFile"), "files.renameCloudStorageProviderFile", [o24], a35);
}
function A12(o24, a35) {
  if (m7(g3, a2.content), !a35) throw G4(E2.INVALID_ARGUMENTS, "[files.deleteCloudStorageProviderFile] callback cannot be null");
  if (!(o24 && o24.content && o24.content.itemList && o24.content.itemList.length > 0)) throw G4(E2.INVALID_ARGUMENTS, "[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");
  $2(s6(d20, "files.deleteCloudStorageProviderFile"), "files.deleteCloudStorageProviderFile", [o24], a35);
}
function N9(o24, a35) {
  if (m7(g3, a2.content), !a35) throw G4(E2.INVALID_ARGUMENTS, "[files.downloadCloudStorageProviderFile] callback cannot be null");
  if (!(o24 && o24.content && o24.content.itemList && o24.content.itemList.length > 0)) throw G4(E2.INVALID_ARGUMENTS, "[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");
  $2(s6(d20, "files.downloadCloudStorageProviderFile"), "files.downloadCloudStorageProviderFile", [o24], a35);
}
function y9(o24, a35) {
  if (m7(g3, a2.content), !a35) throw G4(E2.INVALID_ARGUMENTS, "[files.uploadCloudStorageProviderFile] callback cannot be null");
  if (!(o24 && o24.content && o24.content.itemList && o24.content.itemList.length > 0)) throw G4(E2.INVALID_ARGUMENTS, "[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");
  if (!o24.content.destinationFolder) throw G4(E2.INVALID_ARGUMENTS, "[files.uploadCloudStorageProviderFile] Invalid destination folder details");
  $2(s6(d20, "files.uploadCloudStorageProviderFile"), "files.uploadCloudStorageProviderFile", [o24], a35);
}
function L6(e21) {
  if (m7(g3), !e21) throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");
  p10(s6(d20, "files.registerCloudStorageProviderListChangeHandler"), "files.cloudStorageProviderListChange", e21);
}
function M4(e21) {
  if (m7(g3), !e21) throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");
  p10(s6(d20, "files.registerCloudStorageProviderContentChangeHandler"), "files.cloudStorageProviderContentChange", e21);
}
function G4(e21, o24) {
  return { errorCode: e21, message: o24 };
}
!function(e21) {
  e21.Dropbox = "DROPBOX", e21.Box = "BOX", e21.Sharefile = "SHAREFILE", e21.GoogleDrive = "GOOGLEDRIVE", e21.Egnyte = "EGNYTE", e21.SharePoint = "SharePoint";
}(a18 || (a18 = {})), function(e21) {
  e21[e21.Sharepoint = 0] = "Sharepoint", e21[e21.WopiIntegration = 1] = "WopiIntegration", e21[e21.Google = 2] = "Google", e21[e21.OneDrive = 3] = "OneDrive", e21[e21.Recent = 4] = "Recent", e21[e21.Aggregate = 5] = "Aggregate", e21[e21.FileSystem = 6] = "FileSystem", e21[e21.Search = 7] = "Search", e21[e21.AllFiles = 8] = "AllFiles", e21[e21.SharedWithMe = 9] = "SharedWithMe";
}(s16 || (s16 = {})), function(e21) {
  e21.ClassMaterials = "classMaterials";
}(c16 || (c16 = {})), function(e21) {
  e21.Readonly = "readonly";
}(f18 || (f18 = {})), function(e21) {
  e21.Downloaded = "Downloaded", e21.Downloading = "Downloading", e21.Failed = "Failed";
}(u25 || (u25 = {})), function(e21) {
  e21.Download = "DOWNLOAD", e21.Upload = "UPLOAD", e21.Delete = "DELETE";
}(g10 || (g10 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/meetingRoom.js
var meetingRoom_exports = {};
__export(meetingRoom_exports, {
  getPairedMeetingRoomInfo: () => a19,
  isSupported: () => l24,
  registerMeetingRoomCapabilitiesUpdateHandler: () => s17,
  registerMeetingRoomStatesUpdateHandler: () => d21,
  sendCommandToPairedMeetingRoom: () => g11
});
var m23 = "v1";
function a19() {
  return new Promise((o24) => {
    if (m7(g3), !l24()) throw l;
    o24(P3(s6(m23, "meetingRoom.getPairedMeetingRoomInfo"), "meetingRoom.getPairedMeetingRoomInfo"));
  });
}
function g11(o24) {
  return new Promise((a35) => {
    if (!o24 || 0 == o24.length) throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");
    if (m7(g3), !l24()) throw l;
    a35(P3(s6(m23, "meetingRoom.sendCommandToPairedMeetingRoom"), "meetingRoom.sendCommandToPairedMeetingRoom", o24));
  });
}
function s17(e21) {
  if (!e21) throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");
  if (m7(g3), !l24()) throw l;
  p10(s6(m23, "meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler"), "meetingRoom.meetingRoomCapabilitiesUpdate", (o24) => {
    m7(g3), e21(o24);
  });
}
function d21(e21) {
  if (!e21) throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");
  if (m7(g3), !l24()) throw l;
  p10(s6(m23, "meetingRoom.registerMeetingRoomStatesUpdateHandler"), "meetingRoom.meetingRoomStatesUpdate", (o24) => {
    m7(g3), e21(o24);
  });
}
function l24() {
  return !(!m7(g3) || !g3.supports.meetingRoom);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/messageChannels/messageChannels.js
var messageChannels_exports = {};
__export(messageChannels_exports, {
  dataLayer: () => dataLayer_exports,
  isSupported: () => s18,
  telemetry: () => telemetry_exports
});
function s18() {
  return !(!m7(g3) || !g3.supports.messageChannels);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/nestedAppAuth/nestedAppAuthBridge.js
var nestedAppAuthBridge_exports = {};
__export(nestedAppAuthBridge_exports, {
  initialize: () => i17,
  version: () => t12
});
var t12 = "1.0.1";
var n16 = { onMessage: function(e21, t15) {
  if (!e21 || !e21.data || "object" != typeof e21.data || null === e21.data) return void a20("Invalid message format, ignoring. Message: %o", e21);
  if (!function(e22, t16) {
    if (t16 === o15) try {
      return "https:" === new URL(t16).protocol;
    } catch (e23) {
      return d22("Invalid message origin URL:", e23), false;
    }
    return false;
  }(e21.source, e21.origin)) return void a20("Message source/origin not allowed, ignoring.");
  const { args: n19 } = e21.data, [, r18] = null != n19 ? n19 : [], i26 = (() => {
    try {
      return JSON.parse(r18);
    } catch (e22) {
      return d22("Failed to parse response message:", e22), null;
    }
  })();
  if (!i26 || "NestedAppAuthResponse" !== i26.messageType) return void a20("Invalid response format, ignoring. Message: %o", e21);
  t15(r18);
} };
var o15 = null;
var r13 = false;
function i17(t15, i26, p56 = false) {
  if (r13 = p56, !t15) throw new Error("Cannot polyfill nestedAppAuthBridge as the current window does not exist");
  if (!i26) throw new Error("Top origin is required to initialize the Nested App Auth Bridge");
  try {
    const e21 = new URL(i26);
    if ("https:" !== e21.protocol) throw new Error(`Invalid top origin: ${i26}. Only HTTPS origins are allowed.`);
    o15 = e21.origin;
  } catch (e21) {
    throw new Error(`Failed to initialize bridge: invalid top origin: ${i26}`);
  }
  const u52 = t15;
  if (u52.nestedAppAuthBridge) return void a20("Nested App Auth Bridge is already present");
  const g23 = function(t16) {
    const r18 = /* @__PURE__ */ new WeakMap(), { onMessage: i27 } = n16, p57 = (e21) => (t17) => i27(t17, e21);
    return { addEventListener: (e21, n19) => {
      if ("message" === e21) {
        const o24 = p57(n19);
        r18.set(n19, o24), t16.addEventListener(e21, o24);
      } else a20(`Event ${e21} is not supported by nestedAppAuthBridge`);
    }, postMessage: (n19) => {
      if (!t16.top) throw new Error("window.top is not available for posting messages");
      try {
        const r19 = JSON.parse(n19);
        if ("object" == typeof r19 && "NestedAppAuthRequest" === r19.messageType) {
          const r20 = function(t17) {
            const n20 = Date.now();
            return { id: s19(), uuid: t8(), func: "nestedAppAuth.execute", timestamp: n20, apiVersionTag: "v2_nestedAppAuth.execute", monotonicTimestamp: n20, args: [], data: t17 };
          }(n19);
          if (t16 === t16.top || !o15) return void d22("Not in an embedded iframe; skipping postMessage.");
          t16.top.postMessage(r20, o15);
        }
      } catch (e21) {
        return void d22("Failed to parse message:", e21, "Original message:", n19);
      }
    }, removeEventListener: (e21, n19) => {
      const o24 = r18.get(n19);
      o24 && (t16.removeEventListener(e21, o24), r18.delete(n19));
    } };
  }(u52);
  g23 && (u52.nestedAppAuthBridge = g23);
}
function s19() {
  return "undefined" != typeof crypto && crypto.randomUUID ? crypto.randomUUID() : Math.random().toString(36).substring(2, 11);
}
function a20(...e21) {
  r13 && console.log(...e21);
}
function d22(...e21) {
  r13 && console.error(...e21);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/notifications.js
var notifications_exports = {};
__export(notifications_exports, {
  isSupported: () => c17,
  showNotification: () => m24
});
function m24(m55) {
  if (m7(g3, a2.content), !c17()) throw l;
  $2(s6("v1", "notifications.showNotification"), "notifications.showNotification", [m55]);
}
function c17() {
  return !(!m7(g3) || !g3.supports.notifications);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/otherAppStateChange.js
var otherAppStateChange_exports = {};
__export(otherAppStateChange_exports, {
  isSupported: () => A13,
  notifyInstallCompleted: () => h15,
  registerAppInstallationHandler: () => a21,
  unregisterAppInstallationHandler: () => f19
});
var m25 = "v2";
function a21(t15) {
  if (!A13()) throw new Error(E2.NOT_SUPPORTED_ON_PLATFORM.toString());
  if (n13(t15)) throw new Error(E2.INVALID_ARGUMENTS.toString());
  p10(s6(m25, "otherApp.install"), "otherApp.install", t15);
}
function f19() {
  if (!A13()) throw new Error(E2.NOT_SUPPORTED_ON_PLATFORM.toString());
  $2(s6(m25, "otherApp.unregisterInstall"), "otherApp.unregisterInstall"), g6("otherApp.install");
}
function h15(t15) {
  if (!A13()) throw new Error(E2.NOT_SUPPORTED_ON_PLATFORM.toString());
  return A3("otherApp.notifyInstallCompleted", [t15.toString()], s6(m25, "otherApp.notifyInstallCompleted"));
}
function A13() {
  return !(!m7(g3) || !g3.supports.otherAppStateChange);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/remoteCamera.js
var remoteCamera_exports = {};
__export(remoteCamera_exports, {
  ControlCommand: () => i18,
  ErrorReason: () => C12,
  SessionTerminatedReason: () => s20,
  getCapableParticipants: () => d23,
  isSupported: () => b11,
  registerOnCapableParticipantsChangeHandler: () => h16,
  registerOnDeviceStateChangeHandler: () => E11,
  registerOnErrorHandler: () => w15,
  registerOnSessionStatusChangeHandler: () => p29,
  requestControl: () => c18,
  sendControlCommand: () => u26,
  terminateSession: () => f20
});
var l25 = "v1";
var i18;
var C12;
var s20;
function d23(e21) {
  if (!e21) throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");
  if (m7(g3, a2.sidePanel), !b11()) throw l;
  $2(s6(l25, "remoteCamera.getCapableParticipants"), "remoteCamera.getCapableParticipants", e21);
}
function c18(e21, i26) {
  if (!e21) throw new Error("[remoteCamera.requestControl] Participant cannot be null");
  if (!i26) throw new Error("[remoteCamera.requestControl] Callback cannot be null");
  if (m7(g3, a2.sidePanel), !b11()) throw l;
  $2(s6(l25, "remoteCamera.requestControl"), "remoteCamera.requestControl", [e21], i26);
}
function u26(e21, i26) {
  if (!e21) throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");
  if (!i26) throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");
  if (m7(g3, a2.sidePanel), !b11()) throw l;
  $2(s6(l25, "remoteCamera.sendControlCommand"), "remoteCamera.sendControlCommand", [e21], i26);
}
function f20(e21) {
  if (!e21) throw new Error("[remoteCamera.terminateSession] Callback cannot be null");
  if (m7(g3, a2.sidePanel), !b11()) throw l;
  $2(s6(l25, "remoteCamera.terminateSession"), "remoteCamera.terminateSession", e21);
}
function h16(r18) {
  if (!r18) throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");
  if (m7(g3, a2.sidePanel), !b11()) throw l;
  p10(s6(l25, "remoteCamera.registerOnCapableParticipantsChangeHandler"), "remoteCamera.capableParticipantsChange", r18);
}
function w15(r18) {
  if (!r18) throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");
  if (m7(g3, a2.sidePanel), !b11()) throw l;
  p10(s6(l25, "remoteCamera.registerOnErrorHandler"), "remoteCamera.handlerError", r18);
}
function E11(r18) {
  if (!r18) throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");
  if (m7(g3, a2.sidePanel), !b11()) throw l;
  p10(s6(l25, "remoteCamera.registerOnDeviceStateChangeHandler"), "remoteCamera.deviceStateChange", r18);
}
function p29(r18) {
  if (!r18) throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");
  if (m7(g3, a2.sidePanel), !b11()) throw l;
  p10(s6(l25, "remoteCamera.registerOnSessionStatusChangeHandler"), "remoteCamera.sessionStatusChange", r18);
}
function b11() {
  return !(!m7(g3) || !g3.supports.remoteCamera);
}
!function(r18) {
  r18.Reset = "Reset", r18.ZoomIn = "ZoomIn", r18.ZoomOut = "ZoomOut", r18.PanLeft = "PanLeft", r18.PanRight = "PanRight", r18.TiltUp = "TiltUp", r18.TiltDown = "TiltDown";
}(i18 || (i18 = {})), function(r18) {
  r18[r18.CommandResetError = 0] = "CommandResetError", r18[r18.CommandZoomInError = 1] = "CommandZoomInError", r18[r18.CommandZoomOutError = 2] = "CommandZoomOutError", r18[r18.CommandPanLeftError = 3] = "CommandPanLeftError", r18[r18.CommandPanRightError = 4] = "CommandPanRightError", r18[r18.CommandTiltUpError = 5] = "CommandTiltUpError", r18[r18.CommandTiltDownError = 6] = "CommandTiltDownError", r18[r18.SendDataError = 7] = "SendDataError";
}(C12 || (C12 = {})), function(r18) {
  r18[r18.None = 0] = "None", r18[r18.ControlDenied = 1] = "ControlDenied", r18[r18.ControlNoResponse = 2] = "ControlNoResponse", r18[r18.ControlBusy = 3] = "ControlBusy", r18[r18.AckTimeout = 4] = "AckTimeout", r18[r18.ControlTerminated = 5] = "ControlTerminated", r18[r18.ControllerTerminated = 6] = "ControllerTerminated", r18[r18.DataChannelError = 7] = "DataChannelError", r18[r18.ControllerCancelled = 8] = "ControllerCancelled", r18[r18.ControlDisabled = 9] = "ControlDisabled", r18[r18.ControlTerminatedToAllowOtherController = 10] = "ControlTerminatedToAllowOtherController";
}(s20 || (s20 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/appEntity.js
var appEntity_exports = {};
__export(appEntity_exports, {
  isSupported: () => l26,
  selectAppEntity: () => o16
});
function o16(o24, a35, m55, c43) {
  if (m7(g3, a2.content), !l26()) throw l;
  if (!o24 || 0 == o24.length) throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");
  if (!c43) throw new Error("[appEntity.selectAppEntity] Callback cannot be null");
  $2(s6("v1", "appEntity.selectAppEntity"), "appEntity.selectAppEntity", [o24, a35, m55], c43);
}
function l26() {
  return !(!m7(g3) || !g3.supports.appEntity);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/teams/teams.js
var teams_exports = {};
__export(teams_exports, {
  ChannelType: () => i19,
  fullTrust: () => fullTrust_exports2,
  getTeamChannels: () => m27,
  isSupported: () => f21,
  refreshSiteUrl: () => s22
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/teams/fullTrust/fullTrust.js
var fullTrust_exports2 = {};
__export(fullTrust_exports2, {
  getConfigSetting: () => m26,
  isSupported: () => s21,
  joinedTeams: () => joinedTeams_exports
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/teams/fullTrust/joinedTeams.js
var joinedTeams_exports = {};
__export(joinedTeams_exports, {
  getUserJoinedTeams: () => p30,
  isSupported: () => u27
});
function p30(p56) {
  return new Promise((f46) => {
    if (m7(g3), !u27()) throw l;
    if ((e11.hostClientType === o4.android || e11.hostClientType === o4.teamsRoomsAndroid || e11.hostClientType === o4.teamsPhones || e11.hostClientType === o4.teamsDisplays) && !u10(o9)) {
      const t15 = { errorCode: E2.OLD_PLATFORM };
      throw new Error(JSON.stringify(t15));
    }
    f46(O5(s6("v1", "teams.fullTrust.joinedTeams.getUserJoinedTeams"), "getUserJoinedTeams", p56));
  });
}
function u27() {
  return !(!m7(g3) || !g3.supports.teams) && (!!g3.supports.teams.fullTrust && !!g3.supports.teams.fullTrust.joinedTeams);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/teams/fullTrust/fullTrust.js
function m26(e21) {
  return new Promise((m55) => {
    if (m7(g3), !s21()) throw l;
    m55(O5(s6("v1", "teams.fullTrust.getConfigSetting"), "getConfigSetting", e21));
  });
}
function s21() {
  return !(!m7(g3) || !g3.supports.teams) && !!g3.supports.teams.fullTrust;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/teams/teams.js
var i19;
function m27(l43, i26) {
  if (m7(g3, a2.content), !f21()) throw l;
  if (!l43) throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");
  if (!i26) throw new Error("[teams.getTeamChannels] Callback cannot be null");
  $2(s6("v1", "teams.getTeamChannels"), "teams.getTeamChannels", [l43], i26);
}
function s22(n19, l43) {
  if (m7(g3), !f21()) throw l;
  if (!n19) throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");
  if (!l43) throw new Error("[teams.refreshSiteUrl] Callback cannot be null");
  $2(s6("v1", "teams.refreshSiteUrl"), "teams.refreshSiteUrl", [n19], l43);
}
function f21() {
  return !(!m7(g3) || !g3.supports.teams);
}
!function(r18) {
  r18[r18.Regular = 0] = "Regular", r18[r18.Private = 1] = "Private", r18[r18.Shared = 2] = "Shared";
}(i19 || (i19 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/videoEffectsEx.js
var videoEffectsEx_exports = {};
__export(videoEffectsEx_exports, {
  ErrorLevel: () => F10,
  frameProcessingTimeoutInMs: () => p33,
  isSupported: () => x7,
  notifyFatalError: () => H8,
  notifySelectedVideoEffectChanged: () => P11,
  registerForVideoEffect: () => w18,
  registerForVideoFrame: () => g13,
  updatePersonalizedEffects: () => V6
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/videoEffects.js
var videoEffects_exports = {};
__export(videoEffects_exports, {
  EffectChangeType: () => E12,
  EffectFailureReason: () => g12,
  VideoFrameFormat: () => F9,
  isSupported: () => b12,
  notifySelectedVideoEffectChanged: () => P10,
  registerForVideoEffect: () => w16,
  registerForVideoFrame: () => h18
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/videoFrameTick.js
var e17 = class _e {
  static setTimeout(s38, a35) {
    const o24 = performance.now(), c43 = u3();
    return _e.setTimeoutCallbacks[c43] = { callback: s38, timeoutInMs: a35, startedAtInMs: o24 }, c43;
  }
  static clearTimeout(t15) {
    delete _e.setTimeoutCallbacks[t15];
  }
  static setInterval(t15, s38) {
    _e.setTimeout(function a35() {
      t15(), _e.setTimeout(a35, s38);
    }, s38);
  }
  static tick() {
    const t15 = performance.now(), s38 = [];
    for (const a35 in _e.setTimeoutCallbacks) {
      const o24 = _e.setTimeoutCallbacks[a35];
      t15 - o24.startedAtInMs >= o24.timeoutInMs && s38.push(a35);
    }
    for (const t16 of s38) {
      _e.setTimeoutCallbacks[t16].callback(), delete _e.setTimeoutCallbacks[t16];
    }
  }
};
e17.setTimeoutCallbacks = {};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/videoPerformanceStatistics.js
var s23 = class _s {
  constructor(t15, s38) {
    this.reportStatisticsResult = s38, this.sampleCount = 0, this.distributionBins = new Uint32Array(t15);
  }
  processStarts(s38, e21, i26, r18) {
    e17.tick(), this.suitableForThisSession(s38, e21, i26, r18) || this.reportAndResetSession(this.getStatistics(), s38, r18, e21, i26), this.start();
  }
  processEnds() {
    const t15 = performance.now() - this.frameProcessingStartedAt, s38 = Math.floor(Math.max(0, Math.min(this.distributionBins.length - 1, t15)));
    this.distributionBins[s38] += 1, this.sampleCount += 1;
  }
  getStatistics() {
    return this.currentSession ? { effectId: this.currentSession.effectId, effectParam: this.currentSession.effectParam, frameHeight: this.currentSession.frameHeight, frameWidth: this.currentSession.frameWidth, duration: performance.now() - this.currentSession.startedAtInMs, sampleCount: this.sampleCount, distributionBins: this.distributionBins.slice() } : null;
  }
  start() {
    this.frameProcessingStartedAt = performance.now();
  }
  suitableForThisSession(t15, s38, e21, i26) {
    return this.currentSession && this.currentSession.effectId === t15 && this.currentSession.effectParam === i26 && this.currentSession.frameWidth === s38 && this.currentSession.frameHeight === e21;
  }
  reportAndResetSession(s38, e21, i26, r18, n19) {
    s38 && this.reportStatisticsResult(s38), this.resetCurrentSession(this.getNextTimeout(e21, this.currentSession), e21, i26, r18, n19), this.timeoutId && e17.clearTimeout(this.timeoutId), this.timeoutId = e17.setTimeout((() => this.reportAndResetSession(this.getStatistics(), e21, i26, r18, n19)).bind(this), this.currentSession.timeoutInMs);
  }
  resetCurrentSession(t15, s38, e21, i26, r18) {
    this.currentSession = { startedAtInMs: performance.now(), timeoutInMs: t15, effectId: s38, effectParam: e21, frameWidth: i26, frameHeight: r18 }, this.sampleCount = 0, this.distributionBins.fill(0);
  }
  getNextTimeout(t15, e21) {
    return e21 && e21.effectId === t15 ? Math.min(_s.maxSessionTimeoutInMs, 2 * e21.timeoutInMs) : _s.initialSessionTimeoutInMs;
  }
};
s23.initialSessionTimeoutInMs = 1e3, s23.maxSessionTimeoutInMs = 3e4;

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/videoPerformanceMonitor.js
var i20 = "v2";
var s24 = class _s {
  constructor(t15) {
    this.reportPerformanceEvent = t15, this.isFirstFrameProcessed = false, this.frameProcessTimeLimit = 100, this.frameProcessingStartedAt = 0, this.frameProcessingTimeCost = 0, this.processedFrameCount = 0, this.performanceStatistics = new s23(_s.distributionBinSize, (t16) => this.reportPerformanceEvent(s6(i20, "videoPerformanceMonitor.performanceDataGenerated"), "video.performance.performanceDataGenerated", [t16]));
  }
  startMonitorSlowFrameProcessing() {
    e17.setInterval(() => {
      if (0 === this.processedFrameCount) return;
      const t15 = this.frameProcessingTimeCost / this.processedFrameCount;
      t15 > this.frameProcessTimeLimit && this.reportPerformanceEvent(s6(i20, "videoPerformanceMonitor.startMonitorSlowFrameProcessing"), "video.performance.frameProcessingSlow", [t15]), this.frameProcessingTimeCost = 0, this.processedFrameCount = 0;
    }, _s.calculateFPSInterval);
  }
  setFrameProcessTimeLimit(e21) {
    this.frameProcessTimeLimit = e21;
  }
  reportApplyingVideoEffect(e21, t15) {
    var r18, i26;
    (null === (r18 = this.applyingEffect) || void 0 === r18 ? void 0 : r18.effectId) === e21 && (null === (i26 = this.applyingEffect) || void 0 === i26 ? void 0 : i26.effectParam) === t15 || (this.applyingEffect = { effectId: e21, effectParam: t15 }, this.appliedEffect = void 0);
  }
  reportVideoEffectChanged(e21, t15) {
    void 0 === this.applyingEffect || this.applyingEffect.effectId !== e21 && this.applyingEffect.effectParam !== t15 || (this.appliedEffect = { effectId: e21, effectParam: t15 }, this.applyingEffect = void 0, this.isFirstFrameProcessed = false);
  }
  reportStartFrameProcessing(e21, r18) {
    e17.tick(), this.appliedEffect && (this.frameProcessingStartedAt = performance.now(), this.performanceStatistics.processStarts(this.appliedEffect.effectId, e21, r18, this.appliedEffect.effectParam));
  }
  reportFrameProcessed() {
    var t15;
    this.appliedEffect && (this.processedFrameCount++, this.frameProcessingTimeCost += performance.now() - this.frameProcessingStartedAt, this.performanceStatistics.processEnds(), this.isFirstFrameProcessed || (this.isFirstFrameProcessed = true, this.reportPerformanceEvent(s6(i20, "videoPerformanceMonitor.reportFrameProcessed"), "video.performance.firstFrameProcessed", [Date.now(), this.appliedEffect.effectId, null === (t15 = this.appliedEffect) || void 0 === t15 ? void 0 : t15.effectParam])));
  }
  reportGettingTextureStream(e21) {
    this.gettingTextureStreamStartedAt = performance.now(), this.currentStreamId = e21;
  }
  reportTextureStreamAcquired() {
    if (void 0 !== this.gettingTextureStreamStartedAt) {
      const t15 = performance.now() - this.gettingTextureStreamStartedAt;
      this.reportPerformanceEvent(s6(i20, "videoPerformanceMonitor.reportTextureStreamAcquired"), "video.performance.textureStreamAcquired", [this.currentStreamId, t15]);
    }
  }
};
s24.distributionBinSize = 1e3, s24.calculateFPSInterval = 1e3;

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/videoEffects.js
var u28 = "v2";
var p32 = y2() ? void 0 : new s24($2);
var F9;
var E12;
var g12;
function h18(d39) {
  if (m7(g3, a2.sidePanel), !b12()) throw l;
  if (!d39.videoFrameHandler || !d39.videoBufferHandler) throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");
  if (p10(s6(u28, "videoEffects.setFrameProcessTimeLimitHandler"), "video.setFrameProcessTimeLimit", (e21) => null == p32 ? void 0 : p32.setFrameProcessTimeLimit(e21.timeLimit), false), j13()) !function(i26, d40) {
    if (m7(g3, a2.sidePanel), !b12() || !j13()) throw l;
    p10(s6(u28, "videoEffects.startVideoExtensibilityVideoStreamHandler"), "video.startVideoExtensibilityVideoStream", (r18) => n(this, void 0, void 0, function* () {
      const { streamId: o24 } = r18, t15 = /* @__PURE__ */ function(i27, r19) {
        return (o25) => n(this, void 0, void 0, function* () {
          const e21 = o25.videoFrame;
          null == r19 || r19.reportStartFrameProcessing(e21.codedWidth, e21.codedHeight);
          const t16 = yield i27(o25);
          return null == r19 || r19.reportFrameProcessed(), t16;
        });
      }(i26, p32);
      yield h17(o24, t15, V5, p32);
    }), false), $2(s6(u28, "videoEffects.mediaStream.registerForVideoFrame"), "video.mediaStream.registerForVideoFrame", [d40]);
  }(d39.videoFrameHandler, d39.config);
  else {
    if (!S11()) throw l;
    !function(e21, d40) {
      if (m7(g3, a2.sidePanel), !b12() || !S11()) throw l;
      p10(s6(u28, "videoEffects.registerForVideoBufferHandler"), "video.newVideoFrame", (o24) => {
        if (o24) {
          const t15 = o24.timestamp;
          null == p32 || p32.reportStartFrameProcessing(o24.width, o24.height), e21(function(e22) {
            if ("videoFrameBuffer" in e22) return e22;
            {
              const { data: r18 } = e22, o25 = t2(e22, ["data"]);
              return Object.assign(Object.assign({}, o25), { videoFrameBuffer: r18 });
            }
          }(o24), () => {
            null == p32 || p32.reportFrameProcessed(), function(e22) {
              $2(s6(u28, "videoEffects.notifyVideoFrameProcessed"), "video.videoFrameProcessed", [e22]);
            }(t15);
          }, V5);
        }
      }, false), $2(s6(u28, "videoEffects.registerForVideoFrame"), "video.registerForVideoFrame", [d40]);
    }(d39.videoBufferHandler, d39.config);
  }
  null == p32 || p32.startMonitorSlowFrameProcessing();
}
function P10(e21, i26) {
  if (m7(g3, a2.sidePanel), !b12()) throw l;
  $2(s6(u28, "videoEffects.notifySelectedVideoEffectChanged"), "video.videoEffectChanged", [e21, i26]);
}
function w16(e21) {
  if (m7(g3, a2.sidePanel), !b12()) throw l;
  p10(s6(u28, "videoEffects.registerEffectParameterChangeHandler"), "video.effectParameterChange", p31(e21, p32), false), $2(s6(u28, "videoEffects.registerForVideoEffect"), "video.registerForVideoEffect");
}
function V5(e21) {
  $2(s6(u28, "videoEffects.notifyError"), "video.notifyError", [e21]);
}
function b12() {
  return m7(g3) && !!g3.supports.video && (!!g3.supports.video.mediaStream || !!g3.supports.video.sharedFrame);
}
function j13() {
  var e21;
  return m7(g3, a2.sidePanel) && function() {
    var e22, i26, r18, o24;
    return !(!(null === (i26 = null === (e22 = w2().chrome) || void 0 === e22 ? void 0 : e22.webview) || void 0 === i26 ? void 0 : i26.getTextureStream) || !(null === (o24 = null === (r18 = w2().chrome) || void 0 === r18 ? void 0 : r18.webview) || void 0 === o24 ? void 0 : o24.registerTextureStream));
  }() && !!(null === (e21 = g3.supports.video) || void 0 === e21 ? void 0 : e21.mediaStream);
}
function S11() {
  var e21;
  return m7(g3, a2.sidePanel) && !!(null === (e21 = g3.supports.video) || void 0 === e21 ? void 0 : e21.sharedFrame);
}
!function(e21) {
  e21.NV12 = "NV12";
}(F9 || (F9 = {})), function(e21) {
  e21.EffectChanged = "EffectChanged", e21.EffectDisabled = "EffectDisabled";
}(E12 || (E12 = {})), function(e21) {
  e21.InvalidEffectId = "InvalidEffectId", e21.InitializationFailure = "InitializationFailure";
}(g12 || (g12 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/videoEffectsUtils.js
var d24 = "v2";
function h17(t15, r18, i26, o24) {
  var a35, s38;
  return n(this, void 0, void 0, function* () {
    const e21 = f22();
    !y2() && (null === (s38 = null === (a35 = window.chrome) || void 0 === a35 ? void 0 : a35.webview) || void 0 === s38 || s38.registerTextureStream(t15, e21)), l27(yield u29(t15, i26, o24), new m28(i26, r18), e21.writable);
  });
}
function c19(t15, r18, i26, o24) {
  var a35, s38;
  return n(this, void 0, void 0, function* () {
    const e21 = f22();
    !y2() && (null === (s38 = null === (a35 = window.chrome) || void 0 === a35 ? void 0 : a35.webview) || void 0 === s38 || s38.registerTextureStream(t15, e21)), l27(yield u29(t15, i26, o24), new v14(i26, r18), e21.writable);
  });
}
function u29(r18, i26, o24) {
  return n(this, void 0, void 0, function* () {
    if (y2()) throw l;
    const e21 = w2().chrome;
    try {
      null == o24 || o24.reportGettingTextureStream(r18);
      const t15 = (yield e21.webview.getTextureStream(r18)).getVideoTracks();
      if (0 === t15.length) throw new Error(`No video track in stream ${r18}`);
      return null == o24 || o24.reportTextureStreamAcquired(), t15[0];
    } catch (e22) {
      throw i26(`Failed to get video track from stream ${r18}, error: ${e22}`), new Error(`Internal error: can't get video track from stream ${r18}`);
    }
  });
}
function f22() {
  if (y2()) throw l;
  const e21 = window.MediaStreamTrackGenerator;
  if (!e21) throw l;
  return new e21({ kind: "video" });
}
function l27(e21, t15, r18) {
  new (0, w2().MediaStreamTrackProcessor)({ track: e21 }).readable.pipeThrough(new TransformStream(t15)).pipeTo(r18);
}
var m28 = class {
  constructor(t15, r18) {
    this.notifyError = t15, this.videoFrameHandler = r18, this.transform = (t16, r19) => n(this, void 0, void 0, function* () {
      const e21 = t16.timestamp;
      if (null !== e21) try {
        const i26 = yield this.videoFrameHandler({ videoFrame: t16 }), o24 = new VideoFrame(i26, { timestamp: e21 });
        r19.enqueue(o24), t16.close(), i26.close();
      } catch (e22) {
        t16.close(), this.notifyError(e22);
      }
      else this.notifyError("timestamp of the original video frame is null");
    });
  }
};
var w17 = class {
  constructor(e21, t15) {
    if (this.headerBuffer = e21, this.notifyError = t15, this.ONE_TEXTURE_INPUT_ID = 1869900081, this.INVALID_HEADER_ERROR = "Invalid video frame header", this.UNSUPPORTED_LAYOUT_ERROR = "Unsupported texture layout", this.headerDataView = new Uint32Array(e21), this.headerDataView.length < 8) throw this.notifyError(this.INVALID_HEADER_ERROR), new Error(this.INVALID_HEADER_ERROR);
    if (this.headerDataView[0] !== this.ONE_TEXTURE_INPUT_ID) throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR), new Error(this.UNSUPPORTED_LAYOUT_ERROR);
  }
  get oneTextureLayoutId() {
    return this.headerDataView[0];
  }
  get version() {
    return this.headerDataView[1];
  }
  get frameRowOffset() {
    return this.headerDataView[2];
  }
  get frameFormat() {
    return this.headerDataView[3];
  }
  get frameWidth() {
    return this.headerDataView[4];
  }
  get frameHeight() {
    return this.headerDataView[5];
  }
  get multiStreamHeaderRowOffset() {
    return this.headerDataView[6];
  }
  get multiStreamCount() {
    return this.headerDataView[7];
  }
};
var E13 = class {
  constructor(e21, t15) {
    this.metadataMap = /* @__PURE__ */ new Map(), this.AUDIO_INFERENCE_RESULT_STREAM_ID = 828664161, this.ATTRIBUTE_ID_MAP_STREAM_ID = 1296320833;
    const r18 = new Uint32Array(e21);
    for (let i26 = 0, o24 = 0; i26 < t15; i26++) {
      const t16 = r18[o24++], i27 = r18[o24++], a35 = r18[o24++], n19 = new Uint8Array(e21, i27, a35);
      this.metadataMap.set(t16, n19);
    }
  }
  get audioInferenceResult() {
    return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID);
  }
  get attributes() {
    const e21 = this.metadataMap.get(this.ATTRIBUTE_ID_MAP_STREAM_ID);
    if (void 0 === e21) return;
    const t15 = /* @__PURE__ */ new Map(), r18 = new TextDecoder("utf-8");
    let i26 = 0;
    const o24 = e21[i26] + (e21[++i26] << 8) + (e21[++i26] << 16) + (e21[++i26] << 24);
    for (let a35 = 0; a35 < o24 && i26 < e21.length - 1; a35++) {
      const o25 = e21[++i26] + (e21[++i26] << 8) + (e21[++i26] << 16) + (e21[++i26] << 24), a36 = e21.findIndex((e22, t16, r19) => 0 == e22 && t16 > i26), n19 = r18.decode(e21.slice(++i26, a36)), s38 = this.metadataMap.get(o25);
      void 0 !== s38 && t15.set(n19, s38);
      i26 = a36 + (4 - (a36 - i26) % 4 - 1);
    }
    return t15;
  }
};
var v14 = class {
  constructor(r18, i26) {
    this.notifyError = r18, this.videoFrameHandler = i26, this.shouldDiscardAudioInferenceResult = false, this.transform = (t15, r19) => n(this, void 0, void 0, function* () {
      const e21 = t15.timestamp;
      if (null !== e21) try {
        const { videoFrame: i27, metadata: { audioInferenceResult: o24, attributes: a35 } = {} } = yield this.extractVideoFrameAndMetadata(t15), n19 = yield this.videoFrameHandler({ videoFrame: i27, audioInferenceResult: o24, attributes: a35 }), s38 = new VideoFrame(n19, { timestamp: e21 });
        r19.enqueue(s38), i27.close(), t15.close(), n19.close();
      } catch (e22) {
        t15.close(), this.notifyError(e22);
      }
      else this.notifyError("timestamp of the original video frame is null");
    }), this.extractVideoFrameAndMetadata = (r19) => n(this, void 0, void 0, function* () {
      if (y2()) throw l;
      if ("NV12" !== r19.format) throw this.notifyError("Unsupported video frame pixel format"), new Error("Unsupported video frame pixel format");
      const e21 = { x: 0, y: 0, width: r19.codedWidth, height: 2 }, i27 = new ArrayBuffer(e21.width * e21.height * 3 / 2);
      yield r19.copyTo(i27, { rect: e21 });
      const o24 = new w17(i27, this.notifyError), a35 = { x: 0, y: o24.multiStreamHeaderRowOffset, width: r19.codedWidth, height: r19.codedHeight - o24.multiStreamHeaderRowOffset }, s38 = new ArrayBuffer(a35.width * a35.height * 3 / 2);
      yield r19.copyTo(s38, { rect: a35 });
      const d39 = new E13(s38, o24.multiStreamCount);
      return { videoFrame: new VideoFrame(r19, { timestamp: r19.timestamp, visibleRect: { x: 0, y: o24.frameRowOffset, width: o24.frameWidth, height: o24.frameHeight } }), metadata: { audioInferenceResult: this.shouldDiscardAudioInferenceResult ? void 0 : d39.audioInferenceResult, attributes: d39.attributes } };
    }), p10(s6(d24, "videoEffectsUtils.transformerWithMetadata.constructor"), "video.mediaStream.audioInferenceDiscardStatusChange", ({ discardAudioInferenceResult: e21 }) => {
      this.shouldDiscardAudioInferenceResult = e21;
    });
  }
};
function p31(e21, t15) {
  return (o24, n19) => {
    null == t15 || t15.reportApplyingVideoEffect(o24 || "", n19), e21(o24, n19).then(() => {
      null == t15 || t15.reportVideoEffectChanged(o24 || "", n19), $2(s6(d24, "videoEffectsUtils.reportVideoEffectChanged"), "video.videoEffectReadiness", [true, o24, void 0, n19]);
    }).catch((e22) => {
      const t16 = e22 in g12 ? e22 : g12.InitializationFailure;
      $2(s6(d24, "videoEffectsUtils.effectFailure"), "video.videoEffectReadiness", [false, o24, t16, n19]);
    });
  };
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/videoEffectsEx.js
var u30 = "v2";
var p33 = 2e3;
var E14 = y2() ? void 0 : new s24($2);
var F10;
function g13(n19) {
  var d39, f46;
  if (!x7()) throw l;
  if (!n19.videoFrameHandler || !n19.videoBufferHandler) throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");
  if (m7(g3, a2.sidePanel)) {
    if (p10(s6(u30, "videoEffectsEX.registerSetFrameProcessTimeLimitHandler"), "video.setFrameProcessTimeLimit", (e21) => null == E14 ? void 0 : E14.setFrameProcessTimeLimit(e21), false), null === (d39 = g3.supports.video) || void 0 === d39 ? void 0 : d39.mediaStream) p10(s6(u30, "videoEffectsEX.registerStartVideoExtensibilityVideoStreamHandler"), "video.startVideoExtensibilityVideoStream", (r18) => n(this, void 0, void 0, function* () {
      const { streamId: i26, metadataInTexture: o24 } = r18, t15 = E14 ? /* @__PURE__ */ function(r19, i27) {
        return (o25) => n(this, void 0, void 0, function* () {
          const e21 = o25.videoFrame;
          i27.reportStartFrameProcessing(e21.codedWidth, e21.codedHeight);
          const t16 = h19(), n20 = yield r19(o25);
          return t16(), i27.reportFrameProcessed(), n20;
        });
      }(n19.videoFrameHandler, E14) : n19.videoFrameHandler;
      o24 ? yield c19(i26, t15, y10, E14) : yield h17(i26, t15, y10, E14);
    }), false), $2(s6(u30, "videoEffectsEX.mediaStream.registerForVideoFrame"), "video.mediaStream.registerForVideoFrame", [n19.config]);
    else {
      if (!(null === (f46 = g3.supports.video) || void 0 === f46 ? void 0 : f46.sharedFrame)) throw l;
      p10(s6(u30, "videoEffectsEx.registerNewVideoFrameHandler"), "video.newVideoFrame", (e21) => {
        if (e21) {
          null == E14 || E14.reportStartFrameProcessing(e21.width, e21.height);
          const i26 = h19(), o24 = e21.timestamp;
          n19.videoBufferHandler(function(e22) {
            return e22.videoFrameBuffer = e22.videoFrameBuffer || e22.data, delete e22.data, e22;
          }(e21), () => {
            i26(), null == E14 || E14.reportFrameProcessed(), function(e22) {
              $2(s6(u30, "videoEffectsEx.notifyVideoFrameProcessed"), "video.videoFrameProcessed", [e22]);
            }(o24);
          }, y10);
        }
      }, false), $2(s6(u30, "videoEffectsEx.registerForVideoFrame"), "video.registerForVideoFrame", [n19.config]);
    }
    null == E14 || E14.startMonitorSlowFrameProcessing();
  }
}
function h19() {
  const e21 = setTimeout(() => {
    y10(`Frame not processed in ${p33}ms`, F10.Warn);
  }, p33);
  return function() {
    clearTimeout(e21);
  };
}
function P11(e21, i26, n19) {
  if (m7(g3, a2.sidePanel), !x7()) throw l;
  $2(s6(u30, "videoEffectsEx.notifySelectedVideoEffectChanged"), "video.videoEffectChanged", [e21, i26, n19]);
}
function w18(e21) {
  if (m7(g3, a2.sidePanel), !x7()) throw l;
  p10(s6(u30, "videoEffectsEx.registerEffectParamterChangeHandler"), "video.effectParameterChange", p31(e21, E14), false), $2(s6(u30, "videoEffectsEx.registerForVideoEffect"), "video.registerForVideoEffect");
}
function V6(e21) {
  if (m7(g3, a2.sidePanel), !b12()) throw l;
  $2(s6(u30, "videoEffectsEx.updatePersonalizedEffects"), "video.personalizedEffectsChanged", [e21]);
}
function x7() {
  return m7(g3), b12();
}
function y10(e21, i26 = F10.Warn) {
  $2(s6(u30, "videoEffectsEx.notifyError"), "video.notifyError", [e21, i26]);
}
function H8(e21) {
  if (m7(g3), !b12()) throw l;
  y10(e21, F10.Fatal);
}
!function(e21) {
  e21.Fatal = "fatal", e21.Warn = "warn";
}(F10 || (F10 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/hostEntity/hostEntity.js
var hostEntity_exports = {};
__export(hostEntity_exports, {
  AppTypes: () => o17,
  isSupported: () => i21,
  tab: () => tab_exports
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/hostEntity/tab.js
var tab_exports = {};
__export(tab_exports, {
  addAndConfigure: () => f23,
  getAll: () => m29,
  isSupported: () => y11,
  reconfigure: () => b13,
  remove: () => w19,
  rename: () => T10
});
var l28 = "v2";
var d25 = class extends e15 {
  validate(t15) {
    return "ConfigurableTab" === t15.tabType;
  }
  deserialize(t15) {
    return t15;
  }
};
var c20 = class {
  constructor(t15) {
    this.configurableTabInstance = t15;
  }
  serialize() {
    return this.configurableTabInstance;
  }
};
var u31 = class {
  constructor(t15) {
    this.hostEntityId = t15;
  }
  serialize() {
    return this.hostEntityId;
  }
};
var E15 = class extends e15 {
  validate(t15) {
    return "ConfigurableTab" === t15.tabType || "StaticTab" === t15.tabType;
  }
  deserialize(t15) {
    return t15;
  }
};
var h20 = class {
  constructor(t15) {
    this.hostEntityTabInstance = t15;
  }
  serialize() {
    return this.hostEntityTabInstance;
  }
};
var p34 = class extends e15 {
  validate(t15) {
    return t15.allTabs && t15.allTabs.forEach((t16) => {
    }), true;
  }
  deserialize(t15) {
    return t15;
  }
};
function f23(e21, n19) {
  if (m7(g3), !y11()) throw new Error(`Error code: ${E2.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);
  if (I8(e21.threadId), n19 && 0 === n19.length) throw new Error(`Error code: ${E2.INVALID_ARGUMENTS}, message: App types cannot be an empty array`);
  return N4("hostEntity.tab.addAndConfigure", [new u31(e21), n19], new E15(), s6(l28, "hostEntity.tab.addAndConfigure"));
}
function m29(e21) {
  if (m7(g3), !y11()) throw new Error(`Error code: ${E2.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);
  return I8(e21.threadId), N4("hostEntity.tab.getAll", [new u31(e21)], new p34(), s6(l28, "hostEntity.tab.getAll"));
}
function b13(e21, n19) {
  if (m7(g3), !y11()) throw new Error(`Error code: ${E2.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);
  return g14(e21), I8(n19.threadId), N4("hostEntity.tab.reconfigure", [new c20(e21), new u31(n19)], new d25(), s6(l28, "hostEntity.tab.reconfigure"));
}
function T10(e21, n19) {
  if (m7(g3), !y11()) throw new Error(`Error code: ${E2.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);
  return g14(e21), I8(n19.threadId), N4("hostEntity.tab.rename", [new c20(e21), new u31(n19)], new d25(), s6(l28, "hostEntity.tab.rename"));
}
function w19(n19, s38) {
  if (m7(g3), !y11()) throw new Error(`Error code: ${E2.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);
  return I8(s38.threadId), g14(n19), N4("hostEntity.tab.remove", [new h20(n19), new u31(s38)], new r11(), s6(l28, "hostEntity.tab.remove"));
}
function y11() {
  var t15;
  return !!(m7(g3) && i21() && (null === (t15 = g3.supports.hostEntity) || void 0 === t15 ? void 0 : t15.tab));
}
function I8(t15) {
  if (!t15 || 0 == t15.length) throw new Error(`Error code: ${E2.INVALID_ARGUMENTS}, message: ThreadId cannot be null or empty`);
}
function g14(t15) {
  if (!(null == t15 ? void 0 : t15.internalTabInstanceId) || 0 === t15.internalTabInstanceId.length) throw new Error(`Error code: ${E2.INVALID_ARGUMENTS}, message: TabId cannot be null or empty`);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/hostEntity/hostEntity.js
var o17;
function i21() {
  return !(!m7(g3) || !g3.supports.hostEntity);
}
!function(t15) {
  t15.edu = "EDU", t15.baseTownhall = "BASE_TOWNHALL", t15.streamingTownhall = "STREAMING_TOWNHALL";
}(o17 || (o17 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/store.js
var store_exports = {};
__export(store_exports, {
  isSupported: () => m30,
  openAppDetail: () => d26,
  openFullStore: () => c21,
  openInContextStore: () => f24,
  openSpecificStore: () => a22
});
var l29 = "v2";
var u32 = "Invalid store dialog size";
function c21(e21) {
  return n(this, void 0, void 0, function* () {
    v15();
    const { size: t15 } = null != e21 ? e21 : {};
    return A3("store.openFullStore", [b14(t15)], s6(l29, "store.openFullStore"));
  });
}
function d26(e21) {
  return n(this, void 0, void 0, function* () {
    v15();
    const { size: t15, appId: r18 } = e21;
    if (!(r18 instanceof i10)) throw new Error("No App Id present, but AppId needed to open AppDetail store");
    return A3("store.openAppDetail", [b14(t15), r18], s6(l29, "store.openAppDetail"));
  });
}
function f24(e21) {
  return n(this, void 0, void 0, function* () {
    v15();
    const { size: t15, appCapability: i26, appMetaCapabilities: r18, installationScope: p56, filteredOutAppIds: s38 } = null != e21 ? e21 : {};
    return A3("store.openInContextStore", [b14(t15), i26, r18, p56, null == s38 ? void 0 : s38.map((t16) => t16.toString())], s6(l29, "store.openInContextStore"));
  });
}
function a22(e21) {
  return n(this, void 0, void 0, function* () {
    v15();
    const { size: t15, collectionId: i26 } = e21;
    if (void 0 === i26) throw new Error("No Collection Id present, but CollectionId needed to open a store specific to a collection");
    return A3("store.openSpecificStore", [b14(t15), i26], s6(l29, "store.openSpecificStore"));
  });
}
function m30() {
  return m7(g3) && !!g3.supports.store;
}
function v15() {
  if (m7(g3, a2.content, a2.sidePanel, a2.meetingStage), !m30()) throw l;
}
function b14(t15) {
  if (void 0 === t15) return;
  const { width: o24, height: e21 } = t15;
  if (void 0 !== o24 && "number" == typeof o24 && o24 < 0) throw new Error(u32);
  if (void 0 !== e21 && "number" == typeof e21 && e21 < 0) throw new Error(u32);
  return JSON.stringify(t15);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/emailAddressValidation.js
function e18(e21) {
  const n19 = !e21 || e21.length <= 0, o24 = null == e21 ? void 0 : e21.indexOf("@"), t15 = null == e21 ? void 0 : e21.indexOf(".", o24);
  if (n19 || -1 === o24 || -1 === t15) throw new Error("Input email address does not have the correct format.");
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/emailAddress.js
var r14 = class {
  constructor(r18) {
    this.val = r18, e18(r18);
  }
  toString() {
    return this.val;
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/adaptiveCards.js
function r15() {
  return g3.hostVersionsInfo ? g3.hostVersionsInfo.adaptiveCardSchemaVersion : void 0;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/appWindow.js
var o18 = "v1";
var p35 = class {
  postMessage(s38, i26) {
    m7(g3), $2(s6(o18, "appWindow.childAppWindow.postMessage"), "messageForChild", [s38], i26 || i6());
  }
  addEventListener(e21, a35) {
    m7(g3), "message" === e21 && p10(s6(o18, "appWindow.childAppWindow.addEventListener"), "messageForParent", a35);
  }
};
var m31 = class {
  static get Instance() {
    return this._instance || (this._instance = new this());
  }
  postMessage(s38, p56) {
    m7(g3, a2.task), $2(s6(o18, "appWindow.parentAppWindow.postMessage"), "messageForParent", [s38], p56 || i6());
  }
  addEventListener(e21, a35) {
    m7(g3, a2.task), "message" === e21 && p10(s6(o18, "appWindow.parentAppWindow.addEventListener"), "messageForChild", a35);
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/teamsAPIs.js
var teamsAPIs_exports = {};
__export(teamsAPIs_exports, {
  enablePrintCapability: () => m32,
  isSupported: () => j14,
  print: () => f25,
  registerBeforeUnloadHandler: () => u33,
  registerBeforeUnloadHandlerHelper: () => c22,
  registerOnLoadHandler: () => p36,
  registerOnLoadHandlerHelper: () => d27
});
function m32() {
  if (!e11.printCapabilityEnabled) {
    if (m7(g3), !j14()) throw l;
    e11.printCapabilityEnabled = true, document.addEventListener("keydown", (t15) => {
      (t15.ctrlKey || t15.metaKey) && 80 === t15.keyCode && (f25(), t15.cancelBubble = true, t15.preventDefault(), t15.stopImmediatePropagation());
    });
  }
}
function f25() {
  w2().print();
}
function p36(t15) {
  d27(s6("v2", "teamsAPIs_registerOnLoadHandler"), t15, () => {
    if (!n13(t15) && !j14()) throw l;
  });
}
function d27(t15, r18, i26) {
  !n13(r18) && m7(g3), !n13(r18) && i26 && i26(), j10(t15, r18);
}
function u33(t15) {
  c22(s6("v2", "teamsAPIs_registerBeforeUnloadHandler"), t15, () => {
    if (!n13(t15) && !j14()) throw l;
  });
}
function c22(t15, e21, i26) {
  !n13(e21) && m7(g3), !n13(e21) && i26 && i26(), S8(t15, e21);
}
function j14() {
  return !(!m7(g3) || !g3.supports.teamsCore);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/publicAPIs.js
var x8 = "v1";
function B4(e21, n19) {
  k3(s6(x8, "initialize"), n19).then(() => {
    e21 && e21();
  });
}
function k8() {
  m32();
}
function v16() {
  f25();
}
function E16(t15) {
  p5(), $2(s6(x8, "getContext"), "getContext", (e21) => {
    e21.frameContext || (e21.frameContext = e11.frameContext), t15(e21);
  });
}
function L7(t15) {
  L3(s6(x8, "registerOnThemeChangeHandlerHelper"), t15);
}
function P12(t15) {
  U5(s6(x8, "registerFullScreenHandler"), "fullScreenChange", t15, []);
}
function I9(t15) {
  U5(s6(x8, "registerAppButtonClickHandler"), "appButtonClick", t15, [a2.content]);
}
function S12(t15) {
  U5(s6(x8, "registerAppButtonHoverEnterHandler"), "appButtonHoverEnter", t15, [a2.content]);
}
function y12(t15) {
  U5(s6(x8, "registerAppButtonHoverLeaveHandler"), "appButtonHoverLeave", t15, [a2.content]);
}
function A14(t15) {
  l13(s6(x8, "registerBackButtonHandler"), t15);
}
function F11(t15) {
  d27(s6(x8, "registerOnLoadHandler"), t15);
}
function T11(t15) {
  c22(s6(x8, "registerBeforeUnloadHandler"), t15);
}
function U7(t15) {
  U5(s6(x8, "registerFocusEnterHandler"), "focusEnter", t15, []);
}
function W3(t15) {
  U5(s6(x8, "registerChangeSettingsHandler"), "changeSettings", t15, [a2.content]);
}
function z5(t15, e21) {
  m7(g3), S6(s6(x8, "getTabInstances"), e21).then((e22) => {
    t15(e22);
  });
}
function D8(t15, e21) {
  m7(g3), k7(s6(x8, "getMruTabInstances"), e21).then((e22) => {
    t15(e22);
  });
}
function O11(t15) {
  U6(s6(x8, "shareDeepLink"), { subPageId: t15.subEntityId, subPageLabel: t15.subEntityLabel, subPageWebUrl: t15.subEntityWebUrl });
}
function M5(t15, e21) {
  m7(g3, a2.content, a2.sidePanel, a2.settings, a2.task, a2.stage, a2.meetingStage);
  const r18 = null != e21 ? e21 : i6();
  O6(s6(x8, "executeDeepLink"), t15).then(() => {
    r18(true);
  }).catch((t16) => {
    r18(false, t16.message);
  });
}
function V7(t15) {
  B3(s6(x8, "setFrameContext"), t15);
}
function q4(e21, n19, r18) {
  k3(s6(x8, "initializeWithFrameContext"), r18).then(() => n19 && n19()), B3(s6(x8, "setFrameContext"), e21);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/navigation.js
var c23 = "v1";
function g15(n19) {
  I5(s6(c23, "navigation.returnFocus"), n19);
}
function l30(t15, a35) {
  m7(g3);
  const i26 = null != a35 ? a35 : i6();
  v9(s6(c23, "navigation.navigateToTab"), t15).then(() => {
    i26(true);
  }).catch((n19) => {
    i26(false, n19.message);
  });
}
function u34(t15, e21) {
  m7(g3, a2.content, a2.sidePanel, a2.settings, a2.remove, a2.task, a2.stage, a2.meetingStage);
  const i26 = null != e21 ? e21 : i6();
  P7(s6(c23, "navigation.navigateCrossDomain"), t15).then(() => {
    i26(true);
  }).catch((n19) => {
    i26(false, n19.message);
  });
}
function f26(t15) {
  m7(g3);
  const e21 = null != t15 ? t15 : i6();
  j9(s6(c23, "navigation.navigateBack")).then(() => {
    e21(true);
  }).catch((n19) => {
    e21(false, n19.message);
  });
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/liveShareHost.js
var liveShareHost_exports = {};
__export(liveShareHost_exports, {
  ContainerState: () => s25,
  LiveShareHost: () => l31,
  UserMeetingRole: () => a23,
  isSupported: () => d28
});
var o19 = "v2";
var a23;
var s25;
function d28() {
  return !(!m7(g3, a2.meetingStage, a2.sidePanel, a2.content) || !g3.supports.interactive);
}
!function(e21) {
  e21.guest = "Guest", e21.attendee = "Attendee", e21.presenter = "Presenter", e21.organizer = "Organizer";
}(a23 || (a23 = {})), function(e21) {
  e21.added = "Added", e21.alreadyExists = "AlreadyExists", e21.conflict = "Conflict", e21.notFound = "NotFound";
}(s25 || (s25 = {}));
var l31 = class _l {
  getFluidTenantInfo() {
    return u35(), new Promise((t15) => {
      t15(P3(s6(o19, "interactive.getFluidTenantInfo"), "interactive.getFluidTenantInfo"));
    });
  }
  getFluidToken(t15) {
    return u35(), new Promise((i26) => {
      i26(P3(s6(o19, "interactive.getFluidToken"), "interactive.getFluidToken", t15));
    });
  }
  getFluidContainerId() {
    return u35(), new Promise((t15) => {
      t15(P3(s6(o19, "interactive.getFluidContainerId"), "interactive.getFluidContainerId"));
    });
  }
  setFluidContainerId(t15) {
    return u35(), new Promise((i26) => {
      i26(P3(s6(o19, "interactive.setFluidContainerId"), "interactive.setFluidContainerId", t15));
    });
  }
  getNtpTime() {
    return u35(), new Promise((t15) => {
      t15(P3(s6(o19, "interactive.getNtpTime"), "interactive.getNtpTime"));
    });
  }
  registerClientId(t15) {
    return u35(), new Promise((i26) => {
      i26(P3(s6(o19, "interactive.registerClientId"), "interactive.registerClientId", t15));
    });
  }
  getClientRoles(t15) {
    return u35(), new Promise((i26) => {
      i26(P3(s6(o19, "interactive.getClientRoles"), "interactive.getClientRoles", t15));
    });
  }
  getClientInfo(t15) {
    return u35(), new Promise((i26) => {
      i26(P3(s6(o19, "interactive.getClientInfo"), "interactive.getClientInfo", t15));
    });
  }
  static create() {
    return u35(), new _l();
  }
};
function u35() {
  if (!d28()) throw new Error("LiveShareHost Not supported");
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/authentication.js
var authentication_exports = {};
__export(authentication_exports, {
  DataResidency: () => v17,
  authenticate: () => k9,
  getAuthToken: () => p37,
  getUser: () => C13,
  notifyFailure: () => g16,
  notifySuccess: () => w20,
  registerAuthenticationHandlers: () => b15
});
var f27 = "v1";
var m33 = "v2";
var d29;
function b15(t15) {
  d29 = t15;
}
function k9(n19) {
  const i26 = void 0 !== n19, r18 = i26 ? n19 : d29;
  if (!r18) throw new Error("No parameters are provided for authentication");
  m7(g3, a2.content, a2.sidePanel, a2.settings, a2.remove, a2.task, a2.stage, a2.meetingStage);
  return function(n20, i27) {
    return n(this, void 0, void 0, function* () {
      const t15 = v2(i27.url);
      return I2(t15), S3(n20, "authentication.authenticate", [t15.href, i27.width, i27.height, i27.isExternal]).then(([t16, e21]) => {
        if (t16) return e21;
        throw new Error(e21);
      });
    });
  }(r18.successCallback || r18.failureCallback ? s6(f27, "authentication.authenticate") : s6(m33, "authentication.authenticate"), r18).then((t15) => {
    try {
      return r18 && r18.successCallback ? (r18.successCallback(t15), "") : t15;
    } finally {
      i26 || (d29 = void 0);
    }
  }).catch((t15) => {
    try {
      if (r18 && r18.failureCallback) return r18.failureCallback(t15.message), "";
      throw t15;
    } finally {
      i26 || (d29 = void 0);
    }
  });
}
function p37(t15) {
  p5();
  return function(t16, n19) {
    return new Promise((i26) => {
      i26(S3(t16, "authentication.getAuthToken", [null == n19 ? void 0 : n19.resources, null == n19 ? void 0 : n19.claims, null == n19 ? void 0 : n19.silent, null == n19 ? void 0 : n19.tenantId]));
    }).then(([t17, e21]) => {
      if (t17) return e21;
      throw new Error(e21);
    });
  }(t15 && (t15.successCallback || t15.failureCallback) ? s6(f27, "authentication.getAuthToken") : s6(m33, "authentication.getAuthToken"), t15).then((e21) => t15 && t15.successCallback ? (t15.successCallback(e21), "") : e21).catch((e21) => {
    if (t15 && t15.failureCallback) return t15.failureCallback(e21.message), "";
    throw e21;
  });
}
function C13(t15) {
  p5();
  return function(t16) {
    return new Promise((n19) => {
      n19(S3(t16, "authentication.getUser"));
    }).then(([t17, e21]) => {
      if (t17) return e21;
      throw e21;
    });
  }(t15 && (t15.successCallback || t15.failureCallback) ? s6(f27, "authentication.getUser") : s6(m33, "authentication.getUser")).then((e21) => t15 && t15.successCallback ? (t15.successCallback(e21), null) : e21).catch((e21) => {
    const n19 = `Error returned, code = ${e21.errorCode}, message = ${e21.message}`;
    if (t15 && t15.failureCallback) return t15.failureCallback(n19), null;
    throw new Error(n19);
  });
}
function w20(t15, e21) {
  m7(g3, a2.authentication);
  const o24 = s6(e21 ? f27 : m33, "authentication.notifySuccess");
  $2(o24, "authentication.authenticate.success", [t15]), ne(I3.parentWindow, () => setTimeout(() => I3.currentWindow.close(), 200));
}
function g16(t15, e21) {
  m7(g3, a2.authentication);
  const o24 = s6(e21 ? f27 : m33, "authentication.notifyFailure");
  $2(o24, "authentication.authenticate.failure", [t15]), ne(I3.parentWindow, () => setTimeout(() => I3.currentWindow.close(), 200));
}
var v17;
!function(t15) {
  t15.Public = "public", t15.EUDB = "eudb", t15.Other = "other";
}(v17 || (v17 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/appInstallDialog.js
var appInstallDialog_exports = {};
__export(appInstallDialog_exports, {
  isSupported: () => s27,
  openAppInstallDialog: () => p39
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/deepLinkConstants.js
var e19 = "/l/app/";
var t13 = "/l/meeting/new";
var s26 = "attendees";
var a24 = "startTime";
var c24 = "endTime";
var n17 = "subject";
var i22 = "content";
var l32 = "/l/call/0/0";
var o20 = "source";
var m34 = "withVideo";
var p38 = "/l/chat/0/0";
var r16 = "users";
var d30 = "topicName";
var u36 = "message";

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/deepLinkUtilities.js
function u37($4, i26, r18) {
  if (0 === $4.length) throw new Error("Must have at least one user when creating a chat deep link");
  const d39 = `${r16}=` + $4.map((n19) => encodeURIComponent(n19)).join(","), a35 = void 0 === i26 ? "" : `&${d30}=${encodeURIComponent(i26)}`, m55 = void 0 === r18 ? "" : `&${u36}=${encodeURIComponent(r18)}`;
  return `${v3}://${y3}${p38}?${d39}${a35}${m55}`;
}
function R9(t15, i26, r18) {
  if (0 === t15.length) throw new Error("Must have at least one target when creating a call deep link");
  const d39 = `${r16}=` + t15.map((n19) => encodeURIComponent(n19)).join(","), p56 = void 0 === i26 ? "" : `&${m34}=${encodeURIComponent(i26)}`, c43 = void 0 === r18 ? "" : `&${o20}=${encodeURIComponent(r18)}`;
  return `${v3}://${y3}${l32}?${d39}${p56}${c43}`;
}
function U8(e21, t15, $4, d39, p56) {
  const c43 = void 0 === e21 ? "" : `${s26}=` + e21.map((n19) => encodeURIComponent(n19)).join(","), a35 = void 0 === t15 ? "" : `&${a24}=${encodeURIComponent(t15)}`, m55 = void 0 === $4 ? "" : `&${c24}=${encodeURIComponent($4)}`, u52 = void 0 === d39 ? "" : `&${n17}=${encodeURIComponent(d39)}`, R12 = void 0 === p56 ? "" : `&${i22}=${encodeURIComponent(p56)}`;
  return `${v3}://${y3}${t13}?${c43}${a35}${m55}${u52}${R12}`;
}
function h21(e21) {
  if (!e21) throw new Error("App ID must be set when creating an app install dialog deep link");
  return `${v3}://${y3}${e19}${encodeURIComponent(e21)}`;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/appInstallDialog.js
function p39(p56) {
  return new Promise((l43) => {
    if (m7(g3, a2.content, a2.sidePanel, a2.settings, a2.task, a2.stage, a2.meetingStage), !s27()) throw new Error("Not supported");
    const m55 = s6("v1", "appInstallDialog.openAppInstallDialog");
    g3.isLegacyTeams ? l43(R3(m55, "executeDeepLink", h21(p56.appId))) : ($2(m55, "appInstallDialog.openAppInstallDialog", [p56]), l43());
  });
}
function s27() {
  return !(!m7(g3) || !g3.supports.appInstallDialog);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/barCode.js
var barCode_exports = {};
__export(barCode_exports, {
  hasPermission: () => p41,
  isSupported: () => d32,
  requestPermission: () => u39,
  scanBarCode: () => f29
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/media.js
var media_exports = {};
__export(media_exports, {
  CameraStartMode: () => _6,
  File: () => U9,
  FileFormat: () => S13,
  ImageOutputFormats: () => F12,
  ImageUriType: () => j15,
  Media: () => x9,
  MediaControllerEvent: () => N10,
  MediaType: () => V8,
  Source: () => B5,
  VideoController: () => J4,
  captureImage: () => G5,
  hasPermission: () => q5,
  requestPermission: () => H9,
  scanBarCode: () => Q3,
  selectMedia: () => $3,
  viewImages: () => K3
});
var L8 = "v1";
var D9 = u5("media");
var S13;
var N10;
var _6;
var B5;
var V8;
var j15;
var F12;
!function(e21) {
  e21.Base64 = "base64", e21.ID = "id";
}(S13 || (S13 = {}));
var U9 = class {
};
function G5(t15) {
  if (!t15) throw new Error("[captureImage] Callback cannot be null");
  if (m7(g3, a2.content, a2.task), e11.isFramelessWindow) if (u10(m4)) $2(s6(L8, "media.captureImage"), "captureImage", t15);
  else {
    t15({ errorCode: E2.OLD_PLATFORM }, []);
  }
  else {
    t15({ errorCode: E2.NOT_SUPPORTED_ON_PLATFORM }, []);
  }
}
function q5() {
  if (m7(g3, a2.content, a2.task), !W4()) throw l;
  const e21 = O2.Media;
  return new Promise((i26) => {
    i26(P3(s6(L8, "media.hasPermission"), "permissions.has", e21));
  });
}
function H9() {
  if (m7(g3, a2.content, a2.task), !W4()) throw l;
  const e21 = O2.Media;
  return new Promise((i26) => {
    i26(P3(s6(L8, "media.requestPermission"), "permissions.request", e21));
  });
}
function W4() {
  return !(!m7(g3) || !g3.supports.permissions);
}
var x9 = class extends U9 {
  constructor(e21) {
    super(), e21 && (this.content = e21.content, this.format = e21.format, this.mimeType = e21.mimeType, this.name = e21.name, this.preview = e21.preview, this.size = e21.size);
  }
  getMedia(e21) {
    if (!e21) throw new Error("[get Media] Callback cannot be null");
    if (m7(g3, a2.content, a2.task), u10(l3)) if (m35(this.mimeType, this.format, this.content)) u10(d5) ? this.getMediaViaCallback(e21) : this.getMediaViaHandler(e21);
    else {
      e21({ errorCode: E2.INVALID_ARGUMENTS }, new Blob());
    }
    else {
      e21({ errorCode: E2.OLD_PLATFORM }, new Blob());
    }
  }
  getMediaViaCallback(t15) {
    const i26 = { mediaMimeType: this.mimeType, assembleAttachment: [] }, n19 = [this.content];
    $2(s6(L8, "media.getMedia"), "getMedia", n19, function(e21) {
      if (t15) if (e21 && e21.error) t15(e21.error, new Blob());
      else if (e21 && e21.mediaChunk) if (e21.mediaChunk.chunkSequence <= 0) {
        const n20 = u38(i26.assembleAttachment, i26.mediaMimeType);
        t15(e21.error, null != n20 ? n20 : new Blob());
      } else {
        const t16 = i23(e21.mediaChunk, i26.mediaMimeType);
        t16 ? i26.assembleAttachment.push(t16) : D9(`Received a null assemble attachment for when decoding chunk sequence ${e21.mediaChunk.chunkSequence}; not including the chunk in the assembled file.`);
      }
      else t15({ errorCode: E2.INTERNAL_ERROR, message: "data received is null" }, new Blob());
    });
  }
  getMediaViaHandler(t15) {
    const i26 = u3(), n19 = { mediaMimeType: this.mimeType, assembleAttachment: [] }, o24 = [i26, this.content];
    this.content && !n13(t15) && $2(s6(L8, "media.getMedia"), "getMedia", o24), p10(s6(L8, "media.registerGetMediaRequestHandler"), "getMedia" + i26, function(e21) {
      if (t15) {
        const o25 = JSON.parse(e21);
        if (o25.error) t15(o25.error, new Blob()), g6("getMedia" + i26);
        else if (o25.mediaChunk) if (o25.mediaChunk.chunkSequence <= 0) {
          const e22 = u38(n19.assembleAttachment, n19.mediaMimeType);
          t15(o25.error, null != e22 ? e22 : new Blob()), g6("getMedia" + i26);
        } else {
          const e22 = i23(o25.mediaChunk, n19.mediaMimeType);
          e22 && n19.assembleAttachment.push(e22);
        }
        else t15({ errorCode: E2.INTERNAL_ERROR, message: "data received is null" }, new Blob()), g6("getMedia" + i26);
      }
    });
  }
};
var z6 = class {
  constructor(e21) {
    this.controllerCallback = e21;
  }
  notifyEventToHost(t15, i26) {
    m7(g3, a2.content, a2.task);
    try {
      h7(e10);
    } catch (e21) {
      return void (i26 && i26(e21));
    }
    const n19 = { mediaType: this.getMediaType(), mediaControllerEvent: t15 };
    $2(s6(L8, "media.controller"), "media.controller", [n19], (e21) => {
      i26 && i26(e21);
    });
  }
  stop(e21) {
    this.notifyEventToHost(N10.StopRecording, e21);
  }
};
var J4 = class extends z6 {
  getMediaType() {
    return V8.Video;
  }
  notifyEventToApp(e21) {
    if (this.controllerCallback) switch (e21) {
      case N10.StartRecording:
        if (this.controllerCallback.onRecordingStarted) {
          this.controllerCallback.onRecordingStarted();
          break;
        }
    }
  }
};
function $3(t15, i26) {
  if (!i26) throw new Error("[select Media] Callback cannot be null");
  if (m7(g3, a2.content, a2.task), !u10(l3)) {
    const e21 = { errorCode: E2.OLD_PLATFORM };
    return void i26(e21, []);
  }
  try {
    c25(t15);
  } catch (e21) {
    return void i26(e21, []);
  }
  if (!f28(t15)) {
    const e21 = { errorCode: E2.INVALID_ARGUMENTS };
    return void i26(e21, []);
  }
  const o24 = [t15];
  $2(s6(L8, "media.selectMedia"), "selectMedia", o24, (e21, n19, o25) => {
    var r18, a35;
    if (o25) return void (a25(t15) && (null === (a35 = null === (r18 = null == t15 ? void 0 : t15.videoProps) || void 0 === r18 ? void 0 : r18.videoController) || void 0 === a35 || a35.notifyEventToApp(o25)));
    if (!n19) return void i26(e21, []);
    const s38 = [];
    for (const e22 of n19) s38.push(new x9(e22));
    i26(e21, s38);
  });
}
function K3(t15, i26) {
  if (!i26) throw new Error("[view images] Callback cannot be null");
  if (m7(g3, a2.content, a2.task), !u10(l3)) {
    return void i26({ errorCode: E2.OLD_PLATFORM });
  }
  if (!I10(t15)) {
    return void i26({ errorCode: E2.INVALID_ARGUMENTS });
  }
  const o24 = [t15];
  $2(s6(L8, "media.viewImages"), "viewImages", o24, i26);
}
function Q3(t15, i26) {
  if (!t15) throw new Error("[media.scanBarCode] Callback cannot be null");
  if (m7(g3, a2.content, a2.task), e11.hostClientType !== o4.desktop && e11.hostClientType !== o4.web && e11.hostClientType !== o4.rigel && e11.hostClientType !== o4.teamsRoomsWindows && e11.hostClientType !== o4.teamsRoomsAndroid && e11.hostClientType !== o4.teamsPhones && e11.hostClientType !== o4.teamsDisplays) if (u10(h3)) if (v18(i26)) $2(s6(L8, "media.scanBarCode"), "media.scanBarCode", [i26], t15);
  else {
    t15({ errorCode: E2.INVALID_ARGUMENTS }, "");
  }
  else {
    t15({ errorCode: E2.OLD_PLATFORM }, "");
  }
  else {
    t15({ errorCode: E2.NOT_SUPPORTED_ON_PLATFORM }, "");
  }
}
!function(e21) {
  e21[e21.StartRecording = 1] = "StartRecording", e21[e21.StopRecording = 2] = "StopRecording";
}(N10 || (N10 = {})), function(e21) {
  e21[e21.Photo = 1] = "Photo", e21[e21.Document = 2] = "Document", e21[e21.Whiteboard = 3] = "Whiteboard", e21[e21.BusinessCard = 4] = "BusinessCard";
}(_6 || (_6 = {})), function(e21) {
  e21[e21.Camera = 1] = "Camera", e21[e21.Gallery = 2] = "Gallery";
}(B5 || (B5 = {})), function(e21) {
  e21[e21.Image = 1] = "Image", e21[e21.Video = 2] = "Video", e21[e21.VideoAndImage = 3] = "VideoAndImage", e21[e21.Audio = 4] = "Audio";
}(V8 || (V8 = {})), function(e21) {
  e21[e21.ID = 1] = "ID", e21[e21.URL = 2] = "URL";
}(j15 || (j15 = {})), function(e21) {
  e21[e21.IMAGE = 1] = "IMAGE", e21[e21.PDF = 2] = "PDF";
}(F12 || (F12 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/mediaUtil.js
function u38(e21, n19) {
  if (null == e21 || null == n19 || e21.length <= 0) return null;
  let t15 = null, r18 = 1;
  return e21.sort((e22, n20) => e22.sequence > n20.sequence ? 1 : -1), e21.forEach((e22) => {
    e22.sequence == r18 && (t15 = t15 ? new Blob([t15, e22.file], { type: n19 }) : new Blob([e22.file], { type: n19 }), r18++);
  }), t15;
}
function i23(e21, n19) {
  if (null == e21 || null == n19) return null;
  const t15 = atob(e21.chunk), r18 = new Array(t15.length);
  for (let e22 = 0; e22 < t15.length; e22++) r18[e22] = t15.charCodeAt(e22);
  const l43 = new Uint8Array(r18), o24 = new Blob([l43], { type: n19 });
  return { sequence: e21.chunkSequence, file: o24 };
}
function c25(e21) {
  s28(e21) ? h7(s7) : p40(e21) ? h7(e10) : d31(e21) && h7(n11);
}
function a25(n19) {
  return !(n19.mediaType != V8.Video || !n19.videoProps || !n19.videoProps.videoController);
}
function f28(e21) {
  return !(null == e21 || e21.maxMediaCount > 10);
}
function d31(n19) {
  var t15;
  return !((null == n19 ? void 0 : n19.mediaType) != V8.Image || !(null === (t15 = null == n19 ? void 0 : n19.imageProps) || void 0 === t15 ? void 0 : t15.imageOutputFormats));
}
function s28(n19) {
  return !(!n19 || n19.mediaType != V8.VideoAndImage && !n19.videoAndImageProps);
}
function p40(n19) {
  return !(!n19 || n19.mediaType != V8.Video || !n19.videoProps || n19.videoProps.isFullScreenMode);
}
function m35(e21, t15, r18) {
  return null != e21 && null != t15 && t15 == S13.ID && null != r18;
}
function I10(e21) {
  return !(null == e21 || e21.length <= 0 || e21.length > 10);
}
function v18(e21) {
  return !e21 || !(null === e21.timeOutIntervalInSec || null != e21.timeOutIntervalInSec && e21.timeOutIntervalInSec <= 0 || null != e21.timeOutIntervalInSec && e21.timeOutIntervalInSec > 60);
}
function g17(e21) {
  if (e21) {
    if (e21.title && "string" != typeof e21.title) return false;
    if (e21.setSelected && "object" != typeof e21.setSelected) return false;
    if (e21.openOrgWideSearchInChatOrChannel && "boolean" != typeof e21.openOrgWideSearchInChatOrChannel) return false;
    if (e21.singleSelect && "boolean" != typeof e21.singleSelect) return false;
  }
  return true;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/barCode.js
var c26 = "v2";
function f29(m55) {
  return new Promise((f46) => {
    if (m7(g3, a2.content, a2.task), !d32()) throw l;
    if (!v18(m55)) throw { errorCode: E2.INVALID_ARGUMENTS };
    f46(P3(s6(c26, "barCode.scanBarCode"), "media.scanBarCode", m55));
  });
}
function p41() {
  if (m7(g3, a2.content, a2.task), !d32()) throw l;
  const t15 = O2.Media;
  return new Promise((o24) => {
    o24(P3(s6(c26, "barCode.hasPermission"), "permissions.has", t15));
  });
}
function u39() {
  if (m7(g3, a2.content, a2.task), !d32()) throw l;
  const t15 = O2.Media;
  return new Promise((o24) => {
    o24(P3(s6(c26, "barCode.requestPermission"), "permissions.request", t15));
  });
}
function d32() {
  return !!(m7(g3) && g3.supports.barCode && g3.supports.permissions);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/chat.js
var chat_exports = {};
__export(chat_exports, {
  isSupported: () => u40,
  openChat: () => a26,
  openGroupChat: () => c27
});
function a26(e21) {
  return m36(s6("v2", "chat.openChat"), e21);
}
function m36(r18, a35) {
  return new Promise((m55) => {
    if (m7(g3, a2.content, a2.task), !u40()) throw l;
    if (g3.isLegacyTeams) m55(R3(r18, "executeDeepLink", u37([a35.user], void 0, a35.message)));
    else {
      m55(R3(r18, "chat.openChat", { members: [a35.user], message: a35.message }));
    }
  });
}
function c27(a35) {
  const c43 = s6("v2", "chat.openGroupChat");
  return new Promise((r18) => {
    if (a35.users.length < 1) throw Error("OpenGroupChat Failed: No users specified");
    if (1 === a35.users.length) {
      const e21 = { user: a35.users[0], message: a35.message };
      r18(m36(c43, e21));
    } else {
      if (m7(g3, a2.content, a2.task), !u40()) throw l;
      if (g3.isLegacyTeams) r18(R3(c43, "executeDeepLink", u37(a35.users, a35.topic, a35.message)));
      else {
        r18(R3(c43, "chat.openChat", { members: a35.users, message: a35.message, topic: a35.topic }));
      }
    }
  });
}
function u40() {
  return !(!m7(g3) || !g3.supports.chat);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/clipboard.js
var clipboard_exports = {};
__export(clipboard_exports, {
  isSupported: () => u41,
  read: () => d33,
  write: () => c28
});
function c28(e21) {
  return n(this, void 0, void 0, function* () {
    if (m7(g3, a2.content, a2.meetingStage, a2.task, a2.settings, a2.stage, a2.sidePanel), !u41()) throw l;
    if (!e21.type || !Object.values(_2).includes(e21.type)) throw new Error(`Blob type ${e21.type} is not supported. Supported blob types are ${Object.values(_2)}`);
    const t15 = yield g2(e21), s38 = { mimeType: e21.type, content: t15 };
    return P3(s6("v2", "clipboard.write"), "clipboard.writeToClipboard", s38);
  });
}
function d33() {
  return n(this, void 0, void 0, function* () {
    m7(g3, a2.content, a2.meetingStage, a2.task, a2.settings, a2.stage, a2.sidePanel);
    const t15 = s6("v2", "clipboard.read");
    if (!u41()) throw l;
    const e21 = yield P3(t15, "clipboard.readFromClipboard");
    if ("string" == typeof e21) {
      const t16 = JSON.parse(e21);
      return b2(t16.mimeType, t16.content);
    }
    return e21;
  });
}
function u41() {
  return e11.isFramelessWindow ? !(!m7(g3) || !g3.supports.clipboard) : !!(m7(g3) && navigator && navigator.clipboard && g3.supports.clipboard);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/nestedAppAuth.js
var nestedAppAuth_exports = {};
__export(nestedAppAuth_exports, {
  addNAATrustedOrigins: () => g18,
  canParentManageNAATrustedOrigins: () => A15,
  deleteNAATrustedOrigins: () => w21,
  getParentOrigin: () => f30,
  isDeeplyNestedAuthSupported: () => v19,
  isNAAChannelRecommended: () => h22
});
var c29 = "v2";
var d34 = { validate: (n19) => Array.isArray(n19) || "object" == typeof n19, deserialize: (n19) => n19 };
var m37;
function h22() {
  var n19;
  return null !== (n19 = m7(g3) && (g3.isNAAChannelRecommended || !!(m7(g3) && y13() && g3.isLegacyTeams && g3.supports.nestedAppAuth))) && void 0 !== n19 && n19;
}
function f30() {
  return m7(g3), I3.parentOrigin;
}
function A15() {
  var n19;
  return null !== (n19 = m7(g3) && g3.canParentManageNAATrustedOrigins) && void 0 !== n19 && n19;
}
function v19() {
  var n19;
  return null !== (n19 = m7(g3) && (g3.isDeeplyNestedAuthSupported || !!(m7(g3) && y13() && g3.isLegacyTeams && u10(T4)))) && void 0 !== n19 && n19;
}
function y13() {
  return e11.hostClientType === o4.android || e11.hostClientType === o4.ios || e11.hostClientType === o4.ipados || e11.hostClientType === o4.visionOS;
}
function g18(r18) {
  return n(this, void 0, void 0, function* () {
    if (!A15()) throw l;
    const n19 = r18.map(E17);
    return T12(m37.ADD, n19);
  });
}
function w21(r18) {
  return n(this, void 0, void 0, function* () {
    if (!A15()) throw l;
    const n19 = r18.map(E17);
    return T12(m37.DELETE, n19);
  });
}
function T12(r18, i26) {
  return n(this, void 0, void 0, function* () {
    if (window.parent !== window.top) throw new Error("This API is only available in the top-level parent.");
    if (!Array.isArray(i26) || 0 === i26.length) throw new Error(`The '${i26}' parameter is required and must be a non-empty array.`);
    const n19 = [new D10(r18, i26)];
    return N4("nestedAppAuth.manageNAATrustedOrigins", n19, d34, s6(c29, "nestedAppAuth.manageNAATrustedOrigins"));
  });
}
function E17(n19) {
  try {
    return new URL(n19).origin.toLowerCase();
  } catch (r18) {
    throw new Error(`Invalid origin provided: ${n19}`);
  }
}
!function(n19) {
  n19.ADD = "ADD", n19.DELETE = "DELETE";
}(m37 || (m37 = {}));
var D10 = class {
  constructor(n19, r18) {
    this.action = n19, this.appOrigins = r18;
  }
  serialize() {
    return { action: this.action, appOrigins: this.appOrigins };
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/geoLocation/geoLocation.js
var geoLocation_exports = {};
__export(geoLocation_exports, {
  getCurrentLocation: () => c31,
  hasPermission: () => p42,
  isSupported: () => u42,
  map: () => map_exports,
  requestPermission: () => f31
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/geoLocation/map.js
var map_exports = {};
__export(map_exports, {
  chooseLocation: () => a27,
  isSupported: () => m38,
  showLocation: () => c30
});
function a27() {
  if (m7(g3, a2.content, a2.task), !m38()) throw l;
  return P3(s6("v2", "geoLocation.map.chooseLocation"), "location.getLocation", { allowChooseLocation: true, showMap: true });
}
function c30(a35) {
  if (m7(g3, a2.content, a2.task), !m38()) throw l;
  if (!a35) throw { errorCode: E2.INVALID_ARGUMENTS };
  return P3(s6("v2", "geoLocation.showLocation"), "location.showLocation", a35);
}
function m38() {
  return !!(m7(g3) && g3.supports.geoLocation && g3.supports.geoLocation.map && g3.supports.permissions);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/geoLocation/geoLocation.js
var m39 = "v2";
function c31() {
  if (m7(g3, a2.content, a2.task), !u42()) throw l;
  return P3(s6(m39, "geoLocation.getCurrentLocation"), "location.getLocation", { allowChooseLocation: false, showMap: false });
}
function p42() {
  if (m7(g3, a2.content, a2.task), !u42()) throw l;
  const a35 = O2.GeoLocation;
  return new Promise((t15) => {
    t15(P3(s6(m39, "geoLocation.hasPermission"), "permissions.has", a35));
  });
}
function f31() {
  if (m7(g3, a2.content, a2.task), !u42()) throw l;
  const a35 = O2.GeoLocation;
  return new Promise((t15) => {
    t15(P3(s6(m39, "geoLocation.requestPermission"), "permissions.request", a35));
  });
}
function u42() {
  return !!(m7(g3) && g3.supports.geoLocation && g3.supports.permissions);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/secondaryBrowser.js
var secondaryBrowser_exports = {};
__export(secondaryBrowser_exports, {
  isSupported: () => l33,
  open: () => a28
});
function a28(a35) {
  if (m7(g3, a2.content), !l33()) throw l;
  if (!a35 || !h2(a35)) throw { errorCode: E2.INVALID_ARGUMENTS, message: "Invalid Url: Only https URL is allowed" };
  return P3(s6("v2", "secondaryBrowser.openUrl"), "secondaryBrowser.open", a35.toString());
}
function l33() {
  return !(!m7(g3) || !g3.supports.secondaryBrowser);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/location.js
var location_exports = {};
__export(location_exports, {
  getLocation: () => s29,
  isSupported: () => m40,
  showLocation: () => f32
});
function s29(s38, f46) {
  if (!f46) throw new Error("[location.getLocation] Callback cannot be null");
  if (m7(g3, a2.content, a2.task), !u10(a5)) throw { errorCode: E2.OLD_PLATFORM };
  if (!s38) throw { errorCode: E2.INVALID_ARGUMENTS };
  if (!m40()) throw l;
  $2(s6("v1", "location.getLocation"), "location.getLocation", [s38], f46);
}
function f32(s38, f46) {
  if (!f46) throw new Error("[location.showLocation] Callback cannot be null");
  if (m7(g3, a2.content, a2.task), !u10(a5)) throw { errorCode: E2.OLD_PLATFORM };
  if (!s38) throw { errorCode: E2.INVALID_ARGUMENTS };
  if (!m40()) throw l;
  $2(s6("v1", "location.showLocation"), "location.showLocation", [s38], f46);
}
function m40() {
  return !(!m7(g3) || !g3.supports.location);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/meeting/meeting.js
var meeting_exports = {};
__export(meeting_exports, {
  CallType: () => C14,
  EventActionSource: () => f33,
  MeetingReactionType: () => p43,
  MeetingType: () => h23,
  SharingProtocol: () => S14,
  appShareButton: () => appShareButton_exports,
  getAppContentStageSharingCapabilities: () => j16,
  getAppContentStageSharingState: () => T13,
  getAuthenticationTokenForAnonymousUser: () => H10,
  getIncomingClientAudioState: () => b16,
  getLiveStreamState: () => k10,
  getMeetingDetails: () => w22,
  getMeetingDetailsVerbose: () => v20,
  joinMeeting: () => R10,
  registerLiveStreamChangedHandler: () => E18,
  registerMeetingReactionReceivedHandler: () => O12,
  registerRaiseHandStateChangedHandler: () => y14,
  registerSpeakingStateChangeHandler: () => D11,
  requestAppAudioHandling: () => I11,
  requestStartLiveStreaming: () => _7,
  requestStopLiveStreaming: () => M6,
  shareAppContentToStage: () => P13,
  stopSharingAppContentToStage: () => q6,
  toggleIncomingClientAudio: () => A16,
  updateMicState: () => U10
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/meeting/appShareButton.js
var appShareButton_exports = {};
__export(appShareButton_exports, {
  setOptions: () => i24
});
function i24(i26) {
  m7(g3, a2.sidePanel), i26.contentUrl && new URL(i26.contentUrl), $2(s6("v1", "meeting.appShareButton.setOptions"), "meeting.appShareButton.setOptions", [i26]);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/meeting/meeting.js
var u43 = "v1";
var m41;
var p43;
var h23;
var C14;
var S14;
var f33;
function b16(e21) {
  if (!e21) throw new Error("[get incoming client audio state] Callback cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage), $2(s6(u43, "meeting.getIncomingClientAudioState"), "getIncomingClientAudioState", e21);
}
function A16(e21) {
  if (!e21) throw new Error("[toggle incoming client audio] Callback cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage), $2(s6(u43, "meeting.toggleIncomingClientAudio"), "toggleIncomingClientAudio", e21);
}
function w22(e21) {
  if (!e21) throw new Error("[get meeting details] Callback cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage, a2.settings, a2.content), $2(s6(u43, "meeting.getMeetingDetails"), "meeting.getMeetingDetails", e21);
}
function v20() {
  var n19, i26, a35;
  return n(this, void 0, void 0, function* () {
    let e21;
    m7(g3, a2.sidePanel, a2.meetingStage, a2.settings, a2.content);
    try {
      const n20 = true;
      e21 = yield P3(s6("v2", "meeting.getMeetingDetailsVerbose"), "meeting.getMeetingDetails", n20);
    } catch (e22) {
      throw new Error(null === (n19 = null == e22 ? void 0 : e22.errorCode) || void 0 === n19 ? void 0 : n19.toString());
    }
    if (((null === (i26 = e21.details) || void 0 === i26 ? void 0 : i26.type) == C14.GroupCall || (null === (a35 = e21.details) || void 0 === a35 ? void 0 : a35.type) == C14.OneOnOneCall) && !e21.details.originalCallerInfo) throw new Error(E2.NOT_SUPPORTED_ON_PLATFORM.toString());
    return e21;
  });
}
function H10(e21) {
  if (!e21) throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage, a2.task), $2(s6(u43, "meeting.getAuthenticationTokenForAnonymousUser"), "meeting.getAuthenticationTokenForAnonymousUser", e21);
}
function k10(e21) {
  if (!e21) throw new Error("[get live stream state] Callback cannot be null");
  m7(g3, a2.sidePanel), $2(s6(u43, "meeting.getLiveStreamState"), "meeting.getLiveStreamState", e21);
}
function _7(e21, t15, i26) {
  if (!e21) throw new Error("[request start live streaming] Callback cannot be null");
  m7(g3, a2.sidePanel), $2(s6(u43, "meeting.requestStartLiveStreaming"), "meeting.requestStartLiveStreaming", [t15, i26], e21);
}
function M6(e21) {
  if (!e21) throw new Error("[request stop live streaming] Callback cannot be null");
  m7(g3, a2.sidePanel), $2(s6(u43, "meeting.requestStopLiveStreaming"), "meeting.requestStopLiveStreaming", e21);
}
function E18(e21) {
  if (!e21) throw new Error("[register live stream changed handler] Handler cannot be null");
  m7(g3, a2.sidePanel), p10(s6(u43, "meeting.registerLiveStreamChangedHandler"), "meeting.liveStreamChanged", e21);
}
function P13(e21, t15, i26 = { sharingProtocol: S14.Collaborative }) {
  if (!e21) throw new Error("[share app content to stage] Callback cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage), $2(s6(u43, "meeting.shareAppContentToStage"), "meeting.shareAppContentToStage", [t15, i26], e21);
}
function j16(e21) {
  if (!e21) throw new Error("[get app content stage sharing capabilities] Callback cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage), $2(s6(u43, "meeting.getAppContentStageSharingCapabilities"), "meeting.getAppContentStageSharingCapabilities", e21);
}
function q6(e21) {
  if (!e21) throw new Error("[stop sharing app content to stage] Callback cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage), $2(s6(u43, "meeting.stopSharingAppContentToStage"), "meeting.stopSharingAppContentToStage", e21);
}
function T13(e21) {
  if (!e21) throw new Error("[get app content stage sharing state] Callback cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage), $2(s6(u43, "meeting.getAppContentStageSharingState"), "meeting.getAppContentStageSharingState", e21);
}
function D11(e21) {
  if (!e21) throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage), p10(s6(u43, "meeting.registerSpeakingStateChangeHandler"), "meeting.speakingStateChanged", e21);
}
function y14(e21) {
  if (!e21) throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage), p10(s6(u43, "meeting.registerRaiseHandStateChangedHandler"), "meeting.raiseHandStateChanged", e21);
}
function O12(e21) {
  if (!e21) throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage), p10(s6(u43, "meeting.registerMeetingReactionReceivedHandler"), "meeting.meetingReactionReceived", e21);
}
function R10(e21) {
  if (void 0 === (null == e21 ? void 0 : e21.joinWebUrl) || null === (null == e21 ? void 0 : e21.joinWebUrl)) return Promise.reject(new Error("Invalid joinMeetingParams"));
  m7(g3);
  const n19 = { joinWebUrl: e21.joinWebUrl.href, source: e21.source || f33.Other };
  return P3(s6("v2", "meeting.joinMeeting"), "meeting.joinMeeting", n19);
}
function I11(t15, s38) {
  if (!s38) throw new Error("[requestAppAudioHandling] Callback response cannot be null");
  if (!t15.micMuteStateChangedCallback) throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");
  m7(g3, a2.sidePanel, a2.meetingStage), t15.isAppHandlingAudio ? function(t16, a35) {
    const o24 = (n19, o25) => {
      if (n19 && null != o25) throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");
      if (n19) throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${n19.errorCode} ${n19.message}`);
      if ("boolean" != typeof o25) throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");
      const r18 = (n20) => n(this, void 0, void 0, function* () {
        try {
          const e21 = yield t16.micMuteStateChangedCallback(n20);
          F13(e21, e21.isMicMuted === n20.isMicMuted ? m41.HostInitiated : m41.AppDeclinedToChange);
        } catch (e21) {
          F13(n20, m41.AppFailedToChange);
        }
      });
      p10(s6(u43, "meeting.registerMicStateChangeHandler"), "meeting.micStateChanged", r18);
      const g23 = (e21) => {
        var n20;
        null === (n20 = t16.audioDeviceSelectionChangedCallback) || void 0 === n20 || n20.call(t16, e21);
      };
      p10(s6(u43, "meeting.registerAudioDeviceSelectionChangedHandler"), "meeting.audioDeviceSelectionChanged", g23), a35(o25);
    };
    $2(s6(u43, "meeting.requestAppAudioHandling"), "meeting.requestAppAudioHandling", [t16.isAppHandlingAudio], o24);
  }(t15, s38) : function(e21, t16) {
    const i26 = (e22, n19) => {
      if (e22 && null != n19) throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");
      if (e22) throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${e22.errorCode} ${e22.message}`);
      if ("boolean" != typeof n19) throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");
      b8("meeting.micStateChanged") && g6("meeting.micStateChanged"), b8("meeting.audioDeviceSelectionChanged") && g6("meeting.audioDeviceSelectionChanged"), t16(n19);
    };
    $2(s6(u43, "meeting.requestAppAudioHandling"), "meeting.requestAppAudioHandling", [e21.isAppHandlingAudio], i26);
  }(t15, s38);
}
function U10(e21) {
  F13(e21, m41.AppInitiated);
}
function F13(e21, t15) {
  m7(g3, a2.sidePanel, a2.meetingStage), $2(s6(u43, "meeting.setMicStateWithReason"), "meeting.updateMicState", [e21, t15]);
}
!function(e21) {
  e21[e21.HostInitiated = 0] = "HostInitiated", e21[e21.AppInitiated = 1] = "AppInitiated", e21[e21.AppDeclinedToChange = 2] = "AppDeclinedToChange", e21[e21.AppFailedToChange = 3] = "AppFailedToChange";
}(m41 || (m41 = {})), function(e21) {
  e21.like = "like", e21.heart = "heart", e21.laugh = "laugh", e21.surprised = "surprised", e21.applause = "applause";
}(p43 || (p43 = {})), function(e21) {
  e21.Unknown = "Unknown", e21.Adhoc = "Adhoc", e21.Scheduled = "Scheduled", e21.Recurring = "Recurring", e21.Broadcast = "Broadcast", e21.MeetNow = "MeetNow";
}(h23 || (h23 = {})), function(e21) {
  e21.OneOnOneCall = "oneOnOneCall", e21.GroupCall = "groupCall";
}(C14 || (C14 = {})), function(e21) {
  e21.Collaborative = "Collaborative", e21.ScreenShare = "ScreenShare";
}(S14 || (S14 = {})), function(e21) {
  e21.M365CalendarGridContextMenu = "m365_calendar_grid_context_menu", e21.M365CalendarGridPeek = "m365_calendar_grid_peek", e21.M365CalendarGridEventCardJoinButton = "m365_calendar_grid_event_card_join_button", e21.M365CalendarFormRibbonJoinButton = "m365_calendar_form_ribbon_join_button", e21.M365CalendarFormJoinTeamsMeetingButton = "m365_calendar_form_join_teams_meeting_button", e21.Other = "other";
}(f33 || (f33 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/monetization.js
var monetization_exports = {};
__export(monetization_exports, {
  isSupported: () => s30,
  openPurchaseExperience: () => p44
});
function p44(p56, a35) {
  let c43, u52, f46 = "";
  "function" == typeof p56 ? (c43 = p56, u52 = a35, f46 = s6("v1", "monetization.openPurchaseExperience")) : (u52 = p56, f46 = s6("v2", "monetization.openPurchaseExperience"));
  return m7(g3, a2.content), f3(() => new Promise((t15) => {
    if (!s30()) throw l;
    t15(P3(f46, "monetization.openPurchaseExperience", u52));
  }), c43);
}
function s30() {
  return !(!m7(g3) || !g3.supports.monetization);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/calendar.js
var calendar_exports = {};
__export(calendar_exports, {
  composeMeeting: () => a29,
  isSupported: () => s31,
  openCalendarItem: () => m42
});
function m42(t15) {
  return new Promise((m55) => {
    if (m7(g3, a2.content), !s31()) throw new Error("Not supported");
    if (!t15.itemId || !t15.itemId.trim()) throw new Error("Must supply an itemId to openCalendarItem");
    m55(R3(s6("v2", "calendar.openCalendarItem"), "calendar.openCalendarItem", t15));
  });
}
function a29(m55) {
  return new Promise((a35) => {
    if (m7(g3, a2.content), !s31()) throw new Error("Not supported");
    const p56 = s6("v2", "calendar.composeMeeting");
    g3.isLegacyTeams ? a35(R3(p56, "executeDeepLink", U8(m55.attendees, m55.startTime, m55.endTime, m55.subject, m55.content))) : a35(R3(p56, "calendar.composeMeeting", m55));
  });
}
function s31() {
  return !(!m7(g3) || !g3.supports.calendar);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/mail/mail.js
var mail_exports = {};
__export(mail_exports, {
  ComposeMailType: () => a30,
  composeMail: () => p45,
  handoff: () => handoff_exports,
  isSupported: () => l34,
  openMailItem: () => m44
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/mail/handoff.js
var handoff_exports = {};
__export(handoff_exports, {
  composeMailWithHandoff: () => m43,
  isSupported: () => f34
});
function s32(o24) {
  o24 && 0 !== o24.length && o24.forEach((o25) => {
    e18(o25);
  });
}
function m43(t15) {
  if (m7(g3, a2.content), !f34()) throw new Error("Not supported");
  return function(o24) {
    if (!o24.handoffId || 0 == o24.handoffId.trim().length || "" === o24.handoffId.trim()) throw new Error("handoffId should not be null or empty string.");
    const t16 = o24.composeMailParams;
    t16.type === a30.New && (s32(t16.toRecipients), s32(t16.ccRecipients), s32(t16.bccRecipients));
  }(t15), A3("mail.handoff.composeMail", [new c32(t15)], s6("v2", "mail.handoff.composeMail"));
}
function f34() {
  return !!(m7(g3) && g3.supports.mail && g3.supports.mail.handoff);
}
var c32 = class {
  constructor(o24) {
    this.composeMailParamsWithHandoff = o24;
  }
  serialize() {
    return this.composeMailParamsWithHandoff;
  }
};

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/mail/mail.js
function m44(i26) {
  return new Promise((m55) => {
    if (m7(g3, a2.content), !l34()) throw new Error("Not supported");
    if (!i26.itemId || !i26.itemId.trim()) throw new Error("Must supply an itemId to openMailItem");
    m55(R3(s6("v2", "mail.openMailItem"), "mail.openMailItem", i26));
  });
}
function p45(i26) {
  return new Promise((m55) => {
    if (m7(g3, a2.content), !l34()) throw new Error("Not supported");
    m55(R3(s6("v2", "mail.composeMail"), "mail.composeMail", i26));
  });
}
function l34() {
  return !(!m7(g3) || !g3.supports.mail);
}
var a30;
!function(r18) {
  r18.New = "new", r18.Reply = "reply", r18.ReplyAll = "replyAll", r18.Forward = "forward";
}(a30 || (a30 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/people.js
var people_exports = {};
__export(people_exports, {
  isSupported: () => u44,
  selectPeople: () => a31
});
function a31(t15, e21) {
  let o24, n19;
  m7(g3, a2.content, a2.task, a2.settings);
  let p56 = "";
  return "function" == typeof t15 ? ([o24, n19] = [t15, e21], p56 = s6("v1", "people.selectPeople")) : (n19 = t15, p56 = s6("v2", "people.selectPeople")), a4(c33, o24, p56, n19);
}
function c33(r18, i26) {
  return new Promise((s38) => {
    if (!u10(r8)) throw { errorCode: E2.OLD_PLATFORM };
    if (!g17(i26)) throw { errorCode: E2.INVALID_ARGUMENTS };
    if (!u44()) throw l;
    s38(P3(r18, "people.selectPeople", i26));
  });
}
function u44() {
  return !(!m7(g3) || !g3.supports.people);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/profile.js
var profile_exports = {};
__export(profile_exports, {
  isSupported: () => l35,
  showProfile: () => s33
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/profileUtil.js
function e20(e21) {
  return e21 ? e21.modality && "string" != typeof e21.modality ? [false, "modality must be a string"] : e21.targetElementBoundingRect && "object" == typeof e21.targetElementBoundingRect ? e21.triggerType && "string" == typeof e21.triggerType ? function(e22) {
    if (!e22) return [false, "persona object must be provided"];
    if (e22.displayName && "string" != typeof e22.displayName) return [false, "displayName must be a string"];
    if (!e22.identifiers || "object" != typeof e22.identifiers) return [false, "persona identifiers object must be provided"];
    if (!e22.identifiers.AadObjectId && !e22.identifiers.Smtp && !e22.identifiers.Upn) return [false, "at least one valid identifier must be provided"];
    if (e22.identifiers.AadObjectId && "string" != typeof e22.identifiers.AadObjectId) return [false, "AadObjectId identifier must be a string"];
    if (e22.identifiers.Smtp && "string" != typeof e22.identifiers.Smtp) return [false, "Smtp identifier must be a string"];
    if (e22.identifiers.Upn && "string" != typeof e22.identifiers.Upn) return [false, "Upn identifier must be a string"];
    return [true, void 0];
  }(e21.persona) : [false, "triggerType must be a valid string"] : [false, "targetElementBoundingRect must be a DOMRect"] : [false, "A request object is required"];
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/profile.js
function s33(s38) {
  return m7(g3, a2.content), new Promise((e21) => {
    const [n19, m55] = e20(s38);
    if (!n19) throw { errorCode: E2.INVALID_ARGUMENTS, message: m55 };
    const l43 = { modality: s38.modality, persona: s38.persona, triggerType: s38.triggerType, targetRectangle: { x: s38.targetElementBoundingRect.x, y: s38.targetElementBoundingRect.y, width: s38.targetElementBoundingRect.width, height: s38.targetElementBoundingRect.height } };
    e21(P3(s6("v2", "profile.showProfile"), "profile.showProfile", l43));
  });
}
function l35() {
  return !(!m7(g3) || !g3.supports.profile);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/search.js
var search_exports = {};
__export(search_exports, {
  closeSearch: () => g19,
  isSupported: () => d35,
  registerHandlers: () => f35,
  unregisterHandlers: () => p46
});
var h24 = "v2";
var m45 = "search.queryChange";
var u45 = "search.queryClose";
var l36 = "search.queryExecute";
function f35(r18, e21, t15) {
  if (m7(g3, a2.content), !d35()) throw l;
  p10(s6(h24, "search.registerOnClosedHandler"), u45, r18), p10(s6(h24, "search.registerOnExecutedHandler"), l36, e21), t15 && p10(s6(h24, "search.registerOnChangeHandler"), m45, t15);
}
function p46() {
  if (m7(g3, a2.content), !d35()) throw l;
  $2(s6(h24, "search.unregisterHandlers"), "search.unregister"), g6(m45), g6(u45), g6(l36);
}
function d35() {
  return !(!m7(g3) || !g3.supports.search);
}
function g19() {
  return new Promise((r18) => {
    if (m7(g3, a2.content), !d35()) throw new Error("Not supported");
    r18(R3(s6(h24, "search.closeSearch"), "search.closeSearch"));
  });
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/sharing/sharing.js
var sharing_exports = {};
__export(sharing_exports, {
  SharingAPIMessages: () => c34,
  history: () => history_exports,
  isSupported: () => h25,
  shareWebContent: () => f36
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/sharing/history.js
var history_exports = {};
__export(history_exports, {
  getContent: () => m46,
  isSupported: () => l37
});
function m46() {
  return n(this, void 0, void 0, function* () {
    if (m7(g3, a2.sidePanel, a2.meetingStage), !l37()) throw l;
    return yield P3(s6("v2", "sharing.history.getContent"), "sharing.history.getContent");
  });
}
function l37() {
  var t15;
  return m7(g3) && void 0 !== (null === (t15 = g3.supports.sharing) || void 0 === t15 ? void 0 : t15.history);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/sharing/sharing.js
var c34 = { shareWebContent: "sharing.shareWebContent" };
function f36(e21, s38) {
  try {
    !function(e22) {
      if (!(e22 && e22.content && e22.content.length)) {
        throw { errorCode: E2.INVALID_ARGUMENTS, message: "Shared content is missing" };
      }
    }(e21), function(e22) {
      let t15;
      if (e22.content.some((e23) => !e23.type)) throw t15 = { errorCode: E2.INVALID_ARGUMENTS, message: "Shared content type cannot be undefined" }, t15;
      if (e22.content.some((t16) => t16.type !== e22.content[0].type)) throw t15 = { errorCode: E2.INVALID_ARGUMENTS, message: "Shared content must be of the same type" }, t15;
    }(e21), function(e22) {
      let t15;
      if ("URL" !== e22.content[0].type) throw t15 = { errorCode: E2.INVALID_ARGUMENTS, message: "Content type is unsupported" }, t15;
      if (e22.content.some((e23) => !e23.url)) throw t15 = { errorCode: E2.INVALID_ARGUMENTS, message: "URLs are required for URL content types" }, t15;
    }(e21);
  } catch (e22) {
    return l2(() => Promise.reject(e22), s38);
  }
  m7(g3, a2.content, a2.sidePanel, a2.task, a2.stage, a2.meetingStage);
  const a35 = s6(s38 ? "v1" : "v2", "sharing.shareWebContent");
  return l2(p47, s38, a35, e21);
}
function p47(t15, n19) {
  return new Promise((r18) => {
    if (!h25()) throw l;
    r18(P3(t15, c34.shareWebContent, n19));
  });
}
function h25() {
  return !(!m7(g3) || !g3.supports.sharing);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/stageView/stageView.js
var stageView_exports = {};
__export(stageView_exports, {
  StageViewOpenMode: () => a32,
  isSupported: () => s35,
  open: () => m48,
  self: () => self_exports
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/stageView/self.js
var self_exports = {};
__export(self_exports, {
  close: () => s34,
  isSupported: () => m47
});
function s34() {
  return new Promise((s38) => {
    if (m7(g3, a2.content), !m47()) throw l;
    s38(P3(s6("v2", "stageView.self.close"), "stageView.self.close"));
  });
}
function m47() {
  var t15;
  return m7(g3) && void 0 !== (null === (t15 = g3.supports.stageView) || void 0 === t15 ? void 0 : t15.self);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/stageView/stageView.js
var a32;
function m48(p56) {
  return new Promise((a35) => {
    if (m7(g3, a2.content), !s35()) throw l;
    if (!p56) throw new Error("[stageView.open] Stage view params cannot be null");
    a35(P3(s6("v2", "stageView.open"), "stageView.open", p56));
  });
}
function s35() {
  return !(!m7(g3) || !g3.supports.stageView);
}
!function(t15) {
  t15.modal = "modal", t15.popout = "popout", t15.popoutWithChat = "popoutWithChat";
}(a32 || (a32 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/visualMedia/visualMedia.js
var visualMedia_exports = {};
__export(visualMedia_exports, {
  CameraRestriction: () => f38,
  Source: () => l39,
  hasPermission: () => c36,
  image: () => image_exports,
  requestPermission: () => p49
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/visualMedia/image.js
var image_exports = {};
__export(image_exports, {
  captureImages: () => l38,
  isSupported: () => d36,
  retrieveImages: () => p48
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/visualMediaHelpers.js
var o21 = 10;

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/visualMedia/image.js
function l38(o24) {
  return n(this, void 0, void 0, function* () {
    m7(g3, a2.content, a2.task), c35(), f37(o24);
    const i26 = yield P3(s6("v2", "visualMedia.image.captureImages"), "visualMedia.image.captureImages", o24);
    return v21(o24.maxVisualMediaCount, i26), i26;
  });
}
function p48(o24) {
  return n(this, void 0, void 0, function* () {
    m7(g3, a2.content, a2.task), c35(), f37(o24);
    const i26 = yield P3(s6("v2", "visualMedia.image.retrieveImages"), "visualMedia.image.retrieveImages", o24);
    return v21(o24.maxVisualMediaCount, i26), i26;
  });
}
function d36() {
  return !!(m7(g3) && g3.supports.visualMedia && g3.supports.visualMedia.image && g3.supports.permissions);
}
function c35() {
  if (!d36()) throw l;
}
function f37(i26) {
  if (!i26 || i26.maxVisualMediaCount > o21 || i26.maxVisualMediaCount < 1) throw u2;
}
function v21(i26, t15) {
  if (t15.length > i26) throw f2;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/visualMedia/visualMedia.js
var f38;
var l39;
function c36() {
  if (m7(g3, a2.content, a2.task), !d36()) throw l;
  const m55 = O2.Media;
  return P3(s6("v2", "visualMedia.hasPermission"), "permissions.has", m55);
}
function p49() {
  if (m7(g3, a2.content, a2.task), !d36()) throw l;
  const m55 = O2.Media;
  return P3(s6("v2", "visualMedia.requestPermission"), "permissions.request", m55);
}
!function(r18) {
  r18[r18.FrontOrRear = 1] = "FrontOrRear", r18[r18.FrontOnly = 2] = "FrontOnly", r18[r18.RearOnly = 3] = "RearOnly";
}(f38 || (f38 = {})), function(r18) {
  r18[r18.Camera = 1] = "Camera", r18[r18.Gallery = 2] = "Gallery";
}(l39 || (l39 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/webStorage.js
var webStorage_exports = {};
__export(webStorage_exports, {
  isSupported: () => u46,
  isWebStorageClearedOnUserLogOut: () => a33
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/webStorageHelpers.js
var t14 = null;
function o22() {
  return n(this, void 0, void 0, function* () {
    return null === t14 && (t14 = (yield D4()).app.host.name), t14;
  });
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/webStorage.js
function a33() {
  return n(this, void 0, void 0, function* () {
    if (m7(g3), !u46()) throw l;
    return !(!g3.isLegacyTeams || e11.hostClientType !== o4.android && e11.hostClientType !== o4.ios && e11.hostClientType !== o4.ipados && e11.hostClientType !== o4.visionOS || (yield function() {
      return n(this, void 0, void 0, function* () {
        return o22();
      });
    }()) !== i5.teams) || (yield O5(s6("v2", "webStorage.isWebStorageClearedOnUserLogOut"), "webStorage.isWebStorageClearedOnUserLogOut"));
  });
}
function u46() {
  return m7(g3) && void 0 !== g3.supports.webStorage;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/call.js
var call_exports = {};
__export(call_exports, {
  CallModalities: () => m49,
  isSupported: () => u47,
  startCall: () => c37
});
var m49;
function c37(c43) {
  const d39 = s6("v2", "call.startCall");
  return new Promise((o24) => {
    var f46;
    if (m7(g3, a2.content, a2.task), !u47()) throw l;
    if (!g3.isLegacyTeams) return $2(d39, "call.startCall", [c43], o24);
    o24(O5(d39, "executeDeepLink", R9(c43.targets, null === (f46 = c43.requestedModalities) || void 0 === f46 ? void 0 : f46.includes(m49.Video), c43.source)).then((t15) => {
      if (!t15) throw new Error(u7);
      return t15;
    }));
  });
}
function u47() {
  return !(!m7(g3) || !g3.supports.call);
}
!function(t15) {
  t15.Unknown = "unknown", t15.Audio = "audio", t15.Video = "video", t15.VideoBasedScreenSharing = "videoBasedScreenSharing", t15.Data = "data";
}(m49 || (m49 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/appInitialization.js
var appInitialization_exports = {};
__export(appInitialization_exports, {
  ExpectedFailureReason: () => b5,
  FailedReason: () => O7,
  Messages: () => N6,
  notifyAppLoaded: () => s36,
  notifyExpectedFailure: () => c38,
  notifyFailure: () => m50,
  notifySuccess: () => f39
});
var r17 = "v1";
function s36() {
  A5(s6(r17, "appInitialization.notifyAppLoaded"));
}
function f39() {
  $2(s6(r17, "appInitialization.notifySuccess"), N6.Success, [o10]);
}
function m50(i26) {
  N5(s6(r17, "appInitialization.notifyFailure"), i26);
}
function c38(i26) {
  F3(s6(r17, "appInitialization.notifyExpectedFailure"), i26);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/thirdPartyCloudStorage.js
var thirdPartyCloudStorage_exports = {};
__export(thirdPartyCloudStorage_exports, {
  getDragAndDropFiles: () => g20,
  isSupported: () => C15
});
var c39 = u5("thirdPartyCloudStorage");
var f40 = class {
  constructor(e21, r18) {
    this.fileType = e21, this.assembleAttachment = r18;
  }
};
var d37 = [];
var h26 = null;
var m51 = true;
var p50 = null;
function g20(t15, n19) {
  if (!n19) throw new Error("[getDragAndDropFiles] Callback cannot be null");
  if (t15 && "" !== t15) {
    if (m7(g3, a2.content, a2.task), !C15()) throw l;
    if (p50) throw p50 = null, new Error("getDragAndDropFiles cannot be called twice");
    p50 = n19, m51 = true, $2(s6("v2", "thirdPartyCloudStorage.getDragAndDropFiles"), "thirdPartyCloudStorage.getDragAndDropFiles", [t15], R11);
  } else {
    n19([], { errorCode: E2.INVALID_ARGUMENTS });
  }
}
function R11(e21) {
  if (p50) if (e21 && e21.error) p50([], e21.error), p50 = null;
  else if (e21 && e21.fileChunk) try {
    m51 || 0 !== e21.fileChunk.chunkSequence || (c39("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"), m51 = true, p50([], { errorCode: E2.INTERNAL_ERROR, message: "error occurred while receiving data" }), d37 = [], p50 = null);
    const r18 = i23(e21.fileChunk, e21.fileType);
    if (r18 ? (h26 || (h26 = new f40(e21.fileType, [])), h26.assembleAttachment.push(r18)) : (c39(`Received a null assemble attachment for when decoding chunk sequence ${e21.fileChunk.chunkSequence}; not including the chunk in the assembled file.`), p50 ? p50([], { errorCode: E2.INTERNAL_ERROR, message: "error occurred while receiving data" }) : p50 = null, d37 = [], p50 = null, m51 = true), m51 = e21.fileChunk.endOfFile, e21.fileChunk.endOfFile && h26) {
      const r19 = u38(h26.assembleAttachment, h26.fileType);
      if (r19) {
        const t15 = new File([r19], e21.fileName, { type: r19.type });
        d37.push(t15);
      }
      e21.isLastFile && p50 && (p50(d37, e21.error), d37 = [], p50 = null, m51 = true), h26 = null;
    }
  } catch (e22) {
    p50 && (p50([], { errorCode: E2.INTERNAL_ERROR, message: e22 }), d37 = [], p50 = null, m51 = true);
  }
  else p50([], { errorCode: E2.INTERNAL_ERROR, message: "data received is null" }), d37 = [], p50 = null, m51 = true;
}
function C15() {
  return !(!m7(g3) || !g3.supports.thirdPartyCloudStorage);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/settings.js
var settings_exports = {};
__export(settings_exports, {
  getSettings: () => f41,
  registerOnRemoveHandler: () => j17,
  registerOnSaveHandler: () => u48,
  setSettings: () => p51,
  setValidityState: () => c40
});
var l40 = "v1";
function c40(t15) {
  T6(s6(l40, "settings.setValidityState"), t15);
}
function f41(e21) {
  m7(g3, a2.content, a2.settings, a2.remove, a2.sidePanel), C7(s6(l40, "settings.getSettings")).then((t15) => {
    e21(t15);
  });
}
function p51(e21, n19) {
  m7(g3, a2.content, a2.settings, a2.sidePanel);
  const a35 = null != n19 ? n19 : i6();
  L5(s6(l40, "settings.setSettings"), e21).then(() => {
    a35(true);
  }).catch((t15) => {
    a35(false, t15.message);
  });
}
function u48(t15) {
  N7(s6(l40, "settings.registerOnSaveHandler"), t15);
}
function j17(t15) {
  w9(s6(l40, "settings.registerOnRemoveHandler"), t15);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/tasks.js
var tasks_exports = {};
__export(tasks_exports, {
  getDefaultSizeIfNotProvided: () => g21,
  startTask: () => c41,
  submitTask: () => f42,
  updateTask: () => p52
});
var m52 = "v1";
function c41(t15, e21) {
  const n19 = s6(m52, "tasks.startTask"), c43 = e21 ? (t16) => {
    var i26, o24;
    return e21(null !== (i26 = t16.err) && void 0 !== i26 ? i26 : "", null !== (o24 = t16.result) && void 0 !== o24 ? o24 : "");
  } : void 0;
  return void 0 === t15.card && void 0 === t15.url || t15.card ? (m7(g3, a2.content, a2.sidePanel, a2.meetingStage), $2(n19, "tasks.startTask", [t15], e21)) : void 0 !== t15.completionBotId ? k5(n19, function(t16) {
    if (void 0 === t16.url || void 0 === t16.completionBotId) throw new Error(`Both url ${t16.url} and completionBotId ${t16.completionBotId} are required for bot url dialog. At least one is undefined.`);
    const i26 = { url: t16.url, size: { height: t16.height ? t16.height : r3.Small, width: t16.width ? t16.width : r3.Small }, title: t16.title, fallbackUrl: t16.fallbackUrl, completionBotId: t16.completionBotId };
    return i26;
  }(t15), c43) : b6(n19, function(t16) {
    if (void 0 === t16.url) throw new Error("url property of taskInfo object can't be undefined");
    const i26 = { url: t16.url, size: { height: t16.height ? t16.height : r3.Small, width: t16.width ? t16.width : r3.Small }, title: t16.title, fallbackUrl: t16.fallbackUrl };
    return i26;
  }(t15), c43), new p35();
}
function p52(i26) {
  i26 = g21(i26);
  const o24 = t2(i26, ["width", "height"]);
  if (Object.keys(o24).length) throw new Error("resize requires a TaskInfo argument containing only width and height");
  h8(s6(m52, "tasks.updateTask"), i26);
}
function f42(t15, i26) {
  j7(s6(m52, "tasks.submitTask"), t15, i26);
}
function g21(t15) {
  return t15.height = t15.height ? t15.height : r3.Small, t15.width = t15.width ? t15.width : r3.Small, t15;
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/marketplace.js
var marketplace_exports = {};
__export(marketplace_exports, {
  CartStatus: () => f43,
  Intent: () => p54,
  addOrUpdateCartItems: () => v22,
  cartVersion: () => u50,
  getCart: () => I12,
  isSupported: () => h27,
  removeCartItems: () => C16,
  updateCartStatus: () => k11
});

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/marketplaceUtils.js
function o23(r18) {
  try {
    return r18.cartItems = s37(r18.cartItems), r18;
  } catch (r19) {
    throw new Error("Error deserializing cart");
  }
}
function s37(r18) {
  return r18.map((r19) => {
    if (r19.imageURL) {
      const e21 = new URL(r19.imageURL);
      r19.imageURL = e21;
    }
    return r19.accessories && (r19.accessories = s37(r19.accessories)), r19;
  });
}
var i25 = (e21) => {
  try {
    return e21.map((e22) => {
      const { imageURL: t15, accessories: o24 } = e22, s38 = t2(e22, ["imageURL", "accessories"]), n19 = Object.assign({}, s38);
      return t15 && (n19.imageURL = t15.href), o24 && (n19.accessories = i25(o24)), n19;
    });
  } catch (r18) {
    throw new Error("Error serializing cart items");
  }
};
function n18(r18) {
  if (!Array.isArray(r18) || 0 === r18.length) throw new Error("cartItems must be a non-empty array");
  for (const e21 of r18) c42(e21), a34(e21.accessories);
}
function a34(r18) {
  if (null != r18) {
    if (!Array.isArray(r18) || 0 === r18.length) throw new Error("CartItem.accessories must be a non-empty array");
    for (const e21 of r18) {
      if (e21.accessories) throw new Error("Item in CartItem.accessories cannot have accessories");
      c42(e21);
    }
  }
}
function c42(r18) {
  if (!r18.id) throw new Error("cartItem.id must not be empty");
  if (!r18.name) throw new Error("cartItem.name must not be empty");
  u49(r18.price), f44(r18.quantity);
}
function m53(r18) {
  if (null != r18) {
    if (!r18) throw new Error("id must not be empty");
    if (false === e7(r18)) throw new Error("id must be a valid UUID");
  }
}
function u49(r18) {
  if ("number" != typeof r18 || r18 < 0) throw new Error(`price ${r18} must be a number not less than 0`);
  if (parseFloat(r18.toFixed(3)) !== r18) throw new Error(`price ${r18} must have at most 3 decimal places`);
}
function f44(r18) {
  if ("number" != typeof r18 || r18 <= 0 || parseInt(r18.toString()) !== r18) throw new Error(`quantity ${r18} must be an integer greater than 0`);
}
function p53(r18) {
  if (!Object.values(f43).includes(r18)) throw new Error(`cartStatus ${r18} is not valid`);
}

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/marketplace.js
var l41 = "v2";
var u50 = { majorVersion: 1, minorVersion: 1 };
var p54;
var f43;
function I12() {
  if (m7(g3, a2.content, a2.task), !h27()) throw l;
  return P3(s6(l41, "marketplace.getCart"), "marketplace.getCart", u50).then(o23);
}
function v22(o24) {
  if (m7(g3, a2.content, a2.task), !h27()) throw l;
  if (!o24) throw new Error("addOrUpdateCartItemsParams must be provided");
  return m53(null == o24 ? void 0 : o24.cartId), n18(null == o24 ? void 0 : o24.cartItems), P3(s6(l41, "marketplace.addOrUpdateCartItems"), "marketplace.addOrUpdateCartItems", Object.assign(Object.assign({}, o24), { cartItems: i25(o24.cartItems), cartVersion: u50 })).then(o23);
}
function C16(n19) {
  if (m7(g3, a2.content, a2.task), !h27()) throw l;
  if (!n19) throw new Error("removeCartItemsParams must be provided");
  if (m53(null == n19 ? void 0 : n19.cartId), !Array.isArray(null == n19 ? void 0 : n19.cartItemIds) || 0 === (null == n19 ? void 0 : n19.cartItemIds.length)) throw new Error("cartItemIds must be a non-empty array");
  return P3(s6(l41, "marketplace.removeCartItems"), "marketplace.removeCartItems", Object.assign(Object.assign({}, n19), { cartVersion: u50 })).then(o23);
}
function k11(n19) {
  if (m7(g3, a2.content, a2.task), !h27()) throw l;
  if (!n19) throw new Error("updateCartStatusParams must be provided");
  return m53(null == n19 ? void 0 : n19.cartId), p53(null == n19 ? void 0 : n19.cartStatus), P3(s6(l41, "marketplace.updateCartStatus"), "marketplace.updateCartStatus", Object.assign(Object.assign({}, n19), { cartVersion: u50 })).then(o23);
}
function h27() {
  return !(!m7(g3) || !g3.supports.marketplace);
}
!function(t15) {
  t15.TACAdminUser = "TACAdminUser", t15.TeamsAdminUser = "TeamsAdminUser", t15.TeamsEndUser = "TeamsEndUser";
}(p54 || (p54 = {})), function(t15) {
  t15.Open = "Open", t15.Processing = "Processing", t15.Processed = "Processed", t15.Closed = "Closed", t15.Error = "Error";
}(f43 || (f43 = {}));

// node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/shortcutRelay.js
var shortcutRelay_exports = {};
__export(shortcutRelay_exports, {
  DISABLE_SHORTCUT_FORWARDING_ATTRIBUTE: () => g22,
  enableShortcutRelayCapability: () => S15,
  isSupported: () => C17,
  resetIsShortcutRelayCapabilityEnabled: () => K4,
  setOverridableShortcutHandler: () => w23
});
var h28 = class {
  constructor(t15) {
    this.event = t15;
  }
  serialize() {
    return { altKey: this.event.altKey, bubbles: this.event.bubbles, cancelBubble: this.event.cancelBubble, charCode: this.event.charCode, code: this.event.code, composed: this.event.composed, ctrlKey: this.event.ctrlKey, defaultPrevented: this.event.defaultPrevented, detail: this.event.detail, eventPhase: this.event.eventPhase, isComposing: this.event.isComposing, isTrusted: this.event.isTrusted, key: this.event.key, keyCode: this.event.keyCode, location: this.event.location, metaKey: this.event.metaKey, repeat: this.event.repeat, returnValue: this.event.returnValue, shiftKey: this.event.shiftKey, timeStamp: this.event.timeStamp, type: this.event.type, which: this.event.which };
  }
};
function u51(t15) {
  return t15.toLowerCase().split("+").sort().join("+");
}
function l42(t15, e21) {
  if (function(t16) {
    return t16.ctrlKey || t16.shiftKey || t16.altKey || t16.metaKey || !!t16.key && "escape" === t16.key.toLowerCase();
  }(e21)) {
    const r18 = function(t16) {
      return [t16.ctrlKey && "ctrl", t16.shiftKey && "shift", t16.altKey && "alt", t16.metaKey && "meta", t16.key.toLowerCase()].filter(Boolean).sort().join("+");
    }(e21);
    if (t15.has(r18)) return { matchedShortcut: r18, isOverridable: f45.has(r18) };
  }
  return { matchedShortcut: void 0, isOverridable: false };
}
function d38(t15) {
  y15.clear(), t15.shortcuts.forEach((t16) => {
    y15.add(u51(t16));
  }), f45.clear(), t15.overridableShortcuts.forEach((t16) => {
    f45.add(u51(t16));
  });
}
var v23 = class extends e15 {
  validate(t15) {
    return t15 && Array.isArray(t15.shortcuts) && Array.isArray(t15.overridableShortcuts);
  }
  deserialize(t15) {
    return t15;
  }
};
function m54(t15) {
  if (t15.target.closest(`[${g22}]`)) return;
  const { matchedShortcut: r18, isOverridable: o24 } = l42(y15, t15);
  if (!r18) return;
  if (o24 && p55) {
    if (p55(t15, { matchedShortcut: r18 })) return;
  }
  const n19 = new h28(t15);
  A3("shortcutRelay.forwardShortcutEvent", [n19], s6("v2", "shortcutRelay.forwardShortcutEvent")), t15.preventDefault(), t15.stopImmediatePropagation();
}
var f45 = /* @__PURE__ */ new Set();
var y15 = /* @__PURE__ */ new Set();
var p55;
var b17 = false;
function w23(t15) {
  if (!C17()) throw l;
  const e21 = p55;
  return p55 = t15, e21;
}
function K4() {
  if (!C17()) throw l;
  b17 = false, y15.clear(), f45.clear(), p55 = void 0, document.removeEventListener("keydown", m54, { capture: true });
}
function S15() {
  return n(this, void 0, void 0, function* () {
    if (!C17()) throw l;
    var t15;
    d38(yield N4("shortcutRelay.getHostShortcuts", [], new v23(), s6("v2", "shortcutRelay.getHostShortcuts"))), b17 || document.addEventListener("keydown", m54, { capture: true }), b17 = true, t15 = (t16) => {
      d38(t16);
    }, p10(s6("v2", "shortcutRelay.hostShortcutChanged"), "shortcutRelay.hostShortcutChanged", t15);
  });
}
function C17() {
  return !(!m7(g3) || !g3.supports.shortcutRelay);
}
var g22 = "data-disable-shortcuts-forwarding";
export {
  n4 as ActionObjectType,
  i10 as AppId,
  m2 as ChannelType,
  p35 as ChildAppWindow,
  r3 as DialogDimension,
  N2 as EduType,
  r14 as EmailAddress,
  E2 as ErrorCode,
  t4 as FileOpenPreference,
  a2 as FrameContexts,
  o4 as HostClientType,
  i5 as HostName,
  l31 as LiveShareHost,
  e as NotificationTypes,
  m31 as ParentAppWindow,
  n5 as RenderingSurfaces,
  e5 as SecondaryM365ContentIdName,
  r3 as TaskModuleDimension,
  s2 as TeamType,
  n7 as UUID,
  i as UserSettingTypes,
  t5 as UserTeamRole,
  i11 as ValidatedSafeString,
  t as ViewerActionTypes,
  i2 as activateChildProxyingCommunication,
  app_exports as app,
  appEntity_exports as appEntity,
  appInitialization_exports as appInitialization,
  appInstallDialog_exports as appInstallDialog,
  authentication_exports as authentication,
  barCode_exports as barCode,
  calendar_exports as calendar,
  call_exports as call,
  chat_exports as chat,
  clipboard_exports as clipboard,
  conversations_exports as conversations,
  copilot_exports as copilot,
  dialog_exports as dialog,
  k8 as enablePrintCapability,
  M5 as executeDeepLink,
  externalAppAuthentication_exports as externalAppAuthentication,
  externalAppAuthenticationForCEA_exports as externalAppAuthenticationForCEA,
  externalAppCardActions_exports as externalAppCardActions,
  externalAppCardActionsForCEA_exports as externalAppCardActionsForCEA,
  externalAppCardActionsForDA_exports as externalAppCardActionsForDA,
  externalAppCommands_exports as externalAppCommands,
  files_exports as files,
  geoLocation_exports as geoLocation,
  r15 as getAdaptiveCardSchemaVersion,
  E16 as getContext,
  c as getCurrentFeatureFlagsState,
  D8 as getMruTabInstances,
  z5 as getTabInstances,
  hostEntity_exports as hostEntity,
  B4 as initialize,
  q4 as initializeWithFrameContext,
  liveShareHost_exports as liveShare,
  location_exports as location,
  logs_exports as logs,
  mail_exports as mail,
  marketplace_exports as marketplace,
  media_exports as media,
  meeting_exports as meeting,
  meetingRoom_exports as meetingRoom,
  menus_exports as menus,
  messageChannels_exports as messageChannels,
  monetization_exports as monetization,
  f26 as navigateBack,
  u34 as navigateCrossDomain,
  l30 as navigateToTab,
  nestedAppAuth_exports as nestedAppAuth,
  nestedAppAuthBridge_exports as nestedAppAuthBridge,
  notifications_exports as notifications,
  w11 as openFilePreview,
  otherAppStateChange_exports as otherAppStateChange,
  e2 as overwriteFeatureFlagsState,
  pages_exports as pages,
  people_exports as people,
  v16 as print,
  profile_exports as profile,
  I9 as registerAppButtonClickHandler,
  S12 as registerAppButtonHoverEnterHandler,
  y12 as registerAppButtonHoverLeaveHandler,
  A14 as registerBackButtonHandler,
  T11 as registerBeforeUnloadHandler,
  W3 as registerChangeSettingsHandler,
  d13 as registerCustomHandler,
  U7 as registerFocusEnterHandler,
  P12 as registerFullScreenHandler,
  F11 as registerOnLoadHandler,
  L7 as registerOnThemeChangeHandler,
  f14 as registerUserSettingsChangeHandler,
  remoteCamera_exports as remoteCamera,
  g15 as returnFocus,
  search_exports as search,
  secondaryBrowser_exports as secondaryBrowser,
  u21 as sendCustomEvent,
  c13 as sendCustomMessage,
  r as setFeatureFlagsState,
  V7 as setFrameContext,
  settings_exports as settings,
  O11 as shareDeepLink,
  sharing_exports as sharing,
  shortcutRelay_exports as shortcutRelay,
  sidePanelInterfaces_exports as sidePanelInterfaces,
  stageView_exports as stageView,
  store_exports as store,
  tasks_exports as tasks,
  teams_exports as teams,
  teamsAPIs_exports as teamsCore,
  thirdPartyCloudStorage_exports as thirdPartyCloudStorage,
  p21 as uploadCustomApp,
  o10 as version,
  videoEffects_exports as videoEffects,
  videoEffectsEx_exports as videoEffectsEx,
  visualMedia_exports as visualMedia,
  webStorage_exports as webStorage
};
//# sourceMappingURL=@microsoft_teams-js.js.map
